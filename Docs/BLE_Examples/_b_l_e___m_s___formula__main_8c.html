<!-- HTML header for doxygen 1.8.10-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>BlueNRG-1_2 DK: BLE examples: BLE_MS_Formula_main.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="STcustom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ST-logo-small.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BlueNRG-1_2 DK: BLE examples
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">BLE_MS_Formula_main.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This application provides a basic example of multiple connections, simultaneously Master and Slave scenario using the related formula for calculating the related proper parameters.  
<a href="#details">More...</a></p>

<p><a href="_b_l_e___m_s___formula__main_8c_source.html">Go to the source code of this file.</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This application provides a basic example of multiple connections, simultaneously Master and Slave scenario using the related formula for calculating the related proper parameters. </p>
<h1><a class="anchor" id="ATOLLIC_project"></a>
ATOLLIC project</h1>
<p>To use the project with ATOLLIC TrueSTUDIO for ARM, please follow the instructions below:</p><ol type="1">
<li>Open the ATOLLIC TrueSTUDIO for ARM and select File-&gt;Import... Project menu.</li>
<li>Select Existing Projects into Workspace.</li>
<li>Select the ATOLLIC project</li>
<li>Select desired configuration to build from Project-&gt;Manage Configurations</li>
<li>Select Project-&gt;Rebuild Project. This will recompile and link the entire application</li>
<li>To download the binary image, please connect STLink to JTAG connector in your board (if available).</li>
<li>Select Project-&gt;Download to download the related binary image.</li>
<li>Alternatively, open the BlueNRG1 Flasher utility and download the built binary image.</li>
</ol>
<h1><a class="anchor" id="KEIL_project"></a>
KEIL project</h1>
<p>To use the project with KEIL uVision 5 for ARM, please follow the instructions below:</p><ol type="1">
<li>Open the KEIL uVision 5 for ARM and select Project-&gt;Open Project menu.</li>
<li>Open the KEIL project <code> C:\{username}-1_2 DK x.x.x\Project\BLE_Examples\BLE_MS_Formula\MDK-ARM\BlueNRG-1\BLE_MS_Formula.uvprojx </code> or <code> C:\{username}-1_2 DK x.x.x\Project\BLE_Examples\BLE_MS_Formula\MDK-ARM\BlueNRG-2\BLE_MS_Formula.uvprojx </code></li>
<li>Select desired configuration to build</li>
<li>Select Project-&gt;Rebuild all target files. This will recompile and link the entire application</li>
<li>To download the binary image, please connect STLink to JTAG connector in your board (if available).</li>
<li>Select Project-&gt;Download to download the related binary image.</li>
<li>Alternatively, open the BlueNRG1 Flasher utility and download the built binary image.</li>
</ol>
<h1><a class="anchor" id="IAR_project"></a>
IAR project</h1>
<p>To use the project with IAR Embedded Workbench for ARM, please follow the instructions below:</p><ol type="1">
<li>Open the Embedded Workbench for ARM and select File-&gt;Open-&gt;Workspace menu.</li>
<li>Open the IAR project <code> C:\{username}-1_2 DK x.x.x\Project\BLE_Examples\BLE_MS_Formula\EWARM\BlueNRG-1\BLE_MS_Formula.eww </code> or <code> C:\{username}-1_2 DK x.x.x\Project\BLE_Examples\BLE_MS_Formula\EWARM\BlueNRG-2\BLE_MS_Formula.eww </code></li>
<li>Select desired configuration to build</li>
<li>Select Project-&gt;Rebuild All. This will recompile and link the entire application</li>
<li>To download the binary image, please connect STLink to JTAG connector in your board (if available).</li>
<li>Select Project-&gt;Download and Debug to download the related binary image.</li>
<li>Alternatively, open the BlueNRG1 Flasher utility and download the built binary image.</li>
</ol>
<h2><a class="anchor" id="Project_configurations"></a>
Project configurations</h2>
<ul>
<li><code>Master</code> - Master configuration</li>
<li><code>Master_Slave</code> - Master, Slave configuration</li>
</ul>
<h1><a class="anchor" id="Board_supported"></a>
Boards supported</h1>
<ul>
<li><code>STEVAL-IDB007V1</code> </li>
<li><code>STEVAL-IDB007V2</code> </li>
<li><code>STEVAL-IDB008V1</code> </li>
<li><code>STEVAL-IDB008V1M</code> </li>
<li><code>STEVAL-IDB008V2</code> </li>
<li><code>STEVAL-IDB009V1</code> </li>
</ul>
<h1><a class="anchor" id="Power_settings"></a>
Power configuration settings</h1>
<table  id="DoxyEmbeddedTable" border="1">
<tr id="HeadRow">
<td id="FirstColumn"><b>STEVAL-IDB00XV1</b> </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">Jumper name</td><td id="MiddleColumn"></td><td id="LastColumn">Description </td></tr>
<tr id="HeadRow">
<td id="FirstColumn"><b>JP1</b></td><td id="MiddleColumn"><b>JP2</b></td><td id="LastColumn"><b></b> </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">ON 1-2</td><td id="MiddleColumn">ON 2-3</td><td id="LastColumn">USB supply power </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">ON 2-3</td><td id="MiddleColumn">ON 1-2</td><td id="LastColumn">The supply voltage must be provided through battery pins. </td></tr>
<tr id="LastRow">
<td id="FirstColumn">ON 1-2</td><td id="MiddleColumn"></td><td id="LastColumn">USB supply power to STM32L1, JP2 pin 2 external power to BlueNRG1 </td></tr>
</table>
<h1><a class="anchor" id="Jumper_settings"></a>
Jumper settings</h1>
<table  id="DoxyEmbeddedTable" border="1">
<tr id="HeadRow">
<td id="FirstColumn"><b>STEVAL-IDB00XV1</b> </td></tr>
<tr id="HeadRow">
<td id="FirstColumn"><b>Jumper name</b></td><td id="LastColumn"><b>Description</b> </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">JP1</td><td id="LastColumn">1-2: to provide power from USB (JP2:2-3). 2-3: to provide power from battery holder (JP2:1-2) </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">JP2</td><td id="LastColumn">1-2: to provide power from battery holder (JP1:2-3). 2-3: to provide power from USB (JP1:1-2). Pin2 to VDD to provide external power supply to BlueNRG-1 (JP1: 1-2) </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">JP3</td><td id="LastColumn">pin 1 and 2 UART RX and TX of MCU. pin 3 GND. </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">JP4</td><td id="LastColumn">Fitted: to provide VBLUE to BlueNRG1. It can be used also for current measurement. </td></tr>
<tr id="LastRow">
<td id="FirstColumn">JP5</td><td id="LastColumn">Fitted : TEST pin to VBLUE. Not fitted: TEST pin to GND </td></tr>
</table>
<h1><a class="anchor" id="Pin_settings"></a>
Pin settings</h1>
<table  id="DoxyEmbeddedTable" border="1">
<tr id="HeadRow">
<td id="FirstColumn"><b></b></td><td id="MiddleColumn"><b>Master_Slave</b></td><td id="MiddleColumn"><b></b></td><td id="MiddleColumn"><b></b></td><td id="MiddleColumn"><b></b></td><td id="MiddleColumn"><b></b></td><td id="MiddleColumn"><b></b></td><td id="MiddleColumn"><b>Master</b></td><td id="MiddleColumn"><b></b></td><td id="MiddleColumn"><b></b></td><td id="MiddleColumn"><b></b></td><td id="MiddleColumn"><b></b></td><td id="LastColumn"><b></b> </td></tr>
<tr id="HeadRow">
<td id="FirstColumn"><b>PIN name</b></td><td id="MiddleColumn"><b>STEVAL-IDB007V1</b></td><td id="MiddleColumn"><b>STEVAL-IDB007V2</b></td><td id="MiddleColumn"><b>STEVAL-IDB008V1</b></td><td id="MiddleColumn"><b>STEVAL-IDB008V1M</b></td><td id="MiddleColumn"><b>STEVAL-IDB008V2</b></td><td id="MiddleColumn"><b>STEVAL-IDB009V1</b></td><td id="MiddleColumn"><b>STEVAL-IDB007V1</b></td><td id="MiddleColumn"><b>STEVAL-IDB007V2</b></td><td id="MiddleColumn"><b>STEVAL-IDB008V1</b></td><td id="MiddleColumn"><b>STEVAL-IDB008V1M</b></td><td id="MiddleColumn"><b>STEVAL-IDB008V2</b></td><td id="LastColumn"><b>STEVAL-IDB009V1</b> </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">ADC1</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">ADC2</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">GND</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="LastColumn">N.A. </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO0</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO1</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO11</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO12</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO13</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO14</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO15</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO16</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO17</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO18</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO19</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO2</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO20</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO21</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO22</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO23</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO24</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO25</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO3</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO4</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO5</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO6</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO7</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO8</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">RESETN</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="LastColumn">N.A. </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">TEST1</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="LastRow">
<td id="FirstColumn">VBLUE</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="LastColumn">N.A. </td></tr>
</table>
<h1><a class="anchor" id="Serial_IO"></a>
Serial I/O</h1>
<p>The application will listen for keys typed and it will send back in the serial port. In other words everything typed in serial port will be send back. </p><table  id="DoxyEmbeddedTable" border="1">
<tr id="HeadRow">
<td id="FirstColumn"><b>Parameter name</b></td><td id="MiddleColumn"><b>Value</b></td><td id="LastColumn"><b>Unit</b> </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">Baudrate</td><td id="MiddleColumn">115200 [default]</td><td id="LastColumn">bit/sec </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">Data bits</td><td id="MiddleColumn">8</td><td id="LastColumn">bit </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">Parity</td><td id="MiddleColumn">None</td><td id="LastColumn">bit </td></tr>
<tr id="LastRow">
<td id="FirstColumn">Stop bits</td><td id="MiddleColumn">1</td><td id="LastColumn">bit </td></tr>
</table>
<h1><a class="anchor" id="LEDs_description"></a>
LEDs description</h1>
<table  id="DoxyEmbeddedTable" border="1">
<tr id="HeadRow">
<td id="FirstColumn"><b></b></td><td id="MiddleColumn"><b>Master_Slave</b></td><td id="MiddleColumn"><b></b></td><td id="MiddleColumn"><b></b></td><td id="MiddleColumn"><b></b></td><td id="MiddleColumn"><b></b></td><td id="MiddleColumn"><b></b></td><td id="MiddleColumn"><b>Master</b></td><td id="MiddleColumn"><b></b></td><td id="MiddleColumn"><b></b></td><td id="MiddleColumn"><b></b></td><td id="MiddleColumn"><b></b></td><td id="LastColumn"><b></b> </td></tr>
<tr id="HeadRow">
<td id="FirstColumn"><b>LED name</b></td><td id="MiddleColumn"><b>STEVAL-IDB007V1</b></td><td id="MiddleColumn"><b>STEVAL-IDB007V2</b></td><td id="MiddleColumn"><b>STEVAL-IDB008V1</b></td><td id="MiddleColumn"><b>STEVAL-IDB008V1M</b></td><td id="MiddleColumn"><b>STEVAL-IDB008V2</b></td><td id="MiddleColumn"><b>STEVAL-IDB009V1</b></td><td id="MiddleColumn"><b>STEVAL-IDB007V1</b></td><td id="MiddleColumn"><b>STEVAL-IDB007V2</b></td><td id="MiddleColumn"><b>STEVAL-IDB008V1</b></td><td id="MiddleColumn"><b>STEVAL-IDB008V1M</b></td><td id="MiddleColumn"><b>STEVAL-IDB008V2</b></td><td id="LastColumn"><b>STEVAL-IDB009V1</b> </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">DL1</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">DL2</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">DL3</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="LastRow">
<td id="FirstColumn">DL4</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
</table>
<h1><a class="anchor" id="Buttons_description"></a>
Buttons description</h1>
<table  id="DoxyEmbeddedTable" border="1">
<tr id="HeadRow">
<td id="FirstColumn"><b></b></td><td id="MiddleColumn"><b>Master_Slave</b></td><td id="MiddleColumn"><b></b></td><td id="MiddleColumn"><b></b></td><td id="MiddleColumn"><b></b></td><td id="MiddleColumn"><b></b></td><td id="MiddleColumn"><b></b></td><td id="MiddleColumn"><b>Master</b></td><td id="MiddleColumn"><b></b></td><td id="MiddleColumn"><b></b></td><td id="MiddleColumn"><b></b></td><td id="MiddleColumn"><b></b></td><td id="LastColumn"><b></b> </td></tr>
<tr id="HeadRow">
<td id="FirstColumn"><b>BUTTON name</b></td><td id="MiddleColumn"><b>STEVAL-IDB007V1</b></td><td id="MiddleColumn"><b>STEVAL-IDB007V2</b></td><td id="MiddleColumn"><b>STEVAL-IDB008V1</b></td><td id="MiddleColumn"><b>STEVAL-IDB008V1M</b></td><td id="MiddleColumn"><b>STEVAL-IDB008V2</b></td><td id="MiddleColumn"><b>STEVAL-IDB009V1</b></td><td id="MiddleColumn"><b>STEVAL-IDB007V1</b></td><td id="MiddleColumn"><b>STEVAL-IDB007V2</b></td><td id="MiddleColumn"><b>STEVAL-IDB008V1</b></td><td id="MiddleColumn"><b>STEVAL-IDB008V1M</b></td><td id="MiddleColumn"><b>STEVAL-IDB008V2</b></td><td id="LastColumn"><b>STEVAL-IDB009V1</b> </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">PUSH1</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">PUSH2</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="LastRow">
<td id="FirstColumn">RESET</td><td id="MiddleColumn">Reset BlueNRG1</td><td id="MiddleColumn">Reset BlueNRG1</td><td id="MiddleColumn">Reset BlueNRG2</td><td id="MiddleColumn">Reset BlueNRG2</td><td id="MiddleColumn">Reset BlueNRG2</td><td id="MiddleColumn">Reset BlueNRG2</td><td id="MiddleColumn">Reset BlueNRG1</td><td id="MiddleColumn">Reset BlueNRG1</td><td id="MiddleColumn">Reset BlueNRG2</td><td id="MiddleColumn">Reset BlueNRG2</td><td id="MiddleColumn">Reset BlueNRG2</td><td id="LastColumn">Reset BlueNRG2 </td></tr>
</table>
<h1><a class="anchor" id="Usage"></a>
Usage</h1>
<p><b>Master_Slave device role</b></p>
<p>Master_Slave device role allows to test a multiple connection, simultaneously Master and Slave scenario using the GET_Master_Slave_device_connection_parameters() formula provided within the ble_utils.c file. It configures the Master_Slave device as Central and Peripheral, with a service and one characteristic and it performs simultaneously advertising and scanning in order to connect respectively, to up to Num_Slaves BLE Peripheral/Slave devices Slave1, Slave2, ..... (which have defined the same service and characteristic) and then to up to Num_Masters Central/Master devices. The number Num_Slaves of Slave device depends on max number of supported multiple connections (8) and the number Num_Masters [0-2] of selected Master devices: Num_Slaves = 8 - Num_Masters. User must define the expected number of slaves and master devices, by setting the preprocessor options:</p>
<ul>
<li>MASTER_SLAVE_NUM_MASTERS</li>
<li>MASTER_SLAVE_NUM_SLAVES</li>
</ul>
<p>It can also set the requested minimal scan window and additional sleep time, respectively, through the preprocessor options:</p>
<ul>
<li>MASTER_SLAVE_SCAN_WINDOW</li>
<li>MASTER_SLAVE_SLEEP_TIME</li>
<li>NOTE: Default configuration is: Num_Masters = 1; Num_Slaves = 6; Slave_Scan_Window_Length = 20; Slave_Sleep_time = 0.</li>
</ul>
<p>Once the connections with slaves and devices are performed, BLE Master_Slave device receives characteristics notifications from Num_Slaves devices and it also notifies characteristics (as Peripheral) to the Num_Masters BLE Master devices (if any), which display the related received slave index value. Num_Slaves devices notified characteristic value is as follow: &lt;slave_index&gt; &lt;counter_value&gt;, where slave_index is one byte in the range [1 - Num_Slaves], and counter_value is a 2 bytes inter counter starting from 0.</p>
<p>NOTE: if both Master_Slave and Slave(i) device supports data length extension, the ATT_MTU size is increased to the common max supported value (Att_Mtu), using ACI_GATT_EXCHANGE_CONFIG() API, and the slave(i) notifies a characteristic of Att_Mtu - 3 bytes. Same path is followed for the Master_Slave to Master(i) communication, if both devices supports the data length extension feature (the notification length is also tailored to the actual notification length received from each Slave and to the max number of octets for data length extension handled by connected Master devices).</p>
<p>How to run? Follow these steps:</p>
<p>1) Configure Master_Slave device</p><ul>
<li>Download the Project\BLE_Examples\BLE_MS_Formula\EWARM\[BlueNRG-1/BlueNRG-2]\Master_Slave\Exe\BLE_Master_Slave.hex, respectively, on the selected BlueNRG-1 or BlueNRG-2 STEVAL kit.</li>
<li>Open a hyper terminal with the described settings</li>
<li>Reset the selected BlueNRG-1 or BlueNRG-2 STEVAL kit: a discovery procedure starts for finding the Num_Slaves slaves devices</li>
</ul>
<p>2) Configure Num_Slaves GAP Peripheral devices Slave1, ... using the Slaves.py script</p>
<ul>
<li><b>BlueNRG/BlueNRG-MS platform configuration steps</b>:<ul>
<li>Connect the selected platform to a PC USB port</li>
<li>Put selected platform in DFU mode and download the "C:\\Program Files (x86)\STMicroelectronics\BlueNRG GUI x.x.x\Firmware\STM32L1_prebuilt_images\BlueNRG_VCOM_x_x.hex" using the BlueNRG GUI, Tools, Flash Motherboard FW... utility</li>
</ul>
</li>
<li><b> BlueNRG-1,2 platforms configuration steps</b>:<ul>
<li>Connect the selected Num_Slaves platforms to a Num_Slaves PC USB ports</li>
<li>BlueNRG-1 platform: download the "C:\\\Program Files (x86)\STMicroelectronics\\BlueNRG GUI x.x.x\\Firmware\\DTM\\BlueNRG1\\DTM_UART.hex or DTM_SPI.hex" file, using the BlueNRG Flasher utility available on STSW-BNRGFLASHER SW package</li>
<li>BlueNRG-2 platform: download the "C:\\Program Files (x86)\\STMicroelectronics\\BlueNRG GUI x.x.x\\Firmware\\DTM\\BlueNRG1\\DTM_UART.hex or DTM_SPI.hex" file, using the BlueNRG Flasher utility available on STSW-BNRGFLASHER SW package</li>
<li><b>NOTES</b>: SPI Network coprocessor configuration file (DTM_SPI.hex) requires some HW changes to be applied to the BlueNRG-1 development platform. Refer to STSW-BNRGUI user manual UM2058.</li>
</ul>
</li>
<li>Open a DOS shell and go to the BlueNRG GUI installation folder : C:\Program Files (x86)\STMicroelectronics\BlueNRG GUI x.x.x\Application</li>
<li>On DOS shell launch the script launcher utility: BlueNRG_Script_Launcher.exe -s &lt; script_user_folder &gt; Slaves_Num_Slaves.py</li>
<li>Script requests user to add the number of expected Master devices (masters of Master_Slave device) and the number of slaves devices Num_Slaves and to confirm that Num_Slaves devices are actually connected to PC USB ports</li>
<li>Slaves.py puts each of Num_Slaves device in discovey mode with advertising name = slavem, waiting for Master_Slave device to connect it and to enable characteristic notification</li>
<li>At this stage, Slaves.py script starts Num_Slave characteristic notifications.</li>
</ul>
<p>3) Configure Num_Masters devices as follow:</p>
<p><b>Master device role</b></p>
<p>Master device role simply configures a BlueNRG-1, BlueNRG-2 device as a Master device looking for the Master_Slave device in advertising with advertising name = advscan. Once Master device finds advscan device it connects to it, and it enables the characteristic notification. Notifications from Num_Slaves devices will be notified to Master device through the Master_Slave device.</p>
<p>How to configure a Master device?</p>
<ul>
<li>Download the Project\BLE_Examples\BLE_MS_Formula\EWARM\[BlueNRG-1/BlueNRG-2]\Master\Exe\BLE_Master.hex, respectively, on the selected BlueNRG-1 or BlueNRG-2 STEVAL kit.</li>
<li>Open a hyper terminal with the described settings</li>
<li>Reset the selected BlueNRG-1 or BlueNRG-2 STEVAL kit: a discovery procedure starts for finding the Master_Slave device and connect to it.</li>
</ul>
<p>NOTE: Alternatevely user can configure a Master device running the Master_Slave.py script</p>
<ul>
<li>Open BlueNRG GUI</li>
<li><b>BlueNRG-1,2 platforms configuration steps</b>:<ul>
<li>Connect the selected platform to a PC USB port</li>
<li>BlueNRG-1 platform: download the "C:\\Program Files (x86)\\STMicroelectronics\\BlueNRG GUI x.x.x\\Firmware\\DTM\\BlueNRG1\\DTM_UART.hex or DTM_SPI.hex" file, using the BlueNRG Flasher utility available on BlueNRG-1_2 DK SW package (STSW-BLUENRG1-DK)</li>
<li>BlueNRG-2 platform: download the "C:\\Program Files (x86)\\STMicroelectronics\\BlueNRG GUI x.x.x\\Firmware\DTM\BlueNRG2\\DTM_UART.hex or DTM_SPI.hex" file, using the BlueNRG Flasher utility available on BlueNRG-1_2 DK SW package (STSW-BLUENRG1-DK)</li>
<li><b>NOTES</b>: SPI Network coprocessor configuration file (DTM_SPI.hex) could require some HW changes to be applied to the BlueNRG-1 development platform. Refer to STSW-BNRGUI user manual UM2058.</li>
</ul>
</li>
<li>On BlueNRG GUI, open the USB Port associated to the plugged BlueNRG-1,2 platform</li>
<li>On BlueNRG GUI, select the Scripts window</li>
<li>On BlueNRG GUI, Scripts window, Scripts Engine section, click on ... tab and browse to the Master.py script location and select it</li>
<li>On BlueNRG GUI, click on Run Script tab for running the selected script</li>
<li>Master device is configured as Central and it performs a connection procedure for connecting to the Master_Slave device (advertising name = advscan)</li>
<li>Then Master device enables the characteristic notification on connected device.</li>
<li>At this stage, Master receives and displays the received characteristic values (slave_index component).</li>
<li>NOTE: Master device can also be a Smarthphone device running a simple BLE app (i.e. B-BLE on Android).</li>
</ul>
<p>How to use an Smartphone as second master ? (if Num_Masters = 2), (i.e. Android and B-BLE app as reference example)</p>
<ul>
<li>Select B-BLE app</li>
<li>Look for devices and selecte advscan</li>
<li>Once connected, selected characteristic with notify property and enable characteristic notification</li>
<li>Smarthphone app recevies notifications coming from Num_Slaves devices through the Master_Slave device </li>
</ul>

<p>Definition in file <a class="el" href="_b_l_e___m_s___formula__main_8c_source.html">BLE_MS_Formula_main.c</a>.</p>
</div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.10-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Copyright &copy; 2020 by STMicrolectronics. All rights reserved.<br>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
