<!-- HTML header for doxygen 1.8.10-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>BlueNRG-1_2 DK: BLE examples: Power_Consumption_Test.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="STcustom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ST-logo-small.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BlueNRG-1_2 DK: BLE examples
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">Power_Consumption_Test.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This demonstration application allows to properly configure the BlueNRG-1,2 devices and show the related current consumption during two BLE operating modes: advertising and connection.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &quot;BlueNRG1_it.h&quot;</code><br />
<code>#include &quot;BlueNRG1_conf.h&quot;</code><br />
<code>#include &quot;sleep.h&quot;</code><br />
<code>#include &quot;bluenrg1_stack.h&quot;</code><br />
<code>#include &quot;ble_status.h&quot;</code><br />
<code>#include &quot;ble_const.h&quot;</code><br />
<code>#include &quot;SDK_EVAL_Config.h&quot;</code><br />
<code>#include &quot;Power_Consumption_Test_config.h&quot;</code><br />
</div>
<p><a href="_power___consumption___test_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga95c6fe157bc003ccf8941c5e014424b3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___micro___sleep_test.html#ga95c6fe157bc003ccf8941c5e014424b3">ADV_INTERVAL_FAST_MS</a>&#160;&#160;&#160;100</td></tr>
<tr class="separator:ga95c6fe157bc003ccf8941c5e014424b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1eafbeb171d77a45b60ce99670971d5f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___micro___sleep_test.html#ga1eafbeb171d77a45b60ce99670971d5f">ADV_INTERVAL_SLOW_MS</a>&#160;&#160;&#160;1000</td></tr>
<tr class="separator:ga1eafbeb171d77a45b60ce99670971d5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga506f5b45c12fda67a1cf5bc59095cf19"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___micro___sleep_test.html#ga506f5b45c12fda67a1cf5bc59095cf19">DEVICE_IDLE_STATE</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:ga506f5b45c12fda67a1cf5bc59095cf19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gace479a7592116b2cc15754926c96f89f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___micro___sleep_test.html#gace479a7592116b2cc15754926c96f89f">DEVICE_ADV_STATE</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:gace479a7592116b2cc15754926c96f89f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga858ff61a8f2d54330cbdec79fe8570c5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___micro___sleep_test.html#ga858ff61a8f2d54330cbdec79fe8570c5">DEVICE_CONN_STATE</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:ga858ff61a8f2d54330cbdec79fe8570c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga389995d5cf56cde9fdd3160ea118c3ac"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___micro___sleep_test.html#ga389995d5cf56cde9fdd3160ea118c3ac">DEVICE_SLEEP_STATE</a>&#160;&#160;&#160;3</td></tr>
<tr class="separator:ga389995d5cf56cde9fdd3160ea118c3ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab793265c5beeaae033b4389fe417bf21"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___micro___sleep_test.html#gab793265c5beeaae033b4389fe417bf21">DEVICE_DISCONNECTED_STATE</a>&#160;&#160;&#160;4</td></tr>
<tr class="separator:gab793265c5beeaae033b4389fe417bf21"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga0bed8474bd33a912769360766f6b10d4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___micro___sleep_test.html#ga0bed8474bd33a912769360766f6b10d4">help</a> (void)</td></tr>
<tr class="separator:ga0bed8474bd33a912769360766f6b10d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9237af6f7adfd2b81439ae8542694b8b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___micro___sleep_test.html#ga9237af6f7adfd2b81439ae8542694b8b">DeviceInit</a> (void)</td></tr>
<tr class="separator:ga9237af6f7adfd2b81439ae8542694b8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga79190ff41c15f3486f25463073f5c38f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___micro___sleep_test.html#ga79190ff41c15f3486f25463073f5c38f">Set_DeviceConnectable</a> (uint16_t adv_interval)</td></tr>
<tr class="separator:ga79190ff41c15f3486f25463073f5c38f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga840291bc02cba5474a4cb46a9b9566fe"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___micro___sleep_test.html#ga840291bc02cba5474a4cb46a9b9566fe">main</a> (void)</td></tr>
<tr class="separator:ga840291bc02cba5474a4cb46a9b9566fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaece7033575eb4f06316516d9a761c2cb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___micro___sleep_test.html#gaece7033575eb4f06316516d9a761c2cb">hci_hardware_error_event</a> (uint8_t Hardware_Code)</td></tr>
<tr class="separator:gaece7033575eb4f06316516d9a761c2cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga32e611292f1bb2f1b53304bd222352f3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___micro___sleep_test.html#ga32e611292f1bb2f1b53304bd222352f3">aci_hal_fw_error_event</a> (uint8_t FW_Error_Type, uint8_t Data_Length, uint8_t Data[])</td></tr>
<tr class="separator:ga32e611292f1bb2f1b53304bd222352f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaca8160d0515ff237c4c8f4db8e45c77a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___micro___sleep_test.html#gaca8160d0515ff237c4c8f4db8e45c77a">hci_le_connection_complete_event</a> (uint8_t Status, uint16_t Connection_Handle, uint8_t Role, uint8_t Peer_Address_Type, uint8_t Peer_Address[6], uint16_t Conn_Interval, uint16_t Conn_Latency, uint16_t Supervision_Timeout, uint8_t Master_Clock_Accuracy)</td></tr>
<tr class="separator:gaca8160d0515ff237c4c8f4db8e45c77a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga28dfb4e4d94437eac75340723ba42628"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___micro___sleep_test.html#ga28dfb4e4d94437eac75340723ba42628">hci_disconnection_complete_event</a> (uint8_t Status, uint16_t Connection_Handle, uint8_t Reason)</td></tr>
<tr class="separator:ga28dfb4e4d94437eac75340723ba42628"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga14e334d9b8e2d5f94f5f222fd24f157e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___micro___sleep_test.html#ga14e334d9b8e2d5f94f5f222fd24f157e">HAL_VTimerTimeoutCallback</a> (uint8_t timerNum)</td></tr>
<tr class="separator:ga14e334d9b8e2d5f94f5f222fd24f157e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:gad0fc5ba1666cbbea74a6f4219d8538b4"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___micro___sleep_test.html#gad0fc5ba1666cbbea74a6f4219d8538b4">device_state</a></td></tr>
<tr class="separator:gad0fc5ba1666cbbea74a6f4219d8538b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacd6fbfe6efa8c33032e69831f75e6e18"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___micro___sleep_test.html#gacd6fbfe6efa8c33032e69831f75e6e18">connection_interval</a></td></tr>
<tr class="separator:gacd6fbfe6efa8c33032e69831f75e6e18"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This demonstration application allows to properly configure the BlueNRG-1,2 devices and show the related current consumption during two BLE operating modes: advertising and connection. </p>
<h1><a class="anchor" id="KEIL_project"></a>
KEIL project</h1>
<p>To use the project with KEIL uVision 5 for ARM, please follow the instructions below:</p><ol type="1">
<li>Open the KEIL uVision 5 for ARM and select Project-&gt;Open Project menu.</li>
<li>Open the KEIL project <code> C:\{username}-1_2 DK x.x.x\Project\BLE_Examples\BLE_Power_Consumption\MDK-ARM\BlueNRG-1\BLE_Power_Consumption.uvprojx </code> or <code> C:\{username}-1_2 DK x.x.x\Project\BLE_Examples\BLE_Power_Consumption\MDK-ARM\BlueNRG-2\BLE_Power_Consumption.uvprojx </code></li>
<li>Select desired configuration to build</li>
<li>Select Project-&gt;Rebuild all target files. This will recompile and link the entire application</li>
<li>To download the binary image, please connect STLink to JTAG connector in your board (if available).</li>
<li>Select Project-&gt;Download to download the related binary image.</li>
<li>Alternatively, open the BlueNRG1 Flasher utility and download the built binary image.</li>
</ol>
<h1><a class="anchor" id="IAR_project"></a>
IAR project</h1>
<p>To use the project with IAR Embedded Workbench for ARM, please follow the instructions below:</p><ol type="1">
<li>Open the Embedded Workbench for ARM and select File-&gt;Open-&gt;Workspace menu.</li>
<li>Open the IAR project <code> C:\{username}-1_2 DK x.x.x\Project\BLE_Examples\BLE_Power_Consumption\EWARM\BlueNRG-1\BLE_Power_Consumption.eww </code> or <code> C:\{username}-1_2 DK x.x.x\Project\BLE_Examples\BLE_Power_Consumption\EWARM\BlueNRG-2\BLE_Power_Consumption.eww </code></li>
<li>Select desired configuration to build</li>
<li>Select Project-&gt;Rebuild All. This will recompile and link the entire application</li>
<li>To download the binary image, please connect STLink to JTAG connector in your board (if available).</li>
<li>Select Project-&gt;Download and Debug to download the related binary image.</li>
<li>Alternatively, open the BlueNRG1 Flasher utility and download the built binary image.</li>
</ol>
<h2><a class="anchor" id="Project_configurations"></a>
Project configurations</h2>
<ul>
<li><code>Release</code> - Release configuration</li>
</ul>
<h1><a class="anchor" id="Board_supported"></a>
Boards supported</h1>
<ul>
<li><code>STEVAL-IDB007V1</code> </li>
<li><code>STEVAL-IDB007V2</code> </li>
<li><code>STEVAL-IDB008V1</code> </li>
<li><code>STEVAL-IDB008V1M</code> </li>
<li><code>STEVAL-IDB008V2</code> </li>
<li><code>STEVAL-IDB009V1</code> </li>
</ul>
<h1><a class="anchor" id="Power_settings"></a>
Power configuration settings</h1>
<table  id="DoxyEmbeddedTable" border="1">
<tr id="HeadRow">
<td id="FirstColumn"><b>STEVAL-IDB00XV1</b> </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">Jumper name</td><td id="MiddleColumn"></td><td id="LastColumn">Description </td></tr>
<tr id="HeadRow">
<td id="FirstColumn"><b>JP1</b></td><td id="MiddleColumn"><b>JP2</b></td><td id="LastColumn"><b></b> </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">ON 1-2</td><td id="MiddleColumn">ON 2-3</td><td id="LastColumn">USB supply power </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">ON 2-3</td><td id="MiddleColumn">ON 1-2</td><td id="LastColumn">The supply voltage must be provided through battery pins. </td></tr>
<tr id="LastRow">
<td id="FirstColumn">ON 1-2</td><td id="MiddleColumn"></td><td id="LastColumn">USB supply power to STM32L1, JP2 pin 2 external power to BlueNRG1 </td></tr>
</table>
<h1><a class="anchor" id="Jumper_settings"></a>
Jumper settings</h1>
<table  id="DoxyEmbeddedTable" border="1">
<tr id="HeadRow">
<td id="FirstColumn"><b>STEVAL-IDB00XV1</b> </td></tr>
<tr id="HeadRow">
<td id="FirstColumn"><b>Jumper name</b></td><td id="LastColumn"><b>Description</b> </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">JP1</td><td id="LastColumn">1-2: to provide power from USB (JP2:2-3). 2-3: to provide power from battery holder (JP2:1-2) </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">JP2</td><td id="LastColumn">1-2: to provide power from battery holder (JP1:2-3). 2-3: to provide power from USB (JP1:1-2). Pin2 to VDD to provide external power supply to BlueNRG-1 (JP1: 1-2) </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">JP3</td><td id="LastColumn">pin 1 and 2 UART RX and TX of MCU. pin 3 GND. </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">JP4</td><td id="LastColumn">Fitted: to provide VBLUE to BlueNRG1. It can be used also for current measurement. </td></tr>
<tr id="LastRow">
<td id="FirstColumn">JP5</td><td id="LastColumn">Fitted : TEST pin to VBLUE. Not fitted: TEST pin to GND </td></tr>
</table>
<h1><a class="anchor" id="Pin_settings"></a>
Pin settings</h1>
<table  id="DoxyEmbeddedTable" border="1">
<tr id="HeadRow">
<td id="FirstColumn"><b>PIN name</b></td><td id="MiddleColumn"><b>STEVAL-IDB007V1</b></td><td id="MiddleColumn"><b>STEVAL-IDB007V2</b></td><td id="MiddleColumn"><b>STEVAL-IDB008V1</b></td><td id="MiddleColumn"><b>STEVAL-IDB008V1M</b></td><td id="MiddleColumn"><b>STEVAL-IDB008V2</b></td><td id="LastColumn"><b>STEVAL-IDB009V1</b> </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">ADC1</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">ADC2</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">GND</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="LastColumn">N.A. </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO0</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO1</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO11</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO12</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO13</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO14</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO15</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO16</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO17</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO18</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO19</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO2</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO20</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO21</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO22</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO23</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO24</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO25</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO3</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO4</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO5</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO6</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO7</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO8</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">RESETN</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="LastColumn">N.A. </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">TEST1</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="LastRow">
<td id="FirstColumn">VBLUE</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="LastColumn">N.A. </td></tr>
</table>
<h1><a class="anchor" id="Serial_IO"></a>
Serial I/O</h1>
<p>The application will listen for keys typed and it will execute the associated command. </p><table  id="DoxyEmbeddedTable" border="1">
<tr id="HeadRow">
<td id="FirstColumn"><b>Parameter name</b></td><td id="MiddleColumn"><b>Value</b></td><td id="LastColumn"><b>Unit</b> </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">Baudrate</td><td id="MiddleColumn">115200 [default]</td><td id="LastColumn">bit/sec </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">Data bits</td><td id="MiddleColumn">8</td><td id="LastColumn">bit </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">Parity</td><td id="MiddleColumn">None</td><td id="LastColumn">bit </td></tr>
<tr id="LastRow">
<td id="FirstColumn">Stop bits</td><td id="MiddleColumn">1</td><td id="LastColumn">bit </td></tr>
</table>
<h1><a class="anchor" id="LEDs_description"></a>
LEDs description</h1>
<table  id="DoxyEmbeddedTable" border="1">
<tr id="HeadRow">
<td id="FirstColumn"><b>LED name</b></td><td id="MiddleColumn"><b>STEVAL-IDB007V1</b></td><td id="MiddleColumn"><b>STEVAL-IDB007V2</b></td><td id="MiddleColumn"><b>STEVAL-IDB008V1</b></td><td id="MiddleColumn"><b>STEVAL-IDB008V1M</b></td><td id="MiddleColumn"><b>STEVAL-IDB008V2</b></td><td id="LastColumn"><b>STEVAL-IDB009V1</b> </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">DL1</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">DL2</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">DL3</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="LastRow">
<td id="FirstColumn">DL4</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
</table>
<h1><a class="anchor" id="Buttons_description"></a>
Buttons description</h1>
<table  id="DoxyEmbeddedTable" border="1">
<tr id="HeadRow">
<td id="FirstColumn"><b>BUTTON name</b></td><td id="MiddleColumn"><b>STEVAL-IDB007V1</b></td><td id="MiddleColumn"><b>STEVAL-IDB007V2</b></td><td id="MiddleColumn"><b>STEVAL-IDB008V1</b></td><td id="MiddleColumn"><b>STEVAL-IDB008V1M</b></td><td id="MiddleColumn"><b>STEVAL-IDB008V2</b></td><td id="LastColumn"><b>STEVAL-IDB009V1</b> </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">PUSH1</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">PUSH2</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="LastRow">
<td id="FirstColumn">RESET</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
</table>
<h1><a class="anchor" id="Usage"></a>
Usage</h1>
<p>The application allow to put the selected BLE device in discovery mode: user can select from a test menu which advertising interval to use (100 ms or 1000 ms). To take the BlueNRG-1,2 current consumption is necessary to connect a DC power analyzer to the JP4 connector of the STEVAL-IDB007V1, STEVAL-IDB008V1 kit platforms. Further, user can setup a connection with another device configured as a master and take the related power consumption measurements. The master role can be covered from another BlueNRG-1, BlueNRG-2 kit platform configured with the DTM FW application (DTM_UART.hex), and running a specific script through BlueNRG GUI or Script launcher PC applications. On BLE_Power_Consumption demo application project folder, two scripts are provided for configuring the master device and create a connection with the BlueNRG-1,2 kit platform under test. The two scripts allow to establish a connection with, respectively, 100 ms and 1000 ms as connection interval.</p>
<p>The power consumption demo supports some test commands:</p><ul>
<li><b>f</b>: Device in Discoverable mode with fast interval 100 ms.</li>
<li><b>s</b>: Device in discoverable mode with slow interval 1000 ms.</li>
<li><b>r</b>: Reset the BlueNRG-1.</li>
<li><b>?</b>: Display this help menu.</li>
</ul>
<p>The following table provides the BlueNRG-1, BlueNRG-2 current consumption values on the highlighted tests scenarios:</p>
<table  id="DoxyEmbeddedTable" border="1">
<tr id="HeadRow">
<td id="FirstColumn"><b>BLE Stack version</b></td><td id="MiddleColumn"><b>Advertising 100 ms</b></td><td id="MiddleColumn"><b>Advertising 1000 ms</b></td><td id="MiddleColumn"><b>Connection 100 ms</b></td><td id="LastColumn"><b>Connection 1000 ms</b> </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">V2.0</td><td id="MiddleColumn">136.931 uA</td><td id="MiddleColumn">15.342 uA</td><td id="MiddleColumn">50.423 uA</td><td id="LastColumn">7.059 uA </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">V2.1 Basic</td><td id="MiddleColumn">146.06 uA</td><td id="MiddleColumn">17.326 uA</td><td id="MiddleColumn">53.966 uA</td><td id="LastColumn">7.439 uA </td></tr>
<tr id="LastRow">
<td id="FirstColumn">V2.1 Full</td><td id="MiddleColumn">145.96 uA</td><td id="MiddleColumn">15.645 uA</td><td id="MiddleColumn">54.156 uA</td><td id="LastColumn">7.492 uA </td></tr>
</table>

<p>Definition in file <a class="el" href="_power___consumption___test_8c_source.html">Power_Consumption_Test.c</a>.</p>
</div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.10-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Copyright &copy; 2020 by STMicrolectronics. All rights reserved.<br>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
