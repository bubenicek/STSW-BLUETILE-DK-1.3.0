<!-- HTML header for doxygen 1.8.10-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>BlueNRG-BLE Stack Library GATT database: GATT database size guidelines</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="STcustom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ST-logo-small.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BlueNRG-BLE Stack Library GATT database
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">GATT database size guidelines </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The present document guidelines are intended to help users of the BlueNRG-BLE Stack Library Stack Library (STMicroelectronics Bluetooth Low Energy (BLE) stack) to properly set the size of the GATT database according to the specific application profiles that the target application is going to implement.</p>
<h1><a class="anchor" id="G1"></a>
Number of GATT Service Records</h1>
<ul>
<li>The service record is the base data structure used in the GATT database implementation to handle GATT services. </li>
<li>The number of service records needed by the user application can be determined based on the number of services required by the specific profiles that the application implements. </li>
<li><b> Notes: </b> <ul>
<li>
GAP and GATT services are automatically added to the database during device initialization hence the total number of service records should be 2 plus the number of services strictly needed by the profiles <ul>
<li>
Future BLE library versions may remove or modify such automatic addition of service and characteristics.</li>
</ul>
</li>
<li>
This value is set through the <b> BlueNRG_Stack_Initialization() API, BlueNRG_Stack_Initialization_t parameter, numAttrServ field </b>. </li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="G2"></a>
Number of GATT Attribute Records</h1>
<ul>
<li>The attribute record is the base data structure used in the GATT database implementation to handle GATT attributes. </li>
<li>The number of attribute records needed by the user application can be determined based on the number of characteristics and related descriptors required by the specific profiles that the application implements. <ul>
<li>
When a GATT characteristic is added to the database a minimum of 2 attribute records are needed: one for the characteristic declaration and one for the characteristic value. On top of this, additional records may be needed based on the characteristic properties, in particular: <ul>
<li>
If the characteristic has the notify or indicate property set, then one additional attribute record is needed. </li>
<li>
If the characteristic has the broadcast property set, then one additional attribute record is needed. </li>
<li>
If the characteristic has the extended property set, then one additional attribute record is needed. </li>
</ul>
</li>
<li>
In summary, one characteristic may need from 2 to 5 attribute records depending on the characteristic properties. </li>
<li>
Certain characteristics and relative descriptors related to the GAP and GATT services are automatically added to the database during device initialization hence the total number of attribute records should be 9 plus the number of attributes strictly needed by the profiles <ul>
<li>
Future BLE library versions may remove or modify such automatic addition of service and characteristics </li>
</ul>
</li>
</ul>
</li>
<li><b> Notes: </b> <ul>
<li>
This value is set through the <b> BlueNRG_Stack_Initialization() API, BlueNRG_Stack_Initialization_t parameter, numAttrRecord field</b>. </li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="G3"></a>
Size of the Value Array</h1>
<ul>
<li>The value array is a memory area used to store attribute values. When the size of such memory area is calculated, the total occupancy of characteristics and description must be taken into account. In particular: <ul>
<li>
If the characteristic UUID is 16 bit, then 5 additional bytes are needed for characteristic declaration; if the characteristic UUID is 128 bit, then 19 additional bytes are needed for characteristic declaration </li>
<li>
If the server configuration descriptor is added for a characteristic then 2 additional value bytes are needed </li>
<li>
If the client configuration descriptor is added for a characteristic then 2 additional value bytes for each simultaneous connection are needed </li>
<li>
If the extended properties is added for a characteristic then 2 additional value bytes are needed </li>
</ul>
</li>
<li>In summary, one characteristic may need from 5 to 25 additional storage bytes, on top of the characteristic value length. </li>
<li><b> Notes: </b> <ul>
<li>
This value is set through the <b> BlueNRG_Stack_Initialization() API, BlueNRG_Stack_Initialization_t parameter, attrValueArrSize field </b>. </li>
</ul>
</li>
</ul>
</div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.10-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Copyright &copy; 2020 by STMicrolectronics. All rights reserved.<br>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
