<!-- HTML header for doxygen 1.8.10-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>BlueNRG-1,2 Peripherals drivers APIs: BlueNRG1_timer.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ST-logo-small.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BlueNRG-1,2 Peripherals drivers APIs
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">BlueNRG1_timer.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_blue_n_r_g1__timer_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">/* Includes ------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_blue_n_r_g1__timer_8h.html">BlueNRG1_timer.h</a>&quot;</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div>
<div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="structtimer__context__s.html">   72</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structtimer__context__s.html">timer_context_s</a> {</div>
<div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="structtimer__context__s.html#ab66f7aedfedc98a2ac86d44ff7611de7">   73</a></span>&#160;  uint64_t <a class="code" href="structtimer__context__s.html#ab66f7aedfedc98a2ac86d44ff7611de7">cumulative_time</a>; </div>
<div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="structtimer__context__s.html#aa07e91b072d117eb3678dea01b29c199">   74</a></span>&#160;  uint64_t <a class="code" href="structtimer__context__s.html#aa07e91b072d117eb3678dea01b29c199">last_calibration_time</a>; </div>
<div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="structtimer__context__s.html#a5d3123428eced128897fe6ac6688373e">   75</a></span>&#160;  uint32_t <a class="code" href="structtimer__context__s.html#a5d3123428eced128897fe6ac6688373e">hs_startup_time</a>; </div>
<div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="structtimer__context__s.html#adb892e5afb9966143fe8af5268b65ccf">   76</a></span>&#160;  uint8_t <a class="code" href="structtimer__context__s.html#adb892e5afb9966143fe8af5268b65ccf">wakeup_time_offset</a>; </div>
<div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="structtimer__context__s.html#ae62febdb134bc78223e5d26dd7f837e3">   77</a></span>&#160;  uint16_t <a class="code" href="structtimer__context__s.html#ae62febdb134bc78223e5d26dd7f837e3">period_slow</a>; </div>
<div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="structtimer__context__s.html#a46972ef9e28fdd4b4d295deda5495aac">   78</a></span>&#160;  uint16_t <a class="code" href="structtimer__context__s.html#a46972ef9e28fdd4b4d295deda5495aac">last_period_slow</a>; </div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="structtimer__context__s.html#ae4709c8010902304bbd1ebd776d9fa60">   79</a></span>&#160;  uint32_t <a class="code" href="structtimer__context__s.html#ae4709c8010902304bbd1ebd776d9fa60">period</a>; </div>
<div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="structtimer__context__s.html#ad200cbb24ee96f76c974e6ae24daf98c">   80</a></span>&#160;  uint32_t <a class="code" href="structtimer__context__s.html#ad200cbb24ee96f76c974e6ae24daf98c">freq</a>; </div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="structtimer__context__s.html#ae8215266d87490b0da83be2091441a32">   81</a></span>&#160;  uint32_t <a class="code" href="structtimer__context__s.html#ae8215266d87490b0da83be2091441a32">freq1</a>; </div>
<div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="structtimer__context__s.html#ab0ff3bc7654bccb35da0840fd0b3ad09">   82</a></span>&#160;  uint32_t <a class="code" href="structtimer__context__s.html#ab0ff3bc7654bccb35da0840fd0b3ad09">period1</a>; </div>
<div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="structtimer__context__s.html#abc42dc0fc7154486ef336dc662470c37">   83</a></span>&#160;  uint32_t <a class="code" href="structtimer__context__s.html#abc42dc0fc7154486ef336dc662470c37">last_period1</a>; </div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="structtimer__context__s.html#afc90bdf2ec7abe1ea8569ea6375c282f">   84</a></span>&#160;  uint32_t <a class="code" href="structtimer__context__s.html#afc90bdf2ec7abe1ea8569ea6375c282f">last_machine_time</a>; </div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="structtimer__context__s.html#aab6c9f44474c2efae3fa6178d7549dc2">   85</a></span>&#160;  uint32_t <a class="code" href="structtimer__context__s.html#aab6c9f44474c2efae3fa6178d7549dc2">last_calibration_machine_time</a>; </div>
<div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="structtimer__context__s.html#a8b516120d60b773df78df4863e34dbd7">   86</a></span>&#160;  uint8_t  <a class="code" href="structtimer__context__s.html#a8b516120d60b773df78df4863e34dbd7">periodic_calibration</a>; </div>
<div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="structtimer__context__s.html#a293e51cc013dea852f36048e670dc131">   87</a></span>&#160;  uint32_t <a class="code" href="structtimer__context__s.html#a293e51cc013dea852f36048e670dc131">host_time</a>; </div>
<div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="structtimer__context__s.html#a5c0f8f2501a73bd5ea7882c42b035d4d">   88</a></span>&#160;  uint32_t <a class="code" href="structtimer__context__s.html#a5c0f8f2501a73bd5ea7882c42b035d4d">wakeup_time</a>; </div>
<div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="structtimer__context__s.html#a13a03153d810d652c5992139312808d1">   89</a></span>&#160;  uint8_t <a class="code" href="structtimer__context__s.html#a13a03153d810d652c5992139312808d1">tx_cal_delay_st</a>; </div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="structtimer__context__s.html#a440f5a272d99f879ec97794b1f715769">   90</a></span>&#160;  uint8_t <a class="code" href="structtimer__context__s.html#a440f5a272d99f879ec97794b1f715769">tx_no_cal_delay_st</a>; </div>
<div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="structtimer__context__s.html#a3e616599a2563904bd385a15f60b6c73">   91</a></span>&#160;  uint8_t <a class="code" href="structtimer__context__s.html#a3e616599a2563904bd385a15f60b6c73">rx_cal_delay_st</a>; </div>
<div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="structtimer__context__s.html#aa3260b2f7c390bff2172d290083a9731">   92</a></span>&#160;  uint8_t <a class="code" href="structtimer__context__s.html#aa3260b2f7c390bff2172d290083a9731">rx_no_cal_delay_st</a>; </div>
<div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="structtimer__context__s.html#a9b523390624020567145ec3b0a35a700">   93</a></span>&#160;  int16_t <a class="code" href="structtimer__context__s.html#a9b523390624020567145ec3b0a35a700">roundingError</a>;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;} <a class="code" href="group___t_i_m_e_r___private___types_definitions.html#ga535132efc461718adb8d3d52e7d47563">TIMER_ContextType</a>;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div>
<div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="group___t_i_m_e_r___private___macros.html#ga1f63d063dc08bd8eff4c15e3942793a7">  111</a></span>&#160;<span class="preprocessor">#define TIMER_20MSB_MASK 0xFFFFF0</span></div>
<div class="line"><a name="l00112"></a><span class="lineno"><a class="line" href="group___t_i_m_e_r___private___macros.html#ga688ae1692c44833bfe88c044e6be2fe8">  112</a></span>&#160;<span class="preprocessor">#define TIME24_DIFF(a, b)       (((int32_t)((a - b) &lt;&lt; 8)) &gt;&gt; 8)</span></div>
<div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="group___t_i_m_e_r___private___macros.html#gae1010f6bb6df72adfefbcf4290eb9694">  113</a></span>&#160;<span class="preprocessor">#define TIME_DIFF(a, b)       (((int32_t)((a - b) &lt;&lt; (32-TIMER_BITS))) &gt;&gt; (32-TIMER_BITS))</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">/* This define assumes that a is always greater than b */</span></div>
<div class="line"><a name="l00116"></a><span class="lineno"><a class="line" href="group___t_i_m_e_r___private___macros.html#gaccb016a73722365d8453eea25a32cdf7">  116</a></span>&#160;<span class="preprocessor">#define TIME_ABSDIFF(a, b)       ((a - b) &amp; TIMER_MAX_VALUE)</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div>
<div class="line"><a name="l00118"></a><span class="lineno"><a class="line" href="group___t_i_m_e_r___private___macros.html#ga3acffbd305ee72dcd4593c0d8af64a4f">  118</a></span>&#160;<span class="preprocessor">#define MIN(a,b) ((a) &lt; (b) )? (a) : (b)</span></div>
<div class="line"><a name="l00119"></a><span class="lineno"><a class="line" href="group___t_i_m_e_r___private___macros.html#gafa99ec4acc4ecb2dc3c2d05da15d0e3f">  119</a></span>&#160;<span class="preprocessor">#define MAX(a,b) ((a) &lt; (b) )? (b) : (a)</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div>
<div class="line"><a name="l00121"></a><span class="lineno"><a class="line" href="group___t_i_m_e_r___private___macros.html#ga125af6df2956a88705c7efdba86cabe5">  121</a></span>&#160;<span class="preprocessor">#define ATOMIC_SECTION_BEGIN() uint32_t uwPRIMASK_Bit = __get_PRIMASK(); \</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="preprocessor">                                __disable_irq(); \</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="preprocessor"></span><span class="comment">/* Must be called in the same scope of ATOMIC_SECTION_BEGIN */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00124"></a><span class="lineno"><a class="line" href="group___t_i_m_e_r___private___macros.html#gacfff8120ca5315b54cc5ff907c83902d">  124</a></span>&#160;<span class="preprocessor">#define ATOMIC_SECTION_END() __set_PRIMASK(uwPRIMASK_Bit)</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div>
<div class="line"><a name="l00126"></a><span class="lineno"><a class="line" href="group___t_i_m_e_r___private___macros.html#gaf7a3333fbe5be3a1d099d7e6b7c81efa">  126</a></span>&#160;<span class="preprocessor">#define TIMER_SEL_THR 20//75</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div>
<div class="line"><a name="l00128"></a><span class="lineno"><a class="line" href="group___t_i_m_e_r___private___macros.html#ga634253e2e42ed873f90fecbe06a2a229">  128</a></span>&#160;<span class="preprocessor">#define TIMER_TX_EVENT 1</span></div>
<div class="line"><a name="l00129"></a><span class="lineno"><a class="line" href="group___t_i_m_e_r___private___macros.html#gad2645c3746cb1699f40a0e9d7d31d735">  129</a></span>&#160;<span class="preprocessor">#define TIMER_RX_EVENT 0</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                                  </div>
<div class="line"><a name="l00131"></a><span class="lineno"><a class="line" href="group___t_i_m_e_r___private___macros.html#ga85a9917ff14fede3258d8e7b866e16c9">  131</a></span>&#160;<span class="preprocessor">#define WAKEUP_TIMER_EN (1&lt;&lt;24)</span></div>
<div class="line"><a name="l00132"></a><span class="lineno"><a class="line" href="group___t_i_m_e_r___private___macros.html#ga8964acb693ef3063dc7aac5b37a606cb">  132</a></span>&#160;<span class="preprocessor">#define TIMER1_EN       (1&lt;&lt;25)</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                                  </div>
<div class="line"><a name="l00141"></a><span class="lineno"><a class="line" href="group___t_i_m_e_r___private___variables.html#gaf454441a6ed3ab9274cd6fa0a67c5041">  141</a></span>&#160;<a class="code" href="structtimer__context__s.html">TIMER_ContextType</a> <a class="code" href="group___t_i_m_e_r___private___variables.html#gaf454441a6ed3ab9274cd6fa0a67c5041">TIMER_Context</a>;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> _timer_start_calibration(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;{</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="comment">/* Clear any pending interrupt */</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  CKGEN_BLE-&gt;CLK32K_IT = 1;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  CKGEN_BLE-&gt;CLK32K_PERIOD = 0;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;}</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> _get_calibration_data(<a class="code" href="structtimer__context__s.html">TIMER_ContextType</a> *context)</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;{</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  uint32_t mult = 0x753 ;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  uint32_t freq = CKGEN_BLE-&gt;CLK32K_FREQ;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  uint32_t period = CKGEN_BLE-&gt;CLK32K_PERIOD;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  uint32_t a1 = freq &gt;&gt; 6 ;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  uint32_t a2 = a1 * mult ;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  uint32_t mul1 = 0x8BCF6 ;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  uint32_t b1 = period &gt;&gt; 8 ;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  uint32_t b2 = period &amp; 0xff ;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  context-&gt;<a class="code" href="structtimer__context__s.html#ab0ff3bc7654bccb35da0840fd0b3ad09">period1</a> = ((mul1 * b1) + ((b2 * mul1)&gt;&gt;8) + 16 )&gt;&gt;5 ;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  context-&gt;<a class="code" href="structtimer__context__s.html#ae8215266d87490b0da83be2091441a32">freq1</a> = (a2 + 128) &gt;&gt; 8 ;      </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  context-&gt;<a class="code" href="structtimer__context__s.html#ae4709c8010902304bbd1ebd776d9fa60">period</a> = period;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  context-&gt;<a class="code" href="structtimer__context__s.html#ad200cbb24ee96f76c974e6ae24daf98c">freq</a> = freq;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  context-&gt;<a class="code" href="structtimer__context__s.html#ae62febdb134bc78223e5d26dd7f837e3">period_slow</a> = ((period * 1365) &gt;&gt; 16);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;}</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> _timer_calibrate(<a class="code" href="structtimer__context__s.html">TIMER_ContextType</a> *context)</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;{</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  _timer_start_calibration();</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="keywordflow">while</span>(CKGEN_BLE-&gt;CLK32K_IT == 0);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  _get_calibration_data(context);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;}</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> update_interpolator(uint16_t period_slow)</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;{</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  __blue_RAM.BlueGlobVar.period_slow = period_slow;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="comment">/* The only mechanism to reload the table is to trigger a fake wakeup with no</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">  radio activity. Otherwise the value of period slow will be loaded at the next wakeup timer timeout*/</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="keywordflow">if</span> ((__blue_RAM.BlueGlobVar.Config &amp; 8U) == 0) {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="comment">/* Fake wakeup to make sure that interpolator take into account period_slow stored in RAM */</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="comment">/* Interrupt should be disabled because we can risk to wait for wrapping ??? */</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    uint32_t timeout = (BLUE_CTRL-&gt;CURRENT_TIME + 2) &amp; <a class="code" href="group___t_i_m_e_r___exported___constants.html#ga00ba68f62b52b73c91ed948087a5f3df">TIMER_MAX_VALUE</a>;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordflow">while</span> (timeout &lt; 2) {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      timeout = (BLUE_CTRL-&gt;CURRENT_TIME + 2) &amp; <a class="code" href="group___t_i_m_e_r___exported___constants.html#ga00ba68f62b52b73c91ed948087a5f3df">TIMER_MAX_VALUE</a>;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    }</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    BLUE_CTRL-&gt;TIMEOUT = (timeout)| (1&lt;&lt;24);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordflow">while</span> (BLUE_CTRL-&gt;CURRENT_TIME &lt; (timeout));</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="comment">/*After the fake wake up, the interpolator needs about half slow clock </span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">    cycle before to start counting correctly. In this time interval, if TIMEOUT</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">    register is written, the value of period_slow is ignored. This is a problem</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">    if the first radio activity is scheduled with the timer1. */</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    timeout = (BLUE_CTRL-&gt;CURRENT_TIME + 16) &amp; <a class="code" href="group___t_i_m_e_r___private___macros.html#ga1f63d063dc08bd8eff4c15e3942793a7">TIMER_20MSB_MASK</a>;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">while</span> (BLUE_CTRL-&gt;CURRENT_TIME &lt; (timeout));</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="comment">/*Disabling timer*/</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    BLUE_CTRL-&gt;TIMEOUT = (1 &lt;&lt; 28);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  }</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;}</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="keyword">static</span> uint32_t systime_to_machinetime(uint32_t time, uint32_t freq)</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;{</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="preprocessor"> #if TIME_CONVERSION2 </span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <span class="keyword">static</span> <span class="keyword">volatile</span> uint64_t time_tmp, time_tmp2;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  time_tmp = (uint64_t)time*(uint64_t)freq;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  time_tmp2 = ((time_tmp+(1U&lt;&lt;20))&gt;&gt;21);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="keywordflow">return</span> (uint32_t)time_tmp2;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  uint32_t time1 = (time &gt;&gt; 15) ;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  uint32_t time2 = time &amp; 0x7fff ;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  uint32_t freq1 = freq &gt;&gt; 7 ;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  uint32_t result = freq*time1 + ((time2 * freq1) &gt;&gt; 8) ;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="keywordflow">return</span>((result + 32) &gt;&gt; 6) ;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;}</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="keyword">static</span> uint32_t us_to_systime(uint32_t time)</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;{</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  uint32_t t1, t2;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  t1 = time * 0x68;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  t2 = time * 0xDB;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="keywordflow">return</span> (t1 &gt;&gt; 8) + (t2 &gt;&gt; 16);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;}</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="keyword">static</span> uint32_t us_to_machinetime(uint32_t time)</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;{</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="keywordflow">return</span> systime_to_machinetime(us_to_systime(time),TIMER_Context.<a class="code" href="structtimer__context__s.html#ae8215266d87490b0da83be2091441a32">freq1</a>);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;}</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="keyword">static</span> uint32_t machinetime_to_systime(uint32_t time, uint32_t period1, int16_t* round_err)</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;{</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="preprocessor">#if TIME_CONVERSION2</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  uint64_t period_global = (uint64_t)period1;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  uint64_t result_tmp = period_global*(uint64_t)time;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  uint32_t result_round = (uint32_t)((result_tmp+(1&lt;&lt;20))&gt;&gt;21);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="keywordflow">return</span> result_round;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  uint32_t time1 = (time &gt;&gt; 14);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  uint32_t time2 = time &amp; 0x3fff;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  uint32_t per1 = period1 &gt;&gt; 8;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  uint32_t result = period1*time1 + ((time2 * per1) &gt;&gt; 6) - (uint32_t)(int32_t)*round_err;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  uint32_t result_round = (result + 64) &gt;&gt; 7;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  uint32_t result_round_u32 = (result_round&lt;&lt;7)-result;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  *round_err = (int16_t)result_round_u32;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <span class="keywordflow">return</span> result_round;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;}</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="keyword">static</span> uint64_t get_system_time_and_machine(<a class="code" href="structtimer__context__s.html">TIMER_ContextType</a> *context, uint32_t *current_machine_time)</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;{</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  uint32_t difftime;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  uint64_t new_time = context-&gt;<a class="code" href="structtimer__context__s.html#ab66f7aedfedc98a2ac86d44ff7611de7">cumulative_time</a>;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  *current_machine_time = BLUE_CTRL-&gt;CURRENT_TIME;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  difftime = <a class="code" href="group___t_i_m_e_r___private___macros.html#gaccb016a73722365d8453eea25a32cdf7">TIME_ABSDIFF</a>(*current_machine_time, context-&gt;<a class="code" href="structtimer__context__s.html#afc90bdf2ec7abe1ea8569ea6375c282f">last_machine_time</a>);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  new_time += machinetime_to_systime(difftime,context-&gt;<a class="code" href="structtimer__context__s.html#ab0ff3bc7654bccb35da0840fd0b3ad09">period1</a>,&amp;(context-&gt;<a class="code" href="structtimer__context__s.html#a9b523390624020567145ec3b0a35a700">roundingError</a>));</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <span class="keywordflow">return</span> new_time;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;}</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="keyword">static</span> uint64_t get_system_time(<a class="code" href="structtimer__context__s.html">TIMER_ContextType</a> *context)</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;{</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  uint32_t current_machine_time;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="keywordflow">return</span> get_system_time_and_machine(context, &amp;current_machine_time);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;}</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> update_system_time(<a class="code" href="structtimer__context__s.html">TIMER_ContextType</a> *context)</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;{</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  uint32_t current_machine_time;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  current_machine_time = BLUE_CTRL-&gt;CURRENT_TIME;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  uint32_t period = context-&gt;<a class="code" href="structtimer__context__s.html#abc42dc0fc7154486ef336dc662470c37">last_period1</a>;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  context-&gt;<a class="code" href="structtimer__context__s.html#ab66f7aedfedc98a2ac86d44ff7611de7">cumulative_time</a> = context-&gt;<a class="code" href="structtimer__context__s.html#aa07e91b072d117eb3678dea01b29c199">last_calibration_time</a> + \</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  machinetime_to_systime(<a class="code" href="group___t_i_m_e_r___private___macros.html#gaccb016a73722365d8453eea25a32cdf7">TIME_ABSDIFF</a>(current_machine_time,</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                                        context-&gt;<a class="code" href="structtimer__context__s.html#aab6c9f44474c2efae3fa6178d7549dc2">last_calibration_machine_time</a>),</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                                        period,</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                                        &amp;(context-&gt;<a class="code" href="structtimer__context__s.html#a9b523390624020567145ec3b0a35a700">roundingError</a>));</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  context-&gt;<a class="code" href="structtimer__context__s.html#afc90bdf2ec7abe1ea8569ea6375c282f">last_machine_time</a> = current_machine_time;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  context-&gt;<a class="code" href="structtimer__context__s.html#aab6c9f44474c2efae3fa6178d7549dc2">last_calibration_machine_time</a> = current_machine_time;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  context-&gt;<a class="code" href="structtimer__context__s.html#aa07e91b072d117eb3678dea01b29c199">last_calibration_time</a> = context-&gt;<a class="code" href="structtimer__context__s.html#ab66f7aedfedc98a2ac86d44ff7611de7">cumulative_time</a>;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  context-&gt;<a class="code" href="structtimer__context__s.html#abc42dc0fc7154486ef336dc662470c37">last_period1</a> = context-&gt;<a class="code" href="structtimer__context__s.html#ab0ff3bc7654bccb35da0840fd0b3ad09">period1</a>;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;}</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> _update_xtal_startup_time(uint16_t hs_startup_time, uint32_t freq1)</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;{</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  uint32_t time1 = systime_to_machinetime(hs_startup_time, freq1) ;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="keywordflow">if</span>(time1 &gt;= 1024)</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    time1 = 1023 ;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="keywordflow">if</span> (time1 &lt; 8)</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    time1 = 8;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  TIMER_Context.<a class="code" href="structtimer__context__s.html#adb892e5afb9966143fe8af5268b65ccf">wakeup_time_offset</a> = time1 &gt;&gt; 3;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="keywordflow">if</span>((__blue_RAM.BlueGlobVar.Config &amp; 8U) == 0U)</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    __blue_RAM.BlueGlobVar.wakeup_time_offset = TIMER_Context.<a class="code" href="structtimer__context__s.html#adb892e5afb9966143fe8af5268b65ccf">wakeup_time_offset</a>;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;}</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div>
<div class="line"><a name="l00336"></a><span class="lineno"><a class="line" href="group___t_i_m_e_r___public___functions.html#ga3128db178d3e2c131cd6e24954c7917a">  336</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="group___t_i_m_e_r___public___functions.html#ga3128db178d3e2c131cd6e24954c7917a">TIMER_Init</a>(<a class="code" href="struct_t_i_m_e_r___init_type.html">TIMER_InitType</a>* TIMER_InitStruct)</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;{</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  TIMER_Context.<a class="code" href="structtimer__context__s.html#a5d3123428eced128897fe6ac6688373e">hs_startup_time</a> = TIMER_InitStruct-&gt;<a class="code" href="struct_t_i_m_e_r___init_type.html#a8f37d9e2ed1cb82d5036dad71fc33f21">XTAL_StartupTime</a>;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  <span class="keywordflow">if</span> (TIMER_InitStruct-&gt;<a class="code" href="struct_t_i_m_e_r___init_type.html#a89e12963b5c4c6d48b439bce9ce96700">TIMER_PeriodicCalibration</a> || TIMER_InitStruct-&gt;<a class="code" href="struct_t_i_m_e_r___init_type.html#a54241705faa9e03e4fefd6958b89a05f">TIMER_InitialCalibration</a>) {</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="comment">/* Make sure any pending calibration is over */</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keywordflow">while</span>(CKGEN_BLE-&gt;CLK32K_IT == 0);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="comment">/* Set SLOW_COUNT to 23, that is calibrate over 24 clock periods, this number</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">    cannot be changed without changing all the integer maths function in the</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">    file        */</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    CKGEN_BLE-&gt;CLK32K_COUNT_b.SLOW_COUNT=23;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    _timer_calibrate(&amp;TIMER_Context);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="comment">/* For first time set last to current */</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    TIMER_Context.<a class="code" href="structtimer__context__s.html#abc42dc0fc7154486ef336dc662470c37">last_period1</a> = TIMER_Context.<a class="code" href="structtimer__context__s.html#ab0ff3bc7654bccb35da0840fd0b3ad09">period1</a>;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  }</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="comment">/* Assume fix frequency at 32.768 kHz */</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    TIMER_Context.<a class="code" href="structtimer__context__s.html#abc42dc0fc7154486ef336dc662470c37">last_period1</a> = 0x00190000;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    TIMER_Context.<a class="code" href="structtimer__context__s.html#ab0ff3bc7654bccb35da0840fd0b3ad09">period1</a> = 0x00190000 ;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    TIMER_Context.<a class="code" href="structtimer__context__s.html#ae8215266d87490b0da83be2091441a32">freq1</a> = 0x0028F5C2 ;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    TIMER_Context.<a class="code" href="structtimer__context__s.html#ae4709c8010902304bbd1ebd776d9fa60">period</a> = 23437;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    TIMER_Context.<a class="code" href="structtimer__context__s.html#ad200cbb24ee96f76c974e6ae24daf98c">freq</a> = 23456748;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    TIMER_Context.<a class="code" href="structtimer__context__s.html#ae62febdb134bc78223e5d26dd7f837e3">period_slow</a> = 488;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  }</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  TIMER_Context.<a class="code" href="structtimer__context__s.html#a8b516120d60b773df78df4863e34dbd7">periodic_calibration</a> = TIMER_InitStruct-&gt;<a class="code" href="struct_t_i_m_e_r___init_type.html#a89e12963b5c4c6d48b439bce9ce96700">TIMER_PeriodicCalibration</a>;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  _update_xtal_startup_time(TIMER_Context.<a class="code" href="structtimer__context__s.html#a5d3123428eced128897fe6ac6688373e">hs_startup_time</a>, TIMER_Context.<a class="code" href="structtimer__context__s.html#ae8215266d87490b0da83be2091441a32">freq1</a>);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  update_interpolator(TIMER_Context.<a class="code" href="structtimer__context__s.html#ae62febdb134bc78223e5d26dd7f837e3">period_slow</a>);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  TIMER_Context.<a class="code" href="structtimer__context__s.html#a46972ef9e28fdd4b4d295deda5495aac">last_period_slow</a> = TIMER_Context.<a class="code" href="structtimer__context__s.html#ae62febdb134bc78223e5d26dd7f837e3">period_slow</a>;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  TIMER_Context.<a class="code" href="structtimer__context__s.html#ab66f7aedfedc98a2ac86d44ff7611de7">cumulative_time</a> = 0;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  TIMER_Context.<a class="code" href="structtimer__context__s.html#afc90bdf2ec7abe1ea8569ea6375c282f">last_machine_time</a> = BLUE_CTRL-&gt;CURRENT_TIME;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  TIMER_Context.<a class="code" href="structtimer__context__s.html#aab6c9f44474c2efae3fa6178d7549dc2">last_calibration_machine_time</a> = TIMER_Context.<a class="code" href="structtimer__context__s.html#afc90bdf2ec7abe1ea8569ea6375c282f">last_machine_time</a>;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  TIMER_Context.<a class="code" href="structtimer__context__s.html#aa07e91b072d117eb3678dea01b29c199">last_calibration_time</a> = 0;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  TIMER_Context.<a class="code" href="structtimer__context__s.html#a13a03153d810d652c5992139312808d1">tx_cal_delay_st</a> = <a class="code" href="group___device___system___delays.html#gae555a64363f3c5d4ebd1a9675271dfea">DELAY_TX</a> + us_to_systime((__blue_RAM.BlueGlobVar.TxDelay1) &amp; 0x7F);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  TIMER_Context.<a class="code" href="structtimer__context__s.html#a440f5a272d99f879ec97794b1f715769">tx_no_cal_delay_st</a> = <a class="code" href="group___device___system___delays.html#ga503b879507c351e999c5f3e1d98fbd4a">DELAY_TX_NO_CAL</a> + us_to_systime((__blue_RAM.BlueGlobVar.TxDelay) &amp; 0x7F);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  TIMER_Context.<a class="code" href="structtimer__context__s.html#a3e616599a2563904bd385a15f60b6c73">rx_cal_delay_st</a> = <a class="code" href="group___device___system___delays.html#gae99675ef5e8a1d6fcf9c476ebcdfa83f">DELAY_RX</a> + us_to_systime((__blue_RAM.BlueGlobVar.RcvDelay1) &amp; 0x7F);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  TIMER_Context.<a class="code" href="structtimer__context__s.html#aa3260b2f7c390bff2172d290083a9731">rx_no_cal_delay_st</a> = <a class="code" href="group___device___system___delays.html#gadd2eb21e18b285bcaa9a9e7032c463fe">DELAY_RX_NO_CAL</a> + us_to_systime((__blue_RAM.BlueGlobVar.RcvDelay1) &amp; 0x7F); </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;}</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div>
<div class="line"><a name="l00382"></a><span class="lineno"><a class="line" href="group___t_i_m_e_r___public___functions.html#ga0eeba98c495209667ba227aac604702a">  382</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="group___t_i_m_e_r___public___functions.html#ga0eeba98c495209667ba227aac604702a">TIMER_Calibrate</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;{</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <span class="keywordflow">if</span> (TIMER_Context.<a class="code" href="structtimer__context__s.html#a8b516120d60b773df78df4863e34dbd7">periodic_calibration</a>) {</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <a class="code" href="structtimer__context__s.html">TIMER_ContextType</a> ContextToUpdate = <a class="code" href="group___t_i_m_e_r___private___variables.html#gaf454441a6ed3ab9274cd6fa0a67c5041">TIMER_Context</a>;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    _timer_calibrate(&amp;ContextToUpdate);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    _update_xtal_startup_time(ContextToUpdate.<a class="code" href="structtimer__context__s.html#a5d3123428eced128897fe6ac6688373e">hs_startup_time</a>, ContextToUpdate.<a class="code" href="structtimer__context__s.html#ae8215266d87490b0da83be2091441a32">freq1</a>);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">if</span> (ContextToUpdate.<a class="code" href="structtimer__context__s.html#a46972ef9e28fdd4b4d295deda5495aac">last_period_slow</a> != ContextToUpdate.<a class="code" href="structtimer__context__s.html#ae62febdb134bc78223e5d26dd7f837e3">period_slow</a>) {</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      update_interpolator(ContextToUpdate.<a class="code" href="structtimer__context__s.html#ae62febdb134bc78223e5d26dd7f837e3">period_slow</a>);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      ContextToUpdate.<a class="code" href="structtimer__context__s.html#a46972ef9e28fdd4b4d295deda5495aac">last_period_slow</a> = ContextToUpdate.<a class="code" href="structtimer__context__s.html#ae62febdb134bc78223e5d26dd7f837e3">period_slow</a>;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    }</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <a class="code" href="group___t_i_m_e_r___private___macros.html#ga125af6df2956a88705c7efdba86cabe5">ATOMIC_SECTION_BEGIN</a>();</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="comment">/* Copying only the updated fields.</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">    Faster than memcpy: TIMER_Context = ContextToUpdate;*/</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    TIMER_Context.<a class="code" href="structtimer__context__s.html#adb892e5afb9966143fe8af5268b65ccf">wakeup_time_offset</a> = ContextToUpdate.<a class="code" href="structtimer__context__s.html#adb892e5afb9966143fe8af5268b65ccf">wakeup_time_offset</a>;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    TIMER_Context.<a class="code" href="structtimer__context__s.html#ae62febdb134bc78223e5d26dd7f837e3">period_slow</a> = ContextToUpdate.<a class="code" href="structtimer__context__s.html#ae62febdb134bc78223e5d26dd7f837e3">period_slow</a>;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    TIMER_Context.<a class="code" href="structtimer__context__s.html#a46972ef9e28fdd4b4d295deda5495aac">last_period_slow</a> = ContextToUpdate.<a class="code" href="structtimer__context__s.html#a46972ef9e28fdd4b4d295deda5495aac">last_period_slow</a>;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    TIMER_Context.<a class="code" href="structtimer__context__s.html#ae4709c8010902304bbd1ebd776d9fa60">period</a> = ContextToUpdate.<a class="code" href="structtimer__context__s.html#ae4709c8010902304bbd1ebd776d9fa60">period</a>;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    TIMER_Context.<a class="code" href="structtimer__context__s.html#ad200cbb24ee96f76c974e6ae24daf98c">freq</a> = ContextToUpdate.<a class="code" href="structtimer__context__s.html#ad200cbb24ee96f76c974e6ae24daf98c">freq</a>;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    TIMER_Context.<a class="code" href="structtimer__context__s.html#ae8215266d87490b0da83be2091441a32">freq1</a> = ContextToUpdate.<a class="code" href="structtimer__context__s.html#ae8215266d87490b0da83be2091441a32">freq1</a>;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    TIMER_Context.<a class="code" href="structtimer__context__s.html#ab0ff3bc7654bccb35da0840fd0b3ad09">period1</a> = ContextToUpdate.<a class="code" href="structtimer__context__s.html#ab0ff3bc7654bccb35da0840fd0b3ad09">period1</a>;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    TIMER_Context.<a class="code" href="structtimer__context__s.html#abc42dc0fc7154486ef336dc662470c37">last_period1</a> = ContextToUpdate.<a class="code" href="structtimer__context__s.html#abc42dc0fc7154486ef336dc662470c37">last_period1</a>;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    TIMER_Context.<a class="code" href="structtimer__context__s.html#a293e51cc013dea852f36048e670dc131">host_time</a> = ContextToUpdate.<a class="code" href="structtimer__context__s.html#a293e51cc013dea852f36048e670dc131">host_time</a>;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    TIMER_Context.<a class="code" href="structtimer__context__s.html#a5c0f8f2501a73bd5ea7882c42b035d4d">wakeup_time</a> = ContextToUpdate.<a class="code" href="structtimer__context__s.html#a5c0f8f2501a73bd5ea7882c42b035d4d">wakeup_time</a>;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    TIMER_Context.<a class="code" href="structtimer__context__s.html#a9b523390624020567145ec3b0a35a700">roundingError</a> = ContextToUpdate.<a class="code" href="structtimer__context__s.html#a9b523390624020567145ec3b0a35a700">roundingError</a>;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    update_system_time(&amp;TIMER_Context);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <a class="code" href="group___t_i_m_e_r___private___macros.html#gacfff8120ca5315b54cc5ff907c83902d">ATOMIC_SECTION_END</a>();</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  }</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  {</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <a class="code" href="group___t_i_m_e_r___private___macros.html#ga125af6df2956a88705c7efdba86cabe5">ATOMIC_SECTION_BEGIN</a>();</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    update_system_time(&amp;TIMER_Context);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <a class="code" href="group___t_i_m_e_r___private___macros.html#gacfff8120ca5315b54cc5ff907c83902d">ATOMIC_SECTION_END</a>();</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  }</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;}</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div>
<div class="line"><a name="l00422"></a><span class="lineno"><a class="line" href="group___t_i_m_e_r___public___functions.html#ga25b629dcf17ba3268f9241e852464af2">  422</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="group___t_i_m_e_r___public___functions.html#ga25b629dcf17ba3268f9241e852464af2">TIMER_StartCalibration</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;{</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <span class="keywordflow">if</span> (TIMER_Context.<a class="code" href="structtimer__context__s.html#a8b516120d60b773df78df4863e34dbd7">periodic_calibration</a>) {</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    _timer_start_calibration();</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  }</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;}</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;</div>
<div class="line"><a name="l00434"></a><span class="lineno"><a class="line" href="group___t_i_m_e_r___public___functions.html#ga4a4c60a6b58d5991769bf761f08d8921">  434</a></span>&#160;BOOL <a class="code" href="group___t_i_m_e_r___public___functions.html#ga4a4c60a6b58d5991769bf761f08d8921">TIMER_IsCalibrationRunning</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;{</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        <span class="comment">/* Normally the calibration is triggered automatically by hardware only at power up (or hardware reset),</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">           all other calibrations are started by software */</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  <span class="keywordflow">return</span> (CKGEN_BLE-&gt;CLK32K_IT == 0);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;}</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div>
<div class="line"><a name="l00450"></a><span class="lineno"><a class="line" href="group___t_i_m_e_r___public___functions.html#ga526ecb65c6e3da467c9e2b75b3aa2be0">  450</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="group___t_i_m_e_r___public___functions.html#ga526ecb65c6e3da467c9e2b75b3aa2be0">TIMER_UpdateCalibrationData</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;{</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  <span class="keywordflow">if</span> (TIMER_Context.<a class="code" href="structtimer__context__s.html#a8b516120d60b773df78df4863e34dbd7">periodic_calibration</a>) {</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <a class="code" href="structtimer__context__s.html">TIMER_ContextType</a> ContextToUpdate = <a class="code" href="group___t_i_m_e_r___private___variables.html#gaf454441a6ed3ab9274cd6fa0a67c5041">TIMER_Context</a>;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    _get_calibration_data(&amp;ContextToUpdate);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    _update_xtal_startup_time(ContextToUpdate.<a class="code" href="structtimer__context__s.html#a5d3123428eced128897fe6ac6688373e">hs_startup_time</a>, ContextToUpdate.<a class="code" href="structtimer__context__s.html#ae8215266d87490b0da83be2091441a32">freq1</a>);</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="keywordflow">if</span> (ContextToUpdate.<a class="code" href="structtimer__context__s.html#a46972ef9e28fdd4b4d295deda5495aac">last_period_slow</a> != ContextToUpdate.<a class="code" href="structtimer__context__s.html#ae62febdb134bc78223e5d26dd7f837e3">period_slow</a>) {</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;      update_interpolator(ContextToUpdate.<a class="code" href="structtimer__context__s.html#ae62febdb134bc78223e5d26dd7f837e3">period_slow</a>);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;      ContextToUpdate.<a class="code" href="structtimer__context__s.html#a46972ef9e28fdd4b4d295deda5495aac">last_period_slow</a> = ContextToUpdate.<a class="code" href="structtimer__context__s.html#ae62febdb134bc78223e5d26dd7f837e3">period_slow</a>;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    }</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <a class="code" href="group___t_i_m_e_r___private___macros.html#ga125af6df2956a88705c7efdba86cabe5">ATOMIC_SECTION_BEGIN</a>();</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="comment">/* Copying only the updated fields.</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment">    Faster than memcpy: TIMER_Context = ContextToUpdate;*/</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    TIMER_Context.<a class="code" href="structtimer__context__s.html#adb892e5afb9966143fe8af5268b65ccf">wakeup_time_offset</a> = ContextToUpdate.<a class="code" href="structtimer__context__s.html#adb892e5afb9966143fe8af5268b65ccf">wakeup_time_offset</a>;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    TIMER_Context.<a class="code" href="structtimer__context__s.html#ae62febdb134bc78223e5d26dd7f837e3">period_slow</a> = ContextToUpdate.<a class="code" href="structtimer__context__s.html#ae62febdb134bc78223e5d26dd7f837e3">period_slow</a>;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    TIMER_Context.<a class="code" href="structtimer__context__s.html#a46972ef9e28fdd4b4d295deda5495aac">last_period_slow</a> = ContextToUpdate.<a class="code" href="structtimer__context__s.html#a46972ef9e28fdd4b4d295deda5495aac">last_period_slow</a>;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    TIMER_Context.<a class="code" href="structtimer__context__s.html#ae4709c8010902304bbd1ebd776d9fa60">period</a> = ContextToUpdate.<a class="code" href="structtimer__context__s.html#ae4709c8010902304bbd1ebd776d9fa60">period</a>;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    TIMER_Context.<a class="code" href="structtimer__context__s.html#ad200cbb24ee96f76c974e6ae24daf98c">freq</a> = ContextToUpdate.<a class="code" href="structtimer__context__s.html#ad200cbb24ee96f76c974e6ae24daf98c">freq</a>;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    TIMER_Context.<a class="code" href="structtimer__context__s.html#ae8215266d87490b0da83be2091441a32">freq1</a> = ContextToUpdate.<a class="code" href="structtimer__context__s.html#ae8215266d87490b0da83be2091441a32">freq1</a>;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    TIMER_Context.<a class="code" href="structtimer__context__s.html#ab0ff3bc7654bccb35da0840fd0b3ad09">period1</a> = ContextToUpdate.<a class="code" href="structtimer__context__s.html#ab0ff3bc7654bccb35da0840fd0b3ad09">period1</a>;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    TIMER_Context.<a class="code" href="structtimer__context__s.html#abc42dc0fc7154486ef336dc662470c37">last_period1</a> = ContextToUpdate.<a class="code" href="structtimer__context__s.html#abc42dc0fc7154486ef336dc662470c37">last_period1</a>;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    TIMER_Context.<a class="code" href="structtimer__context__s.html#a293e51cc013dea852f36048e670dc131">host_time</a> = ContextToUpdate.<a class="code" href="structtimer__context__s.html#a293e51cc013dea852f36048e670dc131">host_time</a>;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    TIMER_Context.<a class="code" href="structtimer__context__s.html#a5c0f8f2501a73bd5ea7882c42b035d4d">wakeup_time</a> = ContextToUpdate.<a class="code" href="structtimer__context__s.html#a5c0f8f2501a73bd5ea7882c42b035d4d">wakeup_time</a>;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    TIMER_Context.<a class="code" href="structtimer__context__s.html#a9b523390624020567145ec3b0a35a700">roundingError</a> = ContextToUpdate.<a class="code" href="structtimer__context__s.html#a9b523390624020567145ec3b0a35a700">roundingError</a>;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    update_system_time(&amp;TIMER_Context);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <a class="code" href="group___t_i_m_e_r___private___macros.html#gacfff8120ca5315b54cc5ff907c83902d">ATOMIC_SECTION_END</a>();</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  }</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  {</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <a class="code" href="group___t_i_m_e_r___private___macros.html#ga125af6df2956a88705c7efdba86cabe5">ATOMIC_SECTION_BEGIN</a>();</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    update_system_time(&amp;TIMER_Context);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <a class="code" href="group___t_i_m_e_r___private___macros.html#gacfff8120ca5315b54cc5ff907c83902d">ATOMIC_SECTION_END</a>();</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  }</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;}</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div>
<div class="line"><a name="l00490"></a><span class="lineno"><a class="line" href="group___t_i_m_e_r___public___functions.html#ga6d4903e54c5a624002bebb0936083bd5">  490</a></span>&#160;uint64_t <a class="code" href="group___t_i_m_e_r___public___functions.html#ga6d4903e54c5a624002bebb0936083bd5">TIMER_GetCurrentSysTime</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;{</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  <span class="keywordflow">return</span> get_system_time(&amp;TIMER_Context);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;}</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div>
<div class="line"><a name="l00499"></a><span class="lineno"><a class="line" href="group___t_i_m_e_r___public___functions.html#ga59559fc0d99df367a45a91adb9bbb8cd">  499</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="group___t_i_m_e_r___public___functions.html#ga59559fc0d99df367a45a91adb9bbb8cd">TIMER_ClearRadioTimerValue</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;{</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  BLUE_CTRL-&gt;TIMEOUT = 1&lt;&lt;28;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;}</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div>
<div class="line"><a name="l00510"></a><span class="lineno"><a class="line" href="group___t_i_m_e_r___public___functions.html#ga2a5d5795a186f997c752faa6e8b521c0">  510</a></span>&#160;uint64_t <a class="code" href="group___t_i_m_e_r___public___functions.html#ga2a5d5795a186f997c752faa6e8b521c0">TIMER_GetFutureSysTime</a>(uint32_t time)</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;{</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  uint32_t delta_systime = machinetime_to_systime(<a class="code" href="group___t_i_m_e_r___private___macros.html#gae1010f6bb6df72adfefbcf4290eb9694">TIME_DIFF</a>(time, TIMER_Context.<a class="code" href="structtimer__context__s.html#afc90bdf2ec7abe1ea8569ea6375c282f">last_machine_time</a>),</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                                                  TIMER_Context.<a class="code" href="structtimer__context__s.html#ab0ff3bc7654bccb35da0840fd0b3ad09">period1</a>,</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                                                  &amp;TIMER_Context.<a class="code" href="structtimer__context__s.html#a9b523390624020567145ec3b0a35a700">roundingError</a>);</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  <span class="keywordflow">return</span> TIMER_Context.<a class="code" href="structtimer__context__s.html#ab66f7aedfedc98a2ac86d44ff7611de7">cumulative_time</a>+delta_systime;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;}</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div>
<div class="line"><a name="l00524"></a><span class="lineno"><a class="line" href="group___t_i_m_e_r___public___functions.html#ga9605ce8f587241f028de3a4aa8a11a1c">  524</a></span>&#160;uint64_t <a class="code" href="group___t_i_m_e_r___public___functions.html#ga9605ce8f587241f028de3a4aa8a11a1c">TIMER_GetPastSysTime</a>(uint32_t time)</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;{</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  uint32_t delta_systime, current_machine_time;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  uint64_t current_system_time = get_system_time_and_machine(&amp;TIMER_Context, &amp;current_machine_time);</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  delta_systime = machinetime_to_systime(<a class="code" href="group___t_i_m_e_r___private___macros.html#gae1010f6bb6df72adfefbcf4290eb9694">TIME_DIFF</a>(current_machine_time, time),</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                                         TIMER_Context.<a class="code" href="structtimer__context__s.html#ab0ff3bc7654bccb35da0840fd0b3ad09">period1</a>,</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                                         &amp;TIMER_Context.<a class="code" href="structtimer__context__s.html#a9b523390624020567145ec3b0a35a700">roundingError</a>);</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  <span class="keywordflow">return</span> current_system_time-delta_systime;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;}</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;</div>
<div class="line"><a name="l00538"></a><span class="lineno"><a class="line" href="group___t_i_m_e_r___public___functions.html#ga1c67015d28baecc93e56488116eb91ce">  538</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="group___t_i_m_e_r___public___functions.html#ga1c67015d28baecc93e56488116eb91ce">TIMER_GetCurrentCalibrationData</a>(<a class="code" href="structtimer__calibration__s.html">TIMER_CalibrationType</a> *data)</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;{</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  data-&gt;<a class="code" href="structtimer__calibration__s.html#a5998bae48d1086682e9823241f998729">periodic_calibration</a> = TIMER_Context.<a class="code" href="structtimer__context__s.html#a8b516120d60b773df78df4863e34dbd7">periodic_calibration</a>;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  data-&gt;<a class="code" href="structtimer__calibration__s.html#a6deb6e58564d958d1446078e28bf656f">freq</a> = TIMER_Context.<a class="code" href="structtimer__context__s.html#ad200cbb24ee96f76c974e6ae24daf98c">freq</a>;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  data-&gt;<a class="code" href="structtimer__calibration__s.html#ab7527446f3266a6c39d36145786a2d58">last_calibration_time</a> = TIMER_Context.<a class="code" href="structtimer__context__s.html#aa07e91b072d117eb3678dea01b29c199">last_calibration_time</a>;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  data-&gt;<a class="code" href="structtimer__calibration__s.html#a67abf1b675e7f4ffdfcd38d9927ae2a6">period</a> = TIMER_Context.<a class="code" href="structtimer__context__s.html#ae4709c8010902304bbd1ebd776d9fa60">period</a>;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  data-&gt;<a class="code" href="structtimer__calibration__s.html#a64668c5c67f2dec173979badd68f38cb">last_calibration_machine_time</a> = TIMER_Context.<a class="code" href="structtimer__context__s.html#aab6c9f44474c2efae3fa6178d7549dc2">last_calibration_machine_time</a>; </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;}</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div>
<div class="line"><a name="l00560"></a><span class="lineno"><a class="line" href="group___t_i_m_e_r___public___functions.html#ga98d9ad2d334495f69f3c9920dd9576c5">  560</a></span>&#160;uint32_t <a class="code" href="group___t_i_m_e_r___public___functions.html#ga98d9ad2d334495f69f3c9920dd9576c5">TIMER_SetWakeupTime</a>(uint32_t delay, BOOL allow_sleep)</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;{</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  uint32_t current_time;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  delay = systime_to_machinetime(delay, TIMER_Context.<a class="code" href="structtimer__context__s.html#ae8215266d87490b0da83be2091441a32">freq1</a>) ;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  <span class="comment">/* If the delay is too small (less than 1 tick) round to minimum 1 tick */</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  delay = <a class="code" href="group___t_i_m_e_r___private___macros.html#gafa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(16,delay); </div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  current_time = BLUE_CTRL-&gt;CURRENT_TIME;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  <span class="comment">/* 4 least significant bits are not taken into account. Let&#39;s round the value summing 8 */</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  BLUE_CTRL-&gt;HOST_WKUP_TIMER = ((current_time + (delay + 8)) &amp; <a class="code" href="group___t_i_m_e_r___exported___constants.html#ga00ba68f62b52b73c91ed948087a5f3df">TIMER_MAX_VALUE</a>) | (1 &lt;&lt; 24) | (allow_sleep ? (1 &lt;&lt; 28): 0);</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  <span class="comment">/*Warning: SLEEP_EN bit is not readable*/</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  TIMER_Context.<a class="code" href="structtimer__context__s.html#a293e51cc013dea852f36048e670dc131">host_time</a> = BLUE_CTRL-&gt;HOST_WKUP_TIMER;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  <span class="keywordflow">return</span> current_time;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;}</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;</div>
<div class="line"><a name="l00594"></a><span class="lineno"><a class="line" href="group___t_i_m_e_r___public___functions.html#gade1675fc9629b47a676fea2fccd6680e">  594</a></span>&#160;uint8_t <a class="code" href="group___t_i_m_e_r___public___functions.html#gade1675fc9629b47a676fea2fccd6680e">TIMER_SetRadioTimerValue</a>(uint32_t timeout, BOOL event_type, BOOL cal_req)</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;{</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  uint32_t current_time,</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;           relTimeout,</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;           delay,</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;           destination,</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;           device_delay_st;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;             </div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  uint8_t enable_sleep;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  </div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  <span class="keywordflow">if</span>(event_type == <a class="code" href="group___t_i_m_e_r___private___macros.html#ga634253e2e42ed873f90fecbe06a2a229">TIMER_TX_EVENT</a>)</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  {</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <span class="keywordflow">if</span>(cal_req)</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    {</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;      device_delay_st = TIMER_Context.<a class="code" href="structtimer__context__s.html#a13a03153d810d652c5992139312808d1">tx_cal_delay_st</a>;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    }</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    {</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;      device_delay_st = TIMER_Context.<a class="code" href="structtimer__context__s.html#a440f5a272d99f879ec97794b1f715769">tx_no_cal_delay_st</a>; </div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    }</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  }</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  {</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <span class="keywordflow">if</span>(cal_req)</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    {</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;      device_delay_st = TIMER_Context.<a class="code" href="structtimer__context__s.html#a3e616599a2563904bd385a15f60b6c73">rx_cal_delay_st</a>;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    }</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    {</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;      device_delay_st = TIMER_Context.<a class="code" href="structtimer__context__s.html#aa3260b2f7c390bff2172d290083a9731">rx_no_cal_delay_st</a>;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    }</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  }</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  </div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  <span class="comment">/* At this point, it is care of the upper layers to guarantee that the timeout represents an absolute time in the future */</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  relTimeout = timeout - (uint32_t)get_system_time_and_machine(&amp;TIMER_Context,&amp;current_time) - device_delay_st;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  <span class="comment">/* check if the relative timeout is bigger than wakeup time offset */</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  <span class="keywordflow">if</span> (relTimeout &gt; (<a class="code" href="group___t_i_m_e_r___private___macros.html#gaf7a3333fbe5be3a1d099d7e6b7c81efa">TIMER_SEL_THR</a> + TIMER_Context.<a class="code" href="structtimer__context__s.html#a5d3123428eced128897fe6ac6688373e">hs_startup_time</a>)){</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <span class="comment">/*time is not in the past. Program the wakeup_timer*/</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    destination =  <a class="code" href="group___t_i_m_e_r___private___macros.html#ga85a9917ff14fede3258d8e7b866e16c9">WAKEUP_TIMER_EN</a>; </div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    enable_sleep = TRUE;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    __blue_RAM.BlueGlobVar.wakeup_time_offset = TIMER_Context.<a class="code" href="structtimer__context__s.html#adb892e5afb9966143fe8af5268b65ccf">wakeup_time_offset</a>;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <span class="comment">/*This means that wakeup_timer will be programmed with a time in the past and it is not possible to program it.</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="comment">    Therefore Timer1 is selected and no sleep is requested */</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    destination =  <a class="code" href="group___t_i_m_e_r___private___macros.html#ga8964acb693ef3063dc7aac5b37a606cb">TIMER1_EN</a>;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    enable_sleep = FALSE;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  }</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  delay = systime_to_machinetime(relTimeout, TIMER_Context.<a class="code" href="structtimer__context__s.html#ae8215266d87490b0da83be2091441a32">freq1</a>) - \</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;          (__blue_RAM.BlueGlobVar.wakeup_time_offset &lt;&lt; 3);</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  </div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  BLUE_CTRL-&gt;TIMEOUT = ((current_time + delay) &amp; <a class="code" href="group___t_i_m_e_r___exported___constants.html#ga00ba68f62b52b73c91ed948087a5f3df">TIMER_MAX_VALUE</a>) | destination | (enable_sleep ? (1 &lt;&lt; 28): 0);</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  <span class="comment">/*Check if delay for the wakeup timer is in the past*/</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  <span class="keywordflow">if</span> ((int32_t)delay &lt; 0 &amp;&amp; (destination == <a class="code" href="group___t_i_m_e_r___private___macros.html#ga85a9917ff14fede3258d8e7b866e16c9">WAKEUP_TIMER_EN</a>)){</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    BLUE_CTRL-&gt;TIMEOUT = 0;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  }</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  TIMER_Context.<a class="code" href="structtimer__context__s.html#a5c0f8f2501a73bd5ea7882c42b035d4d">wakeup_time</a> = BLUE_CTRL-&gt;TIMEOUT;</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;}</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;</div>
<div class="line"><a name="l00665"></a><span class="lineno"><a class="line" href="group___t_i_m_e_r___public___functions.html#gafb93a6fc923bc6f2194494e1a679f452">  665</a></span>&#160;uint8_t <a class="code" href="group___t_i_m_e_r___public___functions.html#gafb93a6fc923bc6f2194494e1a679f452">TIMER_GetRadioTimerValue</a>(uint32_t* time)</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;{</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  uint8_t retValue = 0;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  uint32_t timeOut = BLUE_CTRL-&gt;TIMEOUT;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  *time = timeOut;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  timeOut = (timeOut &gt;&gt; 24) &amp; 0x07;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  <span class="keywordflow">if</span>(timeOut == <a class="code" href="group___t_i_m_e_r___exported___constants.html#ga82e5a62a8aeae504b21d5534bb2a3449">TIMER2_TIMER_MASK</a>)</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;  {</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    retValue =  <a class="code" href="group___t_i_m_e_r___exported___constants.html#ga0084af799735418c94bf0a3973e4801a">TIMER2_BUSY</a>;</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  }</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(timeOut == <a class="code" href="group___t_i_m_e_r___exported___constants.html#ga0e1b36244cb660ca92614cdaf3bc13e9">TIMER1_TIMER_MASK</a>)</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  {</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    retValue =  <a class="code" href="group___t_i_m_e_r___exported___constants.html#ga423ef88144bdcab97d1f32b9c1c6aae8">TIMER1_BUSY</a>;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  }</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(timeOut == <a class="code" href="group___t_i_m_e_r___exported___constants.html#ga6afabd078b4ecd4738e88ac2e03eb5b5">WAKEUP_TIMER_MASK</a>)</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  {</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    retValue =  <a class="code" href="group___t_i_m_e_r___exported___constants.html#ga8e388d33c9392840923347cf20c018a7">WAKEUP_TIMER_BUSY</a>;</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  }</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  <span class="keywordflow">return</span> retValue;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;}</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;</div>
<div class="line"><a name="l00690"></a><span class="lineno"><a class="line" href="group___t_i_m_e_r___public___functions.html#ga33749f6656c75367e241c38cfc5dd334">  690</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="group___t_i_m_e_r___public___functions.html#ga33749f6656c75367e241c38cfc5dd334">TIMER_updatePeriodSlow</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;{</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  __blue_RAM.BlueGlobVar.period_slow = TIMER_Context.<a class="code" href="structtimer__context__s.html#ae62febdb134bc78223e5d26dd7f837e3">period_slow</a>;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;}</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;</div>
<div class="line"><a name="l00699"></a><span class="lineno"><a class="line" href="group___t_i_m_e_r___public___functions.html#ga33c90a5678f3e64cfd3ceed18b8ba82c">  699</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="group___t_i_m_e_r___public___functions.html#ga33c90a5678f3e64cfd3ceed18b8ba82c">TIMER_updateWkupTimeOffset</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;{</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  __blue_RAM.BlueGlobVar.wakeup_time_offset = TIMER_Context.<a class="code" href="structtimer__context__s.html#adb892e5afb9966143fe8af5268b65ccf">wakeup_time_offset</a>;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;}</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;</div>
<div class="line"><a name="l00710"></a><span class="lineno"><a class="line" href="group___t_i_m_e_r___public___functions.html#gafbaf884cab51892b78823e47e7b36096">  710</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="group___t_i_m_e_r___public___functions.html#gafbaf884cab51892b78823e47e7b36096">TIMER_GetNextTimerActivity</a>(uint32_t* nextRadioActivity, uint32_t* nextHostActivity)</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;{</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;  *nextRadioActivity = TIMER_Context.<a class="code" href="structtimer__context__s.html#a5c0f8f2501a73bd5ea7882c42b035d4d">wakeup_time</a>;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;  *nextHostActivity = TIMER_Context.<a class="code" href="structtimer__context__s.html#a293e51cc013dea852f36048e670dc131">host_time</a>;</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;}</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;</div>
<div class="line"><a name="l00723"></a><span class="lineno"><a class="line" href="group___t_i_m_e_r___public___functions.html#gade83e9fda38c4b08b74af157c7834651">  723</a></span>&#160;uint32_t <a class="code" href="group___t_i_m_e_r___public___functions.html#gade83e9fda38c4b08b74af157c7834651">TIMER_SysTimeToMachineTime</a>(uint32_t time)</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;{</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  <span class="keywordflow">return</span> systime_to_machinetime(time, TIMER_Context.<a class="code" href="structtimer__context__s.html#ae8215266d87490b0da83be2091441a32">freq1</a>);</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;}</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;</div>
<div class="line"><a name="l00735"></a><span class="lineno"><a class="line" href="group___t_i_m_e_r___public___functions.html#ga624dafba8076c3ceb2800303e75bf9c2">  735</a></span>&#160;uint32_t <a class="code" href="group___t_i_m_e_r___public___functions.html#ga624dafba8076c3ceb2800303e75bf9c2">TIMER_MachineTimeToSysTime</a>(uint32_t time)</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;{</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  <span class="keywordflow">return</span> machinetime_to_systime(time, TIMER_Context.<a class="code" href="structtimer__context__s.html#ab0ff3bc7654bccb35da0840fd0b3ad09">period1</a>, &amp;TIMER_Context.<a class="code" href="structtimer__context__s.html#a9b523390624020567145ec3b0a35a700">roundingError</a>);</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;}</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;</div>
<div class="line"><a name="l00745"></a><span class="lineno"><a class="line" href="group___t_i_m_e_r___public___functions.html#ga1e2721cdb6797865137926b3d518d60b">  745</a></span>&#160;uint32_t <a class="code" href="group___t_i_m_e_r___public___functions.html#ga1e2721cdb6797865137926b3d518d60b">TIMER_UsToSystime</a>(uint32_t time)</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;{</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;  <span class="keywordflow">return</span> us_to_systime(time);</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;}</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;</div>
<div class="line"><a name="l00755"></a><span class="lineno"><a class="line" href="group___t_i_m_e_r___public___functions.html#ga1606d739c79f37bab156a7dda5e27f69">  755</a></span>&#160;uint32_t <a class="code" href="group___t_i_m_e_r___public___functions.html#ga1606d739c79f37bab156a7dda5e27f69">TIMER_UsToMachinetime</a>(uint32_t time)</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;{</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  <span class="keywordflow">return</span> us_to_machinetime(time);</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;}</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;</div>
<div class="line"><a name="l00764"></a><span class="lineno"><a class="line" href="group___t_i_m_e_r___public___functions.html#ga93c87f2f82ef629a0b3665248b7505e3">  764</a></span>&#160;uint64_t <a class="code" href="group___t_i_m_e_r___public___functions.html#ga93c87f2f82ef629a0b3665248b7505e3">TIMER_GetAnchorPoint</a>(<span class="keywordtype">void</span>){</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group___t_i_m_e_r___public___functions.html#ga9605ce8f587241f028de3a4aa8a11a1c">TIMER_GetPastSysTime</a>(BLUE_CTRL-&gt;TIMER_CAPTURE);</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;}</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;</div>
<div class="line"><a name="l00772"></a><span class="lineno"><a class="line" href="group___t_i_m_e_r___public___functions.html#ga88243574d09e3b9d759930296f08d14c">  772</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="group___t_i_m_e_r___public___functions.html#ga88243574d09e3b9d759930296f08d14c">TIMER_SetRadioCloseTimeout</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;{</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  <a class="code" href="group___t_i_m_e_r___private___macros.html#ga125af6df2956a88705c7efdba86cabe5">ATOMIC_SECTION_BEGIN</a>();</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;  uint32_t current_time = BLUE_CTRL-&gt;CURRENT_TIME;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;  uint32_t delay = 3 - (__blue_RAM.BlueGlobVar.wakeup_time_offset &lt;&lt; 3);</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;  BLUE_CTRL-&gt;TIMEOUT = ((current_time + delay ) &amp; <a class="code" href="group___t_i_m_e_r___exported___constants.html#ga00ba68f62b52b73c91ed948087a5f3df">TIMER_MAX_VALUE</a>) | <a class="code" href="group___t_i_m_e_r___private___macros.html#ga8964acb693ef3063dc7aac5b37a606cb">TIMER1_EN</a>;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  <a class="code" href="group___t_i_m_e_r___private___macros.html#gacfff8120ca5315b54cc5ff907c83902d">ATOMIC_SECTION_END</a>();</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;}</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;</div>
<div class="line"><a name="l00787"></a><span class="lineno"><a class="line" href="group___t_i_m_e_r___public___functions.html#ga12f8c3a86856743e738ddd2a363c1255">  787</a></span>&#160;uint8_t <a class="code" href="group___t_i_m_e_r___public___functions.html#ga12f8c3a86856743e738ddd2a363c1255">TIMER_GetActivitySysDelay</a>(uint8_t event_type, uint8_t cal_req)</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;{</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;  <span class="keywordflow">if</span>(event_type == <a class="code" href="group___t_i_m_e_r___private___macros.html#ga634253e2e42ed873f90fecbe06a2a229">TIMER_TX_EVENT</a>)</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;  {</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <span class="keywordflow">if</span>(cal_req)</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    {</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;      <span class="keywordflow">return</span> TIMER_Context.<a class="code" href="structtimer__context__s.html#a13a03153d810d652c5992139312808d1">tx_cal_delay_st</a>;</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    }</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    {</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;      <span class="keywordflow">return</span> TIMER_Context.<a class="code" href="structtimer__context__s.html#a440f5a272d99f879ec97794b1f715769">tx_no_cal_delay_st</a>; </div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    }</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  }</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;  {</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <span class="keywordflow">if</span>(cal_req)</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    {</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;      <span class="keywordflow">return</span> TIMER_Context.<a class="code" href="structtimer__context__s.html#a3e616599a2563904bd385a15f60b6c73">rx_cal_delay_st</a>;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    }    </div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    {</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;      <span class="keywordflow">return</span> TIMER_Context.<a class="code" href="structtimer__context__s.html#a440f5a272d99f879ec97794b1f715769">tx_no_cal_delay_st</a>;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    }</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;  }</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;}</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="comment">/******************* (C) COPYRIGHT 2020 STMicroelectronics *****END OF FILE****/</span></div>
<div class="ttc" id="group___t_i_m_e_r___public___functions_html_ga1e2721cdb6797865137926b3d518d60b"><div class="ttname"><a href="group___t_i_m_e_r___public___functions.html#ga1e2721cdb6797865137926b3d518d60b">TIMER_UsToSystime</a></div><div class="ttdeci">uint32_t TIMER_UsToSystime(uint32_t time)</div><div class="ttdoc">Return the system time referred to the time in microseconds passed as parameter. </div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00745">BlueNRG1_timer.c:745</a></div></div>
<div class="ttc" id="group___t_i_m_e_r___private___macros_html_ga634253e2e42ed873f90fecbe06a2a229"><div class="ttname"><a href="group___t_i_m_e_r___private___macros.html#ga634253e2e42ed873f90fecbe06a2a229">TIMER_TX_EVENT</a></div><div class="ttdeci">#define TIMER_TX_EVENT</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00128">BlueNRG1_timer.c:128</a></div></div>
<div class="ttc" id="structtimer__context__s_html_afc90bdf2ec7abe1ea8569ea6375c282f"><div class="ttname"><a href="structtimer__context__s.html#afc90bdf2ec7abe1ea8569ea6375c282f">timer_context_s::last_machine_time</a></div><div class="ttdeci">uint32_t last_machine_time</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00084">BlueNRG1_timer.c:84</a></div></div>
<div class="ttc" id="structtimer__calibration__s_html_a64668c5c67f2dec173979badd68f38cb"><div class="ttname"><a href="structtimer__calibration__s.html#a64668c5c67f2dec173979badd68f38cb">timer_calibration_s::last_calibration_machine_time</a></div><div class="ttdeci">uint32_t last_calibration_machine_time</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8h_source.html#l00057">BlueNRG1_timer.h:57</a></div></div>
<div class="ttc" id="group___t_i_m_e_r___public___functions_html_ga526ecb65c6e3da467c9e2b75b3aa2be0"><div class="ttname"><a href="group___t_i_m_e_r___public___functions.html#ga526ecb65c6e3da467c9e2b75b3aa2be0">TIMER_UpdateCalibrationData</a></div><div class="ttdeci">void TIMER_UpdateCalibrationData(void)</div><div class="ttdoc">Records the result of the last calibration in the internal context. It updates the XTAL startup time ...</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00450">BlueNRG1_timer.c:450</a></div></div>
<div class="ttc" id="structtimer__context__s_html_adb892e5afb9966143fe8af5268b65ccf"><div class="ttname"><a href="structtimer__context__s.html#adb892e5afb9966143fe8af5268b65ccf">timer_context_s::wakeup_time_offset</a></div><div class="ttdeci">uint8_t wakeup_time_offset</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00076">BlueNRG1_timer.c:76</a></div></div>
<div class="ttc" id="group___t_i_m_e_r___public___functions_html_gafbaf884cab51892b78823e47e7b36096"><div class="ttname"><a href="group___t_i_m_e_r___public___functions.html#gafbaf884cab51892b78823e47e7b36096">TIMER_GetNextTimerActivity</a></div><div class="ttdeci">void TIMER_GetNextTimerActivity(uint32_t *nextRadioActivity, uint32_t *nextHostActivity)</div><div class="ttdoc">Returns the next activities scheduled by the Timer Module. </div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00710">BlueNRG1_timer.c:710</a></div></div>
<div class="ttc" id="structtimer__calibration__s_html_ab7527446f3266a6c39d36145786a2d58"><div class="ttname"><a href="structtimer__calibration__s.html#ab7527446f3266a6c39d36145786a2d58">timer_calibration_s::last_calibration_time</a></div><div class="ttdeci">uint64_t last_calibration_time</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8h_source.html#l00053">BlueNRG1_timer.h:53</a></div></div>
<div class="ttc" id="group___t_i_m_e_r___exported___constants_html_ga00ba68f62b52b73c91ed948087a5f3df"><div class="ttname"><a href="group___t_i_m_e_r___exported___constants.html#ga00ba68f62b52b73c91ed948087a5f3df">TIMER_MAX_VALUE</a></div><div class="ttdeci">#define TIMER_MAX_VALUE</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8h_source.html#l00077">BlueNRG1_timer.h:77</a></div></div>
<div class="ttc" id="structtimer__context__s_html_ab66f7aedfedc98a2ac86d44ff7611de7"><div class="ttname"><a href="structtimer__context__s.html#ab66f7aedfedc98a2ac86d44ff7611de7">timer_context_s::cumulative_time</a></div><div class="ttdeci">uint64_t cumulative_time</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00073">BlueNRG1_timer.c:73</a></div></div>
<div class="ttc" id="group___device___system___delays_html_gae99675ef5e8a1d6fcf9c476ebcdfa83f"><div class="ttname"><a href="group___device___system___delays.html#gae99675ef5e8a1d6fcf9c476ebcdfa83f">DELAY_RX</a></div><div class="ttdeci">#define DELAY_RX</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8h_source.html#l00089">BlueNRG1_timer.h:89</a></div></div>
<div class="ttc" id="group___t_i_m_e_r___private___macros_html_gaf7a3333fbe5be3a1d099d7e6b7c81efa"><div class="ttname"><a href="group___t_i_m_e_r___private___macros.html#gaf7a3333fbe5be3a1d099d7e6b7c81efa">TIMER_SEL_THR</a></div><div class="ttdeci">#define TIMER_SEL_THR</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00126">BlueNRG1_timer.c:126</a></div></div>
<div class="ttc" id="group___t_i_m_e_r___exported___constants_html_ga0e1b36244cb660ca92614cdaf3bc13e9"><div class="ttname"><a href="group___t_i_m_e_r___exported___constants.html#ga0e1b36244cb660ca92614cdaf3bc13e9">TIMER1_TIMER_MASK</a></div><div class="ttdeci">#define TIMER1_TIMER_MASK</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8h_source.html#l00101">BlueNRG1_timer.h:101</a></div></div>
<div class="ttc" id="structtimer__context__s_html_a5c0f8f2501a73bd5ea7882c42b035d4d"><div class="ttname"><a href="structtimer__context__s.html#a5c0f8f2501a73bd5ea7882c42b035d4d">timer_context_s::wakeup_time</a></div><div class="ttdeci">uint32_t wakeup_time</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00088">BlueNRG1_timer.c:88</a></div></div>
<div class="ttc" id="group___t_i_m_e_r___exported___constants_html_ga6afabd078b4ecd4738e88ac2e03eb5b5"><div class="ttname"><a href="group___t_i_m_e_r___exported___constants.html#ga6afabd078b4ecd4738e88ac2e03eb5b5">WAKEUP_TIMER_MASK</a></div><div class="ttdeci">#define WAKEUP_TIMER_MASK</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8h_source.html#l00100">BlueNRG1_timer.h:100</a></div></div>
<div class="ttc" id="group___t_i_m_e_r___public___functions_html_ga33749f6656c75367e241c38cfc5dd334"><div class="ttname"><a href="group___t_i_m_e_r___public___functions.html#ga33749f6656c75367e241c38cfc5dd334">TIMER_updatePeriodSlow</a></div><div class="ttdeci">void TIMER_updatePeriodSlow(void)</div><div class="ttdoc">Update the value of period slow variable in RAM. </div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00690">BlueNRG1_timer.c:690</a></div></div>
<div class="ttc" id="structtimer__context__s_html_ae62febdb134bc78223e5d26dd7f837e3"><div class="ttname"><a href="structtimer__context__s.html#ae62febdb134bc78223e5d26dd7f837e3">timer_context_s::period_slow</a></div><div class="ttdeci">uint16_t period_slow</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00077">BlueNRG1_timer.c:77</a></div></div>
<div class="ttc" id="group___t_i_m_e_r___public___functions_html_ga93c87f2f82ef629a0b3665248b7505e3"><div class="ttname"><a href="group___t_i_m_e_r___public___functions.html#ga93c87f2f82ef629a0b3665248b7505e3">TIMER_GetAnchorPoint</a></div><div class="ttdeci">uint64_t TIMER_GetAnchorPoint(void)</div><div class="ttdoc">Return timer capture register value in STU. </div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00764">BlueNRG1_timer.c:764</a></div></div>
<div class="ttc" id="structtimer__calibration__s_html_a5998bae48d1086682e9823241f998729"><div class="ttname"><a href="structtimer__calibration__s.html#a5998bae48d1086682e9823241f998729">timer_calibration_s::periodic_calibration</a></div><div class="ttdeci">uint8_t periodic_calibration</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8h_source.html#l00056">BlueNRG1_timer.h:56</a></div></div>
<div class="ttc" id="group___t_i_m_e_r___public___functions_html_ga9605ce8f587241f028de3a4aa8a11a1c"><div class="ttname"><a href="group___t_i_m_e_r___public___functions.html#ga9605ce8f587241f028de3a4aa8a11a1c">TIMER_GetPastSysTime</a></div><div class="ttdeci">uint64_t TIMER_GetPastSysTime(uint32_t time)</div><div class="ttdoc">Return the system time referred to the absolute machine time passed as parameter. ...</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00524">BlueNRG1_timer.c:524</a></div></div>
<div class="ttc" id="structtimer__context__s_html_a293e51cc013dea852f36048e670dc131"><div class="ttname"><a href="structtimer__context__s.html#a293e51cc013dea852f36048e670dc131">timer_context_s::host_time</a></div><div class="ttdeci">uint32_t host_time</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00087">BlueNRG1_timer.c:87</a></div></div>
<div class="ttc" id="group___t_i_m_e_r___public___functions_html_gafb93a6fc923bc6f2194494e1a679f452"><div class="ttname"><a href="group___t_i_m_e_r___public___functions.html#gafb93a6fc923bc6f2194494e1a679f452">TIMER_GetRadioTimerValue</a></div><div class="ttdeci">uint8_t TIMER_GetRadioTimerValue(uint32_t *time)</div><div class="ttdoc">Return the status of the Radio timers and the last value programmed in the register. </div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00665">BlueNRG1_timer.c:665</a></div></div>
<div class="ttc" id="structtimer__context__s_html_a3e616599a2563904bd385a15f60b6c73"><div class="ttname"><a href="structtimer__context__s.html#a3e616599a2563904bd385a15f60b6c73">timer_context_s::rx_cal_delay_st</a></div><div class="ttdeci">uint8_t rx_cal_delay_st</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00091">BlueNRG1_timer.c:91</a></div></div>
<div class="ttc" id="group___t_i_m_e_r___public___functions_html_ga6d4903e54c5a624002bebb0936083bd5"><div class="ttname"><a href="group___t_i_m_e_r___public___functions.html#ga6d4903e54c5a624002bebb0936083bd5">TIMER_GetCurrentSysTime</a></div><div class="ttdeci">uint64_t TIMER_GetCurrentSysTime(void)</div><div class="ttdoc">Return the current system time in system time unit (STU). This is a counter that grows since the powe...</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00490">BlueNRG1_timer.c:490</a></div></div>
<div class="ttc" id="group___t_i_m_e_r___private___macros_html_gacfff8120ca5315b54cc5ff907c83902d"><div class="ttname"><a href="group___t_i_m_e_r___private___macros.html#gacfff8120ca5315b54cc5ff907c83902d">ATOMIC_SECTION_END</a></div><div class="ttdeci">#define ATOMIC_SECTION_END()</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00124">BlueNRG1_timer.c:124</a></div></div>
<div class="ttc" id="group___t_i_m_e_r___exported___constants_html_ga8e388d33c9392840923347cf20c018a7"><div class="ttname"><a href="group___t_i_m_e_r___exported___constants.html#ga8e388d33c9392840923347cf20c018a7">WAKEUP_TIMER_BUSY</a></div><div class="ttdeci">#define WAKEUP_TIMER_BUSY</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8h_source.html#l00098">BlueNRG1_timer.h:98</a></div></div>
<div class="ttc" id="group___t_i_m_e_r___private___macros_html_gaccb016a73722365d8453eea25a32cdf7"><div class="ttname"><a href="group___t_i_m_e_r___private___macros.html#gaccb016a73722365d8453eea25a32cdf7">TIME_ABSDIFF</a></div><div class="ttdeci">#define TIME_ABSDIFF(a, b)          </div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00116">BlueNRG1_timer.c:116</a></div></div>
<div class="ttc" id="struct_t_i_m_e_r___init_type_html_a54241705faa9e03e4fefd6958b89a05f"><div class="ttname"><a href="struct_t_i_m_e_r___init_type.html#a54241705faa9e03e4fefd6958b89a05f">TIMER_InitType::TIMER_InitialCalibration</a></div><div class="ttdeci">BOOL TIMER_InitialCalibration</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8h_source.html#l00048">BlueNRG1_timer.h:48</a></div></div>
<div class="ttc" id="group___t_i_m_e_r___public___functions_html_ga25b629dcf17ba3268f9241e852464af2"><div class="ttname"><a href="group___t_i_m_e_r___public___functions.html#ga25b629dcf17ba3268f9241e852464af2">TIMER_StartCalibration</a></div><div class="ttdeci">void TIMER_StartCalibration(void)</div><div class="ttdoc">Start the calibration routine. </div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00422">BlueNRG1_timer.c:422</a></div></div>
<div class="ttc" id="group___t_i_m_e_r___private___macros_html_ga85a9917ff14fede3258d8e7b866e16c9"><div class="ttname"><a href="group___t_i_m_e_r___private___macros.html#ga85a9917ff14fede3258d8e7b866e16c9">WAKEUP_TIMER_EN</a></div><div class="ttdeci">#define WAKEUP_TIMER_EN</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00131">BlueNRG1_timer.c:131</a></div></div>
<div class="ttc" id="group___t_i_m_e_r___public___functions_html_ga1c67015d28baecc93e56488116eb91ce"><div class="ttname"><a href="group___t_i_m_e_r___public___functions.html#ga1c67015d28baecc93e56488116eb91ce">TIMER_GetCurrentCalibrationData</a></div><div class="ttdeci">void TIMER_GetCurrentCalibrationData(TIMER_CalibrationType *data)</div><div class="ttdoc">Return the current calibration data. </div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00538">BlueNRG1_timer.c:538</a></div></div>
<div class="ttc" id="group___t_i_m_e_r___public___functions_html_ga4a4c60a6b58d5991769bf761f08d8921"><div class="ttname"><a href="group___t_i_m_e_r___public___functions.html#ga4a4c60a6b58d5991769bf761f08d8921">TIMER_IsCalibrationRunning</a></div><div class="ttdeci">BOOL TIMER_IsCalibrationRunning(void)</div><div class="ttdoc">Return TRUE if a calibration is on going. It relies on the value of the interrupt status...</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00434">BlueNRG1_timer.c:434</a></div></div>
<div class="ttc" id="_blue_n_r_g1__timer_8h_html"><div class="ttname"><a href="_blue_n_r_g1__timer_8h.html">BlueNRG1_timer.h</a></div><div class="ttdoc">This file contains all the functions prototypes for the TIMER firmware library. </div></div>
<div class="ttc" id="group___t_i_m_e_r___private___macros_html_ga8964acb693ef3063dc7aac5b37a606cb"><div class="ttname"><a href="group___t_i_m_e_r___private___macros.html#ga8964acb693ef3063dc7aac5b37a606cb">TIMER1_EN</a></div><div class="ttdeci">#define TIMER1_EN</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00132">BlueNRG1_timer.c:132</a></div></div>
<div class="ttc" id="group___t_i_m_e_r___public___functions_html_gade1675fc9629b47a676fea2fccd6680e"><div class="ttname"><a href="group___t_i_m_e_r___public___functions.html#gade1675fc9629b47a676fea2fccd6680e">TIMER_SetRadioTimerValue</a></div><div class="ttdeci">uint8_t TIMER_SetRadioTimerValue(uint32_t timeout, BOOL event_type, BOOL cal_req)</div><div class="ttdoc">Program either Timer1 or the Wakeup Timer if the device has enough time to settle after exit from sle...</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00594">BlueNRG1_timer.c:594</a></div></div>
<div class="ttc" id="structtimer__context__s_html_a9b523390624020567145ec3b0a35a700"><div class="ttname"><a href="structtimer__context__s.html#a9b523390624020567145ec3b0a35a700">timer_context_s::roundingError</a></div><div class="ttdeci">int16_t roundingError</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00093">BlueNRG1_timer.c:93</a></div></div>
<div class="ttc" id="group___t_i_m_e_r___private___types_definitions_html_ga535132efc461718adb8d3d52e7d47563"><div class="ttname"><a href="group___t_i_m_e_r___private___types_definitions.html#ga535132efc461718adb8d3d52e7d47563">TIMER_ContextType</a></div><div class="ttdeci">struct timer_context_s TIMER_ContextType</div></div>
<div class="ttc" id="group___t_i_m_e_r___public___functions_html_ga12f8c3a86856743e738ddd2a363c1255"><div class="ttname"><a href="group___t_i_m_e_r___public___functions.html#ga12f8c3a86856743e738ddd2a363c1255">TIMER_GetActivitySysDelay</a></div><div class="ttdeci">uint8_t TIMER_GetActivitySysDelay(uint8_t event_type, uint8_t cal_req)</div><div class="ttdoc">Get the radio setup delay in system time. </div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00787">BlueNRG1_timer.c:787</a></div></div>
<div class="ttc" id="structtimer__context__s_html_a13a03153d810d652c5992139312808d1"><div class="ttname"><a href="structtimer__context__s.html#a13a03153d810d652c5992139312808d1">timer_context_s::tx_cal_delay_st</a></div><div class="ttdeci">uint8_t tx_cal_delay_st</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00089">BlueNRG1_timer.c:89</a></div></div>
<div class="ttc" id="group___t_i_m_e_r___private___macros_html_ga1f63d063dc08bd8eff4c15e3942793a7"><div class="ttname"><a href="group___t_i_m_e_r___private___macros.html#ga1f63d063dc08bd8eff4c15e3942793a7">TIMER_20MSB_MASK</a></div><div class="ttdeci">#define TIMER_20MSB_MASK</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00111">BlueNRG1_timer.c:111</a></div></div>
<div class="ttc" id="group___t_i_m_e_r___public___functions_html_ga59559fc0d99df367a45a91adb9bbb8cd"><div class="ttname"><a href="group___t_i_m_e_r___public___functions.html#ga59559fc0d99df367a45a91adb9bbb8cd">TIMER_ClearRadioTimerValue</a></div><div class="ttdeci">void TIMER_ClearRadioTimerValue(void)</div><div class="ttdoc">Disable Wakeup Timer, Timer1 and Timer2 enabling sleep. </div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00499">BlueNRG1_timer.c:499</a></div></div>
<div class="ttc" id="structtimer__context__s_html_a8b516120d60b773df78df4863e34dbd7"><div class="ttname"><a href="structtimer__context__s.html#a8b516120d60b773df78df4863e34dbd7">timer_context_s::periodic_calibration</a></div><div class="ttdeci">uint8_t periodic_calibration</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00086">BlueNRG1_timer.c:86</a></div></div>
<div class="ttc" id="structtimer__calibration__s_html"><div class="ttname"><a href="structtimer__calibration__s.html">timer_calibration_s</a></div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8h_source.html#l00052">BlueNRG1_timer.h:52</a></div></div>
<div class="ttc" id="structtimer__context__s_html_ad200cbb24ee96f76c974e6ae24daf98c"><div class="ttname"><a href="structtimer__context__s.html#ad200cbb24ee96f76c974e6ae24daf98c">timer_context_s::freq</a></div><div class="ttdeci">uint32_t freq</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00080">BlueNRG1_timer.c:80</a></div></div>
<div class="ttc" id="group___t_i_m_e_r___private___macros_html_ga125af6df2956a88705c7efdba86cabe5"><div class="ttname"><a href="group___t_i_m_e_r___private___macros.html#ga125af6df2956a88705c7efdba86cabe5">ATOMIC_SECTION_BEGIN</a></div><div class="ttdeci">#define ATOMIC_SECTION_BEGIN()</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00121">BlueNRG1_timer.c:121</a></div></div>
<div class="ttc" id="structtimer__context__s_html_a440f5a272d99f879ec97794b1f715769"><div class="ttname"><a href="structtimer__context__s.html#a440f5a272d99f879ec97794b1f715769">timer_context_s::tx_no_cal_delay_st</a></div><div class="ttdeci">uint8_t tx_no_cal_delay_st</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00090">BlueNRG1_timer.c:90</a></div></div>
<div class="ttc" id="structtimer__context__s_html"><div class="ttname"><a href="structtimer__context__s.html">timer_context_s</a></div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00072">BlueNRG1_timer.c:72</a></div></div>
<div class="ttc" id="group___t_i_m_e_r___exported___constants_html_ga423ef88144bdcab97d1f32b9c1c6aae8"><div class="ttname"><a href="group___t_i_m_e_r___exported___constants.html#ga423ef88144bdcab97d1f32b9c1c6aae8">TIMER1_BUSY</a></div><div class="ttdeci">#define TIMER1_BUSY</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8h_source.html#l00096">BlueNRG1_timer.h:96</a></div></div>
<div class="ttc" id="structtimer__context__s_html_ab0ff3bc7654bccb35da0840fd0b3ad09"><div class="ttname"><a href="structtimer__context__s.html#ab0ff3bc7654bccb35da0840fd0b3ad09">timer_context_s::period1</a></div><div class="ttdeci">uint32_t period1</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00082">BlueNRG1_timer.c:82</a></div></div>
<div class="ttc" id="group___t_i_m_e_r___public___functions_html_ga3128db178d3e2c131cd6e24954c7917a"><div class="ttname"><a href="group___t_i_m_e_r___public___functions.html#ga3128db178d3e2c131cd6e24954c7917a">TIMER_Init</a></div><div class="ttdeci">void TIMER_Init(TIMER_InitType *TIMER_InitStruct)</div><div class="ttdoc">Initialize the TIMER functionality. </div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00336">BlueNRG1_timer.c:336</a></div></div>
<div class="ttc" id="structtimer__context__s_html_a46972ef9e28fdd4b4d295deda5495aac"><div class="ttname"><a href="structtimer__context__s.html#a46972ef9e28fdd4b4d295deda5495aac">timer_context_s::last_period_slow</a></div><div class="ttdeci">uint16_t last_period_slow</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00078">BlueNRG1_timer.c:78</a></div></div>
<div class="ttc" id="group___t_i_m_e_r___private___macros_html_gafa99ec4acc4ecb2dc3c2d05da15d0e3f"><div class="ttname"><a href="group___t_i_m_e_r___private___macros.html#gafa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a></div><div class="ttdeci">#define MAX(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00119">BlueNRG1_timer.c:119</a></div></div>
<div class="ttc" id="group___t_i_m_e_r___exported___constants_html_ga82e5a62a8aeae504b21d5534bb2a3449"><div class="ttname"><a href="group___t_i_m_e_r___exported___constants.html#ga82e5a62a8aeae504b21d5534bb2a3449">TIMER2_TIMER_MASK</a></div><div class="ttdeci">#define TIMER2_TIMER_MASK</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8h_source.html#l00102">BlueNRG1_timer.h:102</a></div></div>
<div class="ttc" id="group___t_i_m_e_r___public___functions_html_ga2a5d5795a186f997c752faa6e8b521c0"><div class="ttname"><a href="group___t_i_m_e_r___public___functions.html#ga2a5d5795a186f997c752faa6e8b521c0">TIMER_GetFutureSysTime</a></div><div class="ttdeci">uint64_t TIMER_GetFutureSysTime(uint32_t time)</div><div class="ttdoc">Return the system time referred to the absolute machine time passed as parameter. ...</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00510">BlueNRG1_timer.c:510</a></div></div>
<div class="ttc" id="group___t_i_m_e_r___private___macros_html_gae1010f6bb6df72adfefbcf4290eb9694"><div class="ttname"><a href="group___t_i_m_e_r___private___macros.html#gae1010f6bb6df72adfefbcf4290eb9694">TIME_DIFF</a></div><div class="ttdeci">#define TIME_DIFF(a, b)          </div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00113">BlueNRG1_timer.c:113</a></div></div>
<div class="ttc" id="structtimer__context__s_html_ae4709c8010902304bbd1ebd776d9fa60"><div class="ttname"><a href="structtimer__context__s.html#ae4709c8010902304bbd1ebd776d9fa60">timer_context_s::period</a></div><div class="ttdeci">uint32_t period</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00079">BlueNRG1_timer.c:79</a></div></div>
<div class="ttc" id="struct_t_i_m_e_r___init_type_html"><div class="ttname"><a href="struct_t_i_m_e_r___init_type.html">TIMER_InitType</a></div><div class="ttdoc">Structure definition of TIMER initialization. </div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8h_source.html#l00041">BlueNRG1_timer.h:41</a></div></div>
<div class="ttc" id="group___t_i_m_e_r___public___functions_html_gade83e9fda38c4b08b74af157c7834651"><div class="ttname"><a href="group___t_i_m_e_r___public___functions.html#gade83e9fda38c4b08b74af157c7834651">TIMER_SysTimeToMachineTime</a></div><div class="ttdeci">uint32_t TIMER_SysTimeToMachineTime(uint32_t time)</div><div class="ttdoc">Return the MTU corresponding to the STU passed as parameter. </div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00723">BlueNRG1_timer.c:723</a></div></div>
<div class="ttc" id="struct_t_i_m_e_r___init_type_html_a89e12963b5c4c6d48b439bce9ce96700"><div class="ttname"><a href="struct_t_i_m_e_r___init_type.html#a89e12963b5c4c6d48b439bce9ce96700">TIMER_InitType::TIMER_PeriodicCalibration</a></div><div class="ttdeci">BOOL TIMER_PeriodicCalibration</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8h_source.html#l00049">BlueNRG1_timer.h:49</a></div></div>
<div class="ttc" id="group___device___system___delays_html_gadd2eb21e18b285bcaa9a9e7032c463fe"><div class="ttname"><a href="group___device___system___delays.html#gadd2eb21e18b285bcaa9a9e7032c463fe">DELAY_RX_NO_CAL</a></div><div class="ttdeci">#define DELAY_RX_NO_CAL</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8h_source.html#l00090">BlueNRG1_timer.h:90</a></div></div>
<div class="ttc" id="group___device___system___delays_html_gae555a64363f3c5d4ebd1a9675271dfea"><div class="ttname"><a href="group___device___system___delays.html#gae555a64363f3c5d4ebd1a9675271dfea">DELAY_TX</a></div><div class="ttdeci">#define DELAY_TX</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8h_source.html#l00087">BlueNRG1_timer.h:87</a></div></div>
<div class="ttc" id="group___t_i_m_e_r___public___functions_html_ga624dafba8076c3ceb2800303e75bf9c2"><div class="ttname"><a href="group___t_i_m_e_r___public___functions.html#ga624dafba8076c3ceb2800303e75bf9c2">TIMER_MachineTimeToSysTime</a></div><div class="ttdeci">uint32_t TIMER_MachineTimeToSysTime(uint32_t time)</div><div class="ttdoc">Return the STU corresponding to the MTU passed as parameter. </div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00735">BlueNRG1_timer.c:735</a></div></div>
<div class="ttc" id="structtimer__context__s_html_a5d3123428eced128897fe6ac6688373e"><div class="ttname"><a href="structtimer__context__s.html#a5d3123428eced128897fe6ac6688373e">timer_context_s::hs_startup_time</a></div><div class="ttdeci">uint32_t hs_startup_time</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00075">BlueNRG1_timer.c:75</a></div></div>
<div class="ttc" id="structtimer__context__s_html_aab6c9f44474c2efae3fa6178d7549dc2"><div class="ttname"><a href="structtimer__context__s.html#aab6c9f44474c2efae3fa6178d7549dc2">timer_context_s::last_calibration_machine_time</a></div><div class="ttdeci">uint32_t last_calibration_machine_time</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00085">BlueNRG1_timer.c:85</a></div></div>
<div class="ttc" id="group___t_i_m_e_r___public___functions_html_ga33c90a5678f3e64cfd3ceed18b8ba82c"><div class="ttname"><a href="group___t_i_m_e_r___public___functions.html#ga33c90a5678f3e64cfd3ceed18b8ba82c">TIMER_updateWkupTimeOffset</a></div><div class="ttdeci">void TIMER_updateWkupTimeOffset(void)</div><div class="ttdoc">Update the value of wakeup_time_offset variable in RAM. </div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00699">BlueNRG1_timer.c:699</a></div></div>
<div class="ttc" id="structtimer__context__s_html_aa07e91b072d117eb3678dea01b29c199"><div class="ttname"><a href="structtimer__context__s.html#aa07e91b072d117eb3678dea01b29c199">timer_context_s::last_calibration_time</a></div><div class="ttdeci">uint64_t last_calibration_time</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00074">BlueNRG1_timer.c:74</a></div></div>
<div class="ttc" id="struct_t_i_m_e_r___init_type_html_a8f37d9e2ed1cb82d5036dad71fc33f21"><div class="ttname"><a href="struct_t_i_m_e_r___init_type.html#a8f37d9e2ed1cb82d5036dad71fc33f21">TIMER_InitType::XTAL_StartupTime</a></div><div class="ttdeci">uint16_t XTAL_StartupTime</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8h_source.html#l00043">BlueNRG1_timer.h:43</a></div></div>
<div class="ttc" id="group___t_i_m_e_r___public___functions_html_ga0eeba98c495209667ba227aac604702a"><div class="ttname"><a href="group___t_i_m_e_r___public___functions.html#ga0eeba98c495209667ba227aac604702a">TIMER_Calibrate</a></div><div class="ttdeci">void TIMER_Calibrate(void)</div><div class="ttdoc">Perform a low speed clock calibration and store results in the global context. It updates the XTAL st...</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00382">BlueNRG1_timer.c:382</a></div></div>
<div class="ttc" id="group___device___system___delays_html_ga503b879507c351e999c5f3e1d98fbd4a"><div class="ttname"><a href="group___device___system___delays.html#ga503b879507c351e999c5f3e1d98fbd4a">DELAY_TX_NO_CAL</a></div><div class="ttdeci">#define DELAY_TX_NO_CAL</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8h_source.html#l00088">BlueNRG1_timer.h:88</a></div></div>
<div class="ttc" id="group___t_i_m_e_r___exported___constants_html_ga0084af799735418c94bf0a3973e4801a"><div class="ttname"><a href="group___t_i_m_e_r___exported___constants.html#ga0084af799735418c94bf0a3973e4801a">TIMER2_BUSY</a></div><div class="ttdeci">#define TIMER2_BUSY</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8h_source.html#l00097">BlueNRG1_timer.h:97</a></div></div>
<div class="ttc" id="group___t_i_m_e_r___public___functions_html_ga88243574d09e3b9d759930296f08d14c"><div class="ttname"><a href="group___t_i_m_e_r___public___functions.html#ga88243574d09e3b9d759930296f08d14c">TIMER_SetRadioCloseTimeout</a></div><div class="ttdeci">void TIMER_SetRadioCloseTimeout(void)</div><div class="ttdoc">Program the radio timer (a.k.a Timer1) as close as possible. </div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00772">BlueNRG1_timer.c:772</a></div></div>
<div class="ttc" id="structtimer__calibration__s_html_a67abf1b675e7f4ffdfcd38d9927ae2a6"><div class="ttname"><a href="structtimer__calibration__s.html#a67abf1b675e7f4ffdfcd38d9927ae2a6">timer_calibration_s::period</a></div><div class="ttdeci">uint32_t period</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8h_source.html#l00054">BlueNRG1_timer.h:54</a></div></div>
<div class="ttc" id="group___t_i_m_e_r___private___variables_html_gaf454441a6ed3ab9274cd6fa0a67c5041"><div class="ttname"><a href="group___t_i_m_e_r___private___variables.html#gaf454441a6ed3ab9274cd6fa0a67c5041">TIMER_Context</a></div><div class="ttdeci">TIMER_ContextType TIMER_Context</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00141">BlueNRG1_timer.c:141</a></div></div>
<div class="ttc" id="structtimer__context__s_html_abc42dc0fc7154486ef336dc662470c37"><div class="ttname"><a href="structtimer__context__s.html#abc42dc0fc7154486ef336dc662470c37">timer_context_s::last_period1</a></div><div class="ttdeci">uint32_t last_period1</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00083">BlueNRG1_timer.c:83</a></div></div>
<div class="ttc" id="structtimer__calibration__s_html_a6deb6e58564d958d1446078e28bf656f"><div class="ttname"><a href="structtimer__calibration__s.html#a6deb6e58564d958d1446078e28bf656f">timer_calibration_s::freq</a></div><div class="ttdeci">uint32_t freq</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8h_source.html#l00055">BlueNRG1_timer.h:55</a></div></div>
<div class="ttc" id="group___t_i_m_e_r___public___functions_html_ga98d9ad2d334495f69f3c9920dd9576c5"><div class="ttname"><a href="group___t_i_m_e_r___public___functions.html#ga98d9ad2d334495f69f3c9920dd9576c5">TIMER_SetWakeupTime</a></div><div class="ttdeci">uint32_t TIMER_SetWakeupTime(uint32_t delay, BOOL allow_sleep)</div><div class="ttdoc">Set the wakeup time to the specified delay. The delay is converted in machine time and only 20 most s...</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00560">BlueNRG1_timer.c:560</a></div></div>
<div class="ttc" id="structtimer__context__s_html_ae8215266d87490b0da83be2091441a32"><div class="ttname"><a href="structtimer__context__s.html#ae8215266d87490b0da83be2091441a32">timer_context_s::freq1</a></div><div class="ttdeci">uint32_t freq1</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00081">BlueNRG1_timer.c:81</a></div></div>
<div class="ttc" id="structtimer__context__s_html_aa3260b2f7c390bff2172d290083a9731"><div class="ttname"><a href="structtimer__context__s.html#aa3260b2f7c390bff2172d290083a9731">timer_context_s::rx_no_cal_delay_st</a></div><div class="ttdeci">uint8_t rx_no_cal_delay_st</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00092">BlueNRG1_timer.c:92</a></div></div>
<div class="ttc" id="group___t_i_m_e_r___public___functions_html_ga1606d739c79f37bab156a7dda5e27f69"><div class="ttname"><a href="group___t_i_m_e_r___public___functions.html#ga1606d739c79f37bab156a7dda5e27f69">TIMER_UsToMachinetime</a></div><div class="ttdeci">uint32_t TIMER_UsToMachinetime(uint32_t time)</div><div class="ttdoc">Return the machine time referred to the time in microseconds passed as parameter. ...</div><div class="ttdef"><b>Definition:</b> <a href="_blue_n_r_g1__timer_8c_source.html#l00755">BlueNRG1_timer.c:755</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.10-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Copyright &copy; 2020 by STMicrolectronics. All rights reserved.<br>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
