<!-- HTML header for doxygen 1.8.10-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>BlueNRG-BLE Stack Library APIs, events callbacks &amp; application framework: C:/GIT_vobs/BlueNRG1_2_DK_3_2_1/Library/cryptolib/inc/AES/CMAC/aes_cmac.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="STcustom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ST-logo-small.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BlueNRG-BLE Stack Library APIs, events callbacks &amp; application framework
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_5ad7f572bbca03234e8e621e192fc099.html">Library</a></li><li class="navelem"><a class="el" href="dir_7d3b949f1e2c547554c5d68655584363.html">cryptolib</a></li><li class="navelem"><a class="el" href="dir_a85fbdfe0fa55e3cea65d8ac85ddd3bb.html">inc</a></li><li class="navelem"><a class="el" href="dir_0b267889b68761412e5bc3c210f5b2d2.html">AES</a></li><li class="navelem"><a class="el" href="dir_ba0987705dd32ae0b90ed6ad527ab280.html">CMAC</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a>  </div>
  <div class="headertitle">
<div class="title">aes_cmac.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>AES in CMAC Mode.  
<a href="#details">More...</a></p>

<p><a href="aes__cmac_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_a_e_s_c_m_a_cctx__stt.html">AESCMACctx_stt</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr class="memitem:a5ae0223d3f8d9e18e7a31fe2ace8e778"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes__cmac_8h.html#a5ae0223d3f8d9e18e7a31fe2ace8e778">AES_CMAC_Encrypt_Init</a> (<a class="el" href="struct_a_e_s_c_m_a_cctx__stt.html">AESCMACctx_stt</a> *P_pAESCMACctx)</td></tr>
<tr class="memdesc:a5ae0223d3f8d9e18e7a31fe2ace8e778"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialization for AES-CMAC for Authentication TAG Generation.  <a href="#a5ae0223d3f8d9e18e7a31fe2ace8e778">More...</a><br /></td></tr>
<tr class="separator:a5ae0223d3f8d9e18e7a31fe2ace8e778"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5b186a2a33960b4eab485d2902bbcf2"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes__cmac_8h.html#ac5b186a2a33960b4eab485d2902bbcf2">AES_CMAC_Encrypt_Append</a> (<a class="el" href="struct_a_e_s_c_m_a_cctx__stt.html">AESCMACctx_stt</a> *P_pAESCMACctx, const uint8_t *P_pInputBuffer, int32_t P_inputSize)</td></tr>
<tr class="memdesc:ac5b186a2a33960b4eab485d2902bbcf2"><td class="mdescLeft">&#160;</td><td class="mdescRight">AES Encryption in CMAC Mode.  <a href="#ac5b186a2a33960b4eab485d2902bbcf2">More...</a><br /></td></tr>
<tr class="separator:ac5b186a2a33960b4eab485d2902bbcf2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d4bf49a7f6984d31f829a1bcfafc448"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes__cmac_8h.html#a6d4bf49a7f6984d31f829a1bcfafc448">AES_CMAC_Encrypt_Finish</a> (<a class="el" href="struct_a_e_s_c_m_a_cctx__stt.html">AESCMACctx_stt</a> *P_pAESCMACctx, uint8_t *P_pOutputBuffer, int32_t *P_pOutputSize)</td></tr>
<tr class="memdesc:a6d4bf49a7f6984d31f829a1bcfafc448"><td class="mdescLeft">&#160;</td><td class="mdescRight">AES Finalization of CMAC Mode.  <a href="#a6d4bf49a7f6984d31f829a1bcfafc448">More...</a><br /></td></tr>
<tr class="separator:a6d4bf49a7f6984d31f829a1bcfafc448"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58a605267832c321edf5c143f1dd3af6"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes__cmac_8h.html#a58a605267832c321edf5c143f1dd3af6">AES_CMAC_Decrypt_Init</a> (<a class="el" href="struct_a_e_s_c_m_a_cctx__stt.html">AESCMACctx_stt</a> *P_pAESCMACctx)</td></tr>
<tr class="memdesc:a58a605267832c321edf5c143f1dd3af6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialization for AES-CMAC for Authentication TAG Verification.  <a href="#a58a605267832c321edf5c143f1dd3af6">More...</a><br /></td></tr>
<tr class="separator:a58a605267832c321edf5c143f1dd3af6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5544519b7912f230e2b4cd077d3c51b2"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes__cmac_8h.html#a5544519b7912f230e2b4cd077d3c51b2">AES_CMAC_Decrypt_Append</a> (<a class="el" href="struct_a_e_s_c_m_a_cctx__stt.html">AESCMACctx_stt</a> *P_pAESCMACctx, const uint8_t *P_pInputBuffer, int32_t P_inputSize)</td></tr>
<tr class="memdesc:a5544519b7912f230e2b4cd077d3c51b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">AES-CMAC Data Processing.  <a href="#a5544519b7912f230e2b4cd077d3c51b2">More...</a><br /></td></tr>
<tr class="separator:a5544519b7912f230e2b4cd077d3c51b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a427cebfcef314f372640c6585cd1dd3a"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes__cmac_8h.html#a427cebfcef314f372640c6585cd1dd3a">AES_CMAC_Decrypt_Finish</a> (<a class="el" href="struct_a_e_s_c_m_a_cctx__stt.html">AESCMACctx_stt</a> *P_pAESCMACctx, uint8_t *P_pOutputBuffer, int32_t *P_pOutputSize)</td></tr>
<tr class="memdesc:a427cebfcef314f372640c6585cd1dd3a"><td class="mdescLeft">&#160;</td><td class="mdescRight">AES Finalization of CMAC Mode.  <a href="#a427cebfcef314f372640c6585cd1dd3a">More...</a><br /></td></tr>
<tr class="separator:a427cebfcef314f372640c6585cd1dd3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>AES in CMAC Mode. </p>
<dl class="section author"><dt>Author</dt><dd>MCD Application Team </dd></dl>
<dl class="section version"><dt>Version</dt><dd>V2.1 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>22-June-2012 </dd></dl>
<dl class="section attention"><dt>Attention</dt><dd></dd></dl>
<h2><center>&copy; COPYRIGHT 2012 STMicroelectronics</center></h2>
<p>Licensed under MCD-ST Liberty SW License Agreement V2, (the "License"); You may not use this file except in compliance with the License. You may obtain a copy of the License at: </p><pre class="fragment">   http:www.st.com/software_license_agreement_liberty_v2
</pre><p>Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License. </p>

<p>Definition in file <a class="el" href="aes__cmac_8h_source.html">aes_cmac.h</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a5544519b7912f230e2b4cd077d3c51b2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t AES_CMAC_Decrypt_Append </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_a_e_s_c_m_a_cctx__stt.html">AESCMACctx_stt</a> *&#160;</td>
          <td class="paramname"><em>P_pAESCMACctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>P_pInputBuffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>P_inputSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>AES-CMAC Data Processing. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">*P_pAESCMACctx</td><td>AES CMAC, already initialized, context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">*P_pInputBuffer</td><td>Input buffer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">P_inputSize</td><td>Size of input data, expressed in bytes </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">AES_SUCCESS</td><td>Operation Successfull </td></tr>
    <tr><td class="paramname">AES_ERR_BAD_PARAMETER</td><td>At least one of the parameters is a NULL pointer </td></tr>
    <tr><td class="paramname">AES_ERR_BAD_INPUT_SIZE</td><td>P_inputSize &lt;= 0 | (P_inputSize % 16 != 0 &amp;&amp; P_pAESCMACctx-&gt;mFlags &amp; E_SK_FINAL_APPEND) != E_SK_FINAL_APPEND) </td></tr>
    <tr><td class="paramname">AES_ERR_BAD_OPERATION</td><td>Append not allowed </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function can be called multiple times with P_inputSize multiple of 16 bytes. The last call allows any positive value for P_inputSize but in the last call to this function the flag E_SK_FINAL_APPEND <b>must</b> <b>be</b> <b>set</b> inside P_pAESCMACctx-&gt;mFlags (i.e. with a simple P_pAESCMACctx-&gt;mFlags |= E_SK_FINAL_APPEND ) </dd></dl>

</div>
</div>
<a class="anchor" id="a427cebfcef314f372640c6585cd1dd3a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t AES_CMAC_Decrypt_Finish </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_a_e_s_c_m_a_cctx__stt.html">AESCMACctx_stt</a> *&#160;</td>
          <td class="paramname"><em>P_pAESCMACctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>P_pOutputBuffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t *&#160;</td>
          <td class="paramname"><em>P_pOutputSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>AES Finalization of CMAC Mode. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">*P_pAESCMACctx</td><td>AES CMAC, already initialized, context </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">*P_pOutputBuffer</td><td>Output buffer </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">*P_pOutputSize</td><td>Size of written output data in uint8_t </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Result of TAG verification or Error Code </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">AES_ERR_BAD_PARAMETER</td><td>At least one of the parameters is a NULL pointer </td></tr>
    <tr><td class="paramname">AES_ERR_BAD_CONTEXT</td><td>Context was not initialized with valid values, see the note below. </td></tr>
    <tr><td class="paramname">AUTHENTICATION_SUCCESSFUL</td><td>if the TAG is verified </td></tr>
    <tr><td class="paramname">AUTHENTICATION_FAILED</td><td>if the TAG is <b>not</b> verified </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function <b>requires:</b> <ul>
<li><code>P_pAESGCMctx-&gt;pmTag</code> to be set to a valid pointer to the tag to be checked</li>
<li><code>P_pAESGCMctx-&gt;mTagSize</code> to contain a valid value between 1 and 16. </li>
</ul>
</dd></dl>

</div>
</div>
<a class="anchor" id="a58a605267832c321edf5c143f1dd3af6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t AES_CMAC_Decrypt_Init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_a_e_s_c_m_a_cctx__stt.html">AESCMACctx_stt</a> *&#160;</td>
          <td class="paramname"><em>P_pAESCMACctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialization for AES-CMAC for Authentication TAG Verification. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">*P_pAESCMACctx</td><td>AES CMAC context </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">AES_SUCCESS</td><td>Operation Successfull </td></tr>
    <tr><td class="paramname">AES_ERR_BAD_PARAMETER</td><td>At least one of the parameters is a NULL pointer </td></tr>
    <tr><td class="paramname">AES_ERR_BAD_CONTEXT</td><td>Context was not initialized with valid values, see the note below. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd><code>P_pAESCMACctx.pmKey</code> (see <a class="el" href="struct_a_e_s_c_m_a_cctx__stt.html">AESCMACctx_stt</a>) must be set with a pointer to the AES key before calling this function. </dd>
<dd>
<code>P_pAESCMACctx.mKeySize</code> (see <a class="el" href="struct_a_e_s_c_m_a_cctx__stt.html">AESCMACctx_stt</a>) must be set with the size of the key prior to calling this function. Otherwise the following predefined values can be used:<ul>
<li>CRL_AES128_KEY</li>
<li>CRL_AES192_KEY</li>
<li>CRL_AES256_KEY </li>
</ul>
</dd>
<dd>
<code>P_pAESCMACctx.mFlags</code> must be set prior to calling this function. Default value is E_SK_DEFAULT. See SKflags_et for details. </dd>
<dd>
<code>P_pAESCMACctx.pmTag</code> must be set with a pointer to the authentication TAG that will be checked during <a class="el" href="aes__cmac_8h.html#a427cebfcef314f372640c6585cd1dd3a">AES_CMAC_Decrypt_Finish</a> </dd>
<dd>
<code>P_pAESCMACctx.mTagSize</code> must be set with the size of authentication TAG that will be checked by the <a class="el" href="aes__cmac_8h.html#a427cebfcef314f372640c6585cd1dd3a">AES_CMAC_Decrypt_Finish</a> </dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>If hardware support is enabled, DMA will not be used even if <code>E_SK_USE_DMA</code> is set inside <code>P_pAESCMACctx-&gt;mFlags</code>, as CCM is implemented with an interleaved operation and the AES engine is used one block at a time. </dd>
<dd>
This function is just a wrapper for <a class="el" href="aes__cmac_8h.html#a5ae0223d3f8d9e18e7a31fe2ace8e778">AES_CMAC_Encrypt_Init</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ac5b186a2a33960b4eab485d2902bbcf2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t AES_CMAC_Encrypt_Append </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_a_e_s_c_m_a_cctx__stt.html">AESCMACctx_stt</a> *&#160;</td>
          <td class="paramname"><em>P_pAESCMACctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>P_pInputBuffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>P_inputSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>AES Encryption in CMAC Mode. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">*P_pAESCMACctx</td><td>AES CMAC, already initialized, context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">*P_pInputBuffer</td><td>Input buffer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">P_inputSize</td><td>Size of input data in uint8_t (octets) </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">AES_SUCCESS</td><td>Operation Successfull </td></tr>
    <tr><td class="paramname">AES_ERR_BAD_PARAMETER</td><td>At least one of the parameters is a NULL pointer </td></tr>
    <tr><td class="paramname">AES_ERR_BAD_INPUT_SIZE</td><td>P_inputSize &lt; 0 | (P_inputSize % 16 != 0 &amp;&amp; P_pAESCMACctx-&gt;mFlags &amp; E_SK_FINAL_APPEND) != E_SK_FINAL_APPEND) </td></tr>
    <tr><td class="paramname">AES_ERR_BAD_OPERATION</td><td>Append not allowed </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function can be called multiple times with P_inputSize multiple of 16 bytes. The last call allows any positive value for P_inputSize but in the last call to this function the flag E_SK_FINAL_APPEND <b>must</b> <b>be</b> <b>set</b> inside P_pAESCMACctx-&gt;mFlags (i.e. with a simple P_pAESCMACctx-&gt;mFlags |= E_SK_FINAL_APPEND ) </dd></dl>

</div>
</div>
<a class="anchor" id="a6d4bf49a7f6984d31f829a1bcfafc448"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t AES_CMAC_Encrypt_Finish </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_a_e_s_c_m_a_cctx__stt.html">AESCMACctx_stt</a> *&#160;</td>
          <td class="paramname"><em>P_pAESCMACctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>P_pOutputBuffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t *&#160;</td>
          <td class="paramname"><em>P_pOutputSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>AES Finalization of CMAC Mode. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">*P_pAESCMACctx</td><td>AES CMAC, already initialized, context </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">*P_pOutputBuffer</td><td>Output buffer </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">*P_pOutputSize</td><td>Size of written output data in uint8_t </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">AES_SUCCESS</td><td>Operation Successfull </td></tr>
    <tr><td class="paramname">AES_ERR_BAD_PARAMETER</td><td>At least one of the parameters is a NULL pointer </td></tr>
    <tr><td class="paramname">AES_ERR_BAD_CONTEXT</td><td>Context was not initialized with valid values, see the note below. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function <b>requires</b> P_pAESCMACctx-&gt;mTagSize to contain a valid value between 1 and 16. </dd></dl>

</div>
</div>
<a class="anchor" id="a5ae0223d3f8d9e18e7a31fe2ace8e778"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t AES_CMAC_Encrypt_Init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_a_e_s_c_m_a_cctx__stt.html">AESCMACctx_stt</a> *&#160;</td>
          <td class="paramname"><em>P_pAESCMACctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialization for AES-CMAC for Authentication TAG Generation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">*P_pAESCMACctx</td><td>AES CMAC context </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">AES_SUCCESS</td><td>Operation Successfull </td></tr>
    <tr><td class="paramname">AES_ERR_BAD_PARAMETER</td><td>At least one of the parameters is a NULL pointer </td></tr>
    <tr><td class="paramname">AES_ERR_BAD_CONTEXT</td><td>Context was not initialized with valid values, see the note below. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd><code>P_pAESCMACctx.pmKey</code> (see <a class="el" href="struct_a_e_s_c_m_a_cctx__stt.html">AESCMACctx_stt</a>) must be set with a pointer to the AES key before calling this function. </dd>
<dd>
<code>P_pAESCMACctx.mKeySize</code> must be set with the size of the key prior to calling this function. Otherwise the following predefined values can be used:<ul>
<li>CRL_AES128_KEY</li>
<li>CRL_AES192_KEY</li>
<li>CRL_AES256_KEY </li>
</ul>
</dd>
<dd>
<code>P_pAESCMACctx.mFlags</code> must be set prior to calling this function. Default value is E_SK_DEFAULT. See SKflags_et for details. </dd>
<dd>
<code>P_pAESCMACctx.mTagSize</code> must be set with the size of authentication TAG that will be generated by the <a class="el" href="aes__cmac_8h.html#a6d4bf49a7f6984d31f829a1bcfafc448">AES_CMAC_Encrypt_Finish</a> </dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>If hardware support is enabled, DMA will not be used even if <code>E_SK_USE_DMA</code> is set inside <code>P_pAESCMACctx-&gt;mFlags</code>, as CCM is implemented with an interleaved operation and the AES engine is used one block at a time. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.10-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Copyright &copy; 2020 by STMicrolectronics. All rights reserved.<br>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
