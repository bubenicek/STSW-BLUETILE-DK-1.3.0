<!-- HTML header for doxygen 1.8.10-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>BlueNRG-1,2 Bluetooth Low Energy Stack: BlueNRG-BLE Stack Library v_2_0 (14-June-2017)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="STcustom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ST-logo-small.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BlueNRG-1,2 Bluetooth Low Energy Stack
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">BlueNRG-BLE Stack Library v_2_0 (14-June-2017) </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="S1"></a>
Bluetooth Low Energy (BLE) stack binary image files</h1>
<p>This section lists the BLE stack binary library files to be used for the BlueNRG-1, BlueNRG-2 Systems On Chip configuration: <br />
</p>
<ul>
<li>libbluenrg1_stack.a binary library <b>v2.0</b>  </li>
<li><b>NOTES</b>: <ul>
<li>
libbluenrg1_stack.a binary library file <b>v2.0</b> is available on folder: <b>Library\Bluetooth_LE\library </b>. The binary file must be linked to the built user application in order to get access to the BLE stack features. </li>
<li>
libbluenrg1_stack.a is valid for all the supported toolchains: IAR, EWARM, Keil, MDK-ARM and Atollic, TrueStudio. </li>
<li>
When adding libbluenrg1_stack.a on a Keil project, just change the related File Type to Library File (from file Options) </li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="S11"></a>
Bluetooth Low Energy (BLE) stack network coprocessor configuration</h1>
<ul>
<li>Two network coprocessor modes are supported: SPI and UART (mainly for RF evaluation purpose). </li>
<li>The network coprocessor over SPI specification aims at achieving the following targets: <ul>
<li>
Very similar to BlueNRG, BlueNRG-MS protocol </li>
<li>
Power efficient </li>
<li>
Code efficient </li>
<li>
Fast data transfer </li>
</ul>
</li>
<li>DTM project and related workspaces provides reference appplications for configuring the BlueNRG-1 platforms (STEVAL-IDB007V1) or BlueNRG-2 platforms (STEVAL-IDB008V1) as a network coprocessor (refer to BlueNRG-1_2 DK Release notes documentation for more information).</li>
</ul>
<h1><a class="anchor" id="S12"></a>
New Features</h1>
<p>This section lists the new features compared to BlueNRG-BLE Stack Library v1.0a <br />
</p>
<ul>
<li>ID 2382 Added support for BLE v4.2 Privacy features </li>
<li>ID 2383 Addedd support for LE secure connections feature (BLE v4.2) </li>
<li>ID 2558 Added new event notified to the application when a scan response is sent to a peer device (it is disabled by default) </li>
<li>ID 2655 Device Static Random Address can be overwritten by the HAL_WRITE_CONFIG_DATA command </li>
<li>ID 2724 A new parameter has been added to the stack Initialization function to specify the number of data packets in the packet pool </li>
<li>ID 2923 A new parameter has been added to the stack Initialization function to enable the extended data length feature (forward compatibility only, currently only the value ‘0’ is supported) </li>
<li>ID 2936 A new parameter has been added to the stack Initialization function to indicate the total size of the memory area that the application has allocated for the stack. </li>
<li>ID 1654 Supported ATT MTU up to 158 octets </li>
<li>ID 2403 Hot table format change </li>
<li>ID 2433 New GATT command to deny reading a characteristic value when read authorization is enabled </li>
<li>ID 2630 Reduced the wait interval between successive pairing attempts in case of pairing failure </li>
<li>ID 2835 The list of local supported commands has been updated to include new HCI commands related to privacy 1.2 and secure connections </li>
<li>ID 2929 It is now possible to select one specific connection handle to which a notification or indication has to be sent </li>
<li>ID 2934 Authentication requirements have been removed from the GAP Slave Security Request API </li>
<li>ID 2974 Device authentication requirements can be updated during a connection </li>
<li>NOTES: <ul>
<li>
Several GAP APIs have been updated to support Privacy 1.2 (refer to Bluetooth LE Stack v1.x to v2.x migration guideline html documentation) </li>
<li>
Several GAP APIs have been updated to support Secure Connections (refer to Bluetooth LE Stack v1.x to v2.x migration guideline html documentation) </li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="S13"></a>
Solved Issues</h1>
<p>This section lists the solved issues compared to BLE Stack v1.0a <br />
</p>
<ul>
<li>ID 1673 Not possible to use the white list with ACI_GAP_START_OBSERVATION_PROC </li>
<li>ID 1675 Privacy enabled central allowed to use static and public address during some GAP procedures </li>
<li>ID 1676 Privacy enabled peripheral allowed to use NRPA in connectable mode </li>
<li>ID 2107 Internal buffer for long/reliable write not protected in case of simultaneous use on different connection handles </li>
<li>ID 2375 ACI_GAP_SET_UNDIRECTED_CONNECTABLE uses fixed advertising interval. </li>
<li>ID 2385 Possible deadlock when the device is used as a GATT client and server simultaneously </li>
<li>ID 2460 Wrong value reported by hci_le_read_buffer_size </li>
<li>ID 2494 Delay sending packets </li>
<li>ID 2519 Wrong RSSI reported when simultaneous links are active </li>
<li>ID 2654 ACI_HAL_WRITE_CONFIG_DATA cannot change security root keys </li>
<li>ID 2696 Incorrect bitmask returned by read local supported features command </li>
<li>ID 2743 Possible misbehavior of read by group type using 128-bit UUIDs </li>
<li>ID 2766 Poor RSSI accuracy when RSSI is low. </li>
<li>ID 2860 HCI_READ_RSSI called with wrong connection handle does not return an error </li>
<li>ID 2910 Virtual timer callback occasionally called twice when timerNum = 1 </li>
<li>ID 2945 Function HCI_LE_Encrypt may hang if called while the device is scanning </li>
<li>ID 3051 Delayed internal low speed RO calibration </li>
<li>ID 3082 ACI_GAP_START_NAME_DISCOVERY_PROC cannot be stopped </li>
<li>ID 3088 Device may fail to go in advertising if scanning has been stopped by less than 5ms </li>
<li>ID 3097 Stack does not wait the end of the internal RO calibration before going to sleep</li>
</ul>
<h1><a class="anchor" id="S14"></a>
Limitations/Bugs</h1>
<p>This section lists the issues known at firmware image release time. Issues found after this release are listed as solved or limitations on newer releases. <br />
</p>
<ul>
<li>ID 3108 BLE stack v2.0: Controller Privacy is not supported when using a 16MHz HS crystal. </li>
<li>ID 1659 Not able to do fast advertise when all the connections have long connection intervals </li>
<li>ID 1661 Device may hang for 32s if XO start-up time exceeds the HS_STARTUP_TIME value </li>
<li>ID 1663 No service changed indication sent if a reset occurs before disconnection </li>
<li>ID 1677 When device acts as simultaneous slave of two masters and is also scanning with a long scan window, connection with the master may drop in case of concurrent overlapping connection update procedures </li>
<li>ID 1679 If a device starts a direct connection establishment procedure (ACI_GAP_CREATE_CONNECTION) while it is advertising, and in the meantime a connection is established with a master, it is not possible to cancel the pending connection: ACI_GAP_TERMINATE_GAP_PROCEDURE returns "Command Disallowed" </li>
<li>ID 1681 ACI_GATT_TX_POOL_AVAILABLE_EVENT not raised if the connection is dropped/closed </li>
<li>ID 1687 Scanning performed with a maximum duty cycle of 95% </li>
<li>ID 1688: BlueNRG does not stop advertising immediately, but only after next scheduled packet. </li>
<li>ID 1742 In simultaneous advertising and scanning scenario, when the advertising is started first, the advertising interval determines scan interval </li>
<li>ID 2011 Missing HCI_DISCONNECTION_COMPLETE_EVENT event </li>
<li>ID 2353 Slave latency not canceled when host packets are queued during the latency period </li>
<li>ID 2635 High Duty Cycle advertising events may be skipped in case of long HS_STARTUP_TIME </li>
<li>ID 2693 ACI_HAL_END_OF_RADIO_ACTIVITY_EVENT always reports Last_State = Next_State </li>
<li>ID 2694 Security requirements not checked before sending Indications or Notifications </li>
<li>ID 2771 RSSI measurements may be degraded with a very close device </li>
<li>ID 2809 BlueNRG-1 aci_gap_slave_security_req() returns 0x0c if BTLE_StackTick() is not called at least once between the connection complete event and the command </li>
<li>ID 2877 Scan not started if command to start scan is given immediately after advertising or previous scan is stopped </li>
<li>ID 2921 ACI HAL Write Config Data may be issued at any time while it should be possible to execute it only as first command after stack initialization or hci_reset </li>
<li>ID 2922 Not possible to specify that a ATT attribute requires authentication through secure connections; secure connections only mode has to be selected in the authentication requirements for this scenario </li>
<li>ID 2964 When scan window is set to 10ms, actual scanning is done only in one chunk of 2.5ms </li>
<li>ID 3019 High Duty cycle Directed Advertising may last longer than 1.28 seconds in case of long HS_STARTUP_TIME </li>
<li>ID 3047 Host address may be used in scan request while peer RPA resolution is pending when controller privacy is used </li>
<li>ID 3049 Timer queue may be corrupted if a timer is mistakenly stopped within its own expiry callback </li>
<li>ID 3143 aci_gatt_attribute_modified_event event is fragmented in the Exec_Write_Resp function</li>
</ul>
<h1><a class="anchor" id="S141"></a>
BLE stack Flash memory footprints (bytes)</h1>
<table  border="1">
<tr>
<th>Stack version </th><th>Full Stack Size </th><th>BLE Sensor Demo Application (only stack components) </th></tr>
<tr>
<td><b> V2.0 </b> </td><td>100025 </td><td>75038   </td></tr>
</table>
<h1><a class="anchor" id="S142"></a>
BTLE_StackTick Time duration (µs)</h1>
<table  border="1">
<tr>
<th>Stack version </th><th>Only Stack Radio Init </th><th>GATT &amp; GAP init </th></tr>
<tr>
<td><b> V2.0 </b> </td><td>66 </td><td>81   </td></tr>
</table>
<h1><a class="anchor" id="S143"></a>
RAL_Isr Time duration (µs): BLE Advertising,  with advertising interval: 100ms; payload size: 28 bytes</h1>
<table  border="1">
<tr>
<th>Stack version </th><th>TX Channel 1 </th><th>RX Channel 1  </th><th>TX Channel 2 </th><th>RX Channel 2  </th><th>TX Channel 3 </th><th>RX Channel 3  </th></tr>
<tr>
<td><b> V2.0 </b> </td><td>33 </td><td>45 </td><td>33 </td><td>45 </td><td>33 </td><td>103   </td></tr>
</table>
<h1><a class="anchor" id="S144"></a>
RAL_Isr Time duration (µs): BLE Connection, with connection interval: 100 ms; no data exchange (only empty packets)</h1>
<table  border="1">
<tr>
<th>Stack version </th><th>RX </th><th>TX </th></tr>
<tr>
<td><b> V2.0 </b> </td><td>63 </td><td>132   </td></tr>
</table>
<h1><a class="anchor" id="S15"></a>
Documentation</h1>
<ul>
<li>Refer to Bluetooth Low Energy (BLE) API and events html documentation for detailed description of BLE stack APIs and related events callbacks. </li>
<li>Refer to BLE stack migration guidelines from v1.x to v2.x html documentation for guidelines about how to migrate applications from Bluetooth low energy stack v1.x to v2.x. </li>
</ul>
</div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.10-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Copyright &copy; 2020 by STMicrolectronics. All rights reserved.<br>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
