<!-- HTML header for doxygen 1.8.10-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>BlueNRG-1,2 HAL and startup drivers APIs: vtimer.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="STcustom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ST-logo-small.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BlueNRG-1,2 HAL and startup drivers APIs
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">vtimer.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="vtimer_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">/* Includes ------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#include &lt;stddef.h&gt;</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#include &quot;BlueNRG1_timer.h&quot;</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="vtimer_8h.html">vtimer.h</a>&quot;</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="sleep_8h.html">sleep.h</a>&quot;</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div>
<div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="group___v_t_i_m_e_r___private___types_definitions.html#ga125af6df2956a88705c7efdba86cabe5">   67</a></span>&#160;<span class="preprocessor">#define ATOMIC_SECTION_BEGIN() uint32_t uwPRIMASK_Bit = __get_PRIMASK(); \</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor">                                __disable_irq(); \</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="preprocessor"></span><span class="comment">/* Must be called in the same scope of ATOMIC_SECTION_BEGIN */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="group___v_t_i_m_e_r___private___types_definitions.html#gacfff8120ca5315b54cc5ff907c83902d">   70</a></span>&#160;<span class="preprocessor">#define ATOMIC_SECTION_END() __set_PRIMASK(uwPRIMASK_Bit)</span></div>
<div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="group___v_t_i_m_e_r___private___types_definitions.html#gafa99ec4acc4ecb2dc3c2d05da15d0e3f">   71</a></span>&#160;<span class="preprocessor">#define MAX(a,b) ((a) &lt; (b) )? (b) : (a)</span></div>
<div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="group___v_t_i_m_e_r___private___types_definitions.html#ga3acffbd305ee72dcd4593c0d8af64a4f">   72</a></span>&#160;<span class="preprocessor">#define MIN(a,b) ((a) &gt; (b) )? (b) : (a)</span></div>
<div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="group___v_t_i_m_e_r___private___types_definitions.html#ga08cdb6ca93f14983cc2ddf0db4464700">   73</a></span>&#160;<span class="preprocessor">#define DIFF8(a,b) ((a)&gt;=(b) ? ((a)-(b)) : (256-((a)-(b))))</span></div>
<div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="group___v_t_i_m_e_r___private___types_definitions.html#gab3d21259aba8fbe7b2a996018f353d77">   74</a></span>&#160;<span class="preprocessor">#define INCREMENT_EXPIRE_COUNT_ISR (HAL_VTIMER_Context.expired_count = ((HAL_VTIMER_Context.expired_count + 1) == HAL_VTIMER_Context.served_count) ? HAL_VTIMER_Context.expired_count : (HAL_VTIMER_Context.expired_count + 1))</span></div>
<div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="group___v_t_i_m_e_r___private___types_definitions.html#ga45249c919484c94cb2de5e232a8a2857">   75</a></span>&#160;<span class="preprocessor">#define INCREMENT_EXPIRE_COUNT ATOMIC_SECTION_BEGIN(); INCREMENT_EXPIRE_COUNT_ISR ; ATOMIC_SECTION_END();</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                                  </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">/*Minimum programmable value in sys. unit for a radio activity to be in the future*/</span> </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="preprocessor">#if HS_SPEED_XTAL==HS_SPEED_XTAL_32MHZ</span></div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="group___v_t_i_m_e_r___private___types_definitions.html#gadbf84f8389ca366e49c25ae74c8b4c16">   79</a></span>&#160;<span class="preprocessor">#define TIMER1_MARGIN 9 </span><span class="comment">/*TBD*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="preprocessor">#define TIMER1_MARGIN 12 </span><span class="comment">/*TBD*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="struct_h_a_l___v_t_i_m_e_r___context_s.html">   84</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html">HAL_VTIMER_ContextS</a> {</div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a56a5ec998fc953d22310ffc8ed5455ee">   85</a></span>&#160;  uint32_t <a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a56a5ec998fc953d22310ffc8ed5455ee">PeriodicCalibrationInterval</a>;  </div>
<div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a8be087d5097e059cf2c64172d741c76e">   86</a></span>&#160;  <a class="code" href="hal__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> <a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a8be087d5097e059cf2c64172d741c76e">calibration_in_progress</a>;  </div>
<div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#ad191a5b8142d56344dd526de70c33eea">   87</a></span>&#160;  <a class="code" href="hal__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> <a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#ad191a5b8142d56344dd526de70c33eea">enableTimeBase</a>; <span class="comment">/*TBR*/</span></div>
<div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a409e439f10c0b0a2d62eed495a10e62b">   88</a></span>&#160;  uint32_t <a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a409e439f10c0b0a2d62eed495a10e62b">hs_startup_time</a>; <span class="comment">/*TBR*/</span></div>
<div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a9564011d603c99c5b66d132e2b1454f4">   89</a></span>&#160;  <a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html">VTIMER_HandleType</a> *<a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a9564011d603c99c5b66d132e2b1454f4">rootNode</a>;</div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a469e12352153c7f79bb360af025be558">   90</a></span>&#160;  uint8_t <a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a469e12352153c7f79bb360af025be558">expired_count</a>; <span class="comment">/* Progressive number to indicate expired timers */</span></div>
<div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a6a6415f8e6d477e1f1a29b0157b91224">   91</a></span>&#160;  uint8_t <a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a6a6415f8e6d477e1f1a29b0157b91224">served_count</a>; <span class="comment">/* Progressive number to indicate served expired timers */</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;} <a class="code" href="group___v_t_i_m_e_r___private___types_definitions.html#ga8fe244106cd42470148924a013d3de99">HAL_VTIMER_ContextType</a>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="keyword">static</span> <a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html">HAL_VTIMER_ContextType</a> HAL_VTIMER_Context;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="keyword">static</span> <a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html">VTIMER_HandleType</a> calibrationTimer;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="keyword">static</span> <a class="code" href="struct_v_t_i_m_e_r___radio_handle_type_s.html">VTIMER_RadioHandleType</a> radioTimer;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="keyword">static</span> TIMER_CalibrationType calibrationData;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> calibration_callback (<span class="keywordtype">void</span> *handle)</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;{</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  TIMER_StartCalibration();</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  HAL_VTIMER_Context.<a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a8be087d5097e059cf2c64172d741c76e">calibration_in_progress</a> = <a class="code" href="hal__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;}</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="keyword">static</span> <a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html">VTIMER_HandleType</a> * _remove_timer_in_queue(<a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html">VTIMER_HandleType</a> *rootNode, <a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html">VTIMER_HandleType</a> *handle)</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;{</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html">VTIMER_HandleType</a> *current = rootNode;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html">VTIMER_HandleType</a> *prev = NULL;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html">VTIMER_HandleType</a> *returnValue = rootNode;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="keywordflow">while</span> ((current!=NULL) &amp;&amp; (current != handle)) {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    prev = current;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    current=current-&gt;<a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html#a51953ab27ed5da5fc0242722b4537bd6">next</a>;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  }</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="keywordflow">if</span> (current == NULL) {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="comment">/* Not found */</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  }</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (current == rootNode) {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="comment">/* New root node */</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    returnValue = current-&gt;<a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html#a51953ab27ed5da5fc0242722b4537bd6">next</a>;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  }</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    prev-&gt;<a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html#a51953ab27ed5da5fc0242722b4537bd6">next</a> = current-&gt;<a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html#a51953ab27ed5da5fc0242722b4537bd6">next</a>;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  }</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="keywordflow">return</span> returnValue;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;}</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="keyword">static</span> <a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html">VTIMER_HandleType</a> * _insert_timer_in_queue(<a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html">VTIMER_HandleType</a> *rootNode, <a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html">VTIMER_HandleType</a> *handle)</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;{</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html">VTIMER_HandleType</a> *current = rootNode;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html">VTIMER_HandleType</a> *prev = NULL;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html">VTIMER_HandleType</a> *returnValue = rootNode;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="keywordflow">while</span> ((current!=NULL) &amp;&amp; (current-&gt;<a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html#a9528c6497645126b8293fffd4b16fc8c">expiryTime</a> &lt; handle-&gt;<a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html#a9528c6497645126b8293fffd4b16fc8c">expiryTime</a>)) {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    prev = current;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    current=current-&gt;<a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html#a51953ab27ed5da5fc0242722b4537bd6">next</a>;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  }</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  handle-&gt;<a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html#a51953ab27ed5da5fc0242722b4537bd6">next</a> = current;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="keywordflow">if</span> (prev == NULL) {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="comment">/* We are the new root */</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    returnValue = handle;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  }</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    prev-&gt;<a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html#a51953ab27ed5da5fc0242722b4537bd6">next</a> = handle;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="keywordflow">return</span> returnValue;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;}</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">/* Set timeout and skip non active timers */</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="keyword">static</span> <a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html">VTIMER_HandleType</a> *_update_user_timeout(<a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html">VTIMER_HandleType</a> *rootNode, uint8_t *expired)</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;{</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html">VTIMER_HandleType</a> *curr = rootNode;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html">VTIMER_HandleType</a> *rootOrig = rootNode;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  int32_t delay;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  *expired =0;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="keywordflow">while</span> (curr != NULL) {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordflow">if</span> (curr-&gt;<a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html#a29166f80ce4b5c58d419312f78bacb96">active</a>) {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      <a class="code" href="group___v_t_i_m_e_r___private___types_definitions.html#ga125af6df2956a88705c7efdba86cabe5">ATOMIC_SECTION_BEGIN</a>();</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      delay = curr-&gt;<a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html#a9528c6497645126b8293fffd4b16fc8c">expiryTime</a>-TIMER_GetCurrentSysTime();</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="keywordflow">if</span> (delay &gt; 0) {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <span class="comment">/* Protection against interrupt must be used to avoid that the called function will be interrupted</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">          and so the timer programming will happen after the target time is already passed</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">          leading to a timer expiring after timer wraps, instead of the expected delay */</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        TIMER_SetWakeupTime(delay, <a class="code" href="hal__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <a class="code" href="group___v_t_i_m_e_r___private___types_definitions.html#gacfff8120ca5315b54cc5ff907c83902d">ATOMIC_SECTION_END</a>();</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      }</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <span class="comment">/* Timeout in the past or very close, what to do ??? */</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <span class="comment">/* Set a flag for further processing ? or set a very close timeout ?*/</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        *expired = 1;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <a class="code" href="group___v_t_i_m_e_r___private___types_definitions.html#gacfff8120ca5315b54cc5ff907c83902d">ATOMIC_SECTION_END</a>();</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      }</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    }</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    curr=curr-&gt;<a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html#a51953ab27ed5da5fc0242722b4537bd6">next</a>;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  }</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="keywordflow">if</span> (*expired)</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordflow">return</span> rootOrig;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="keywordflow">return</span> curr;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;}</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">/* Check the number of expired timer from rootNode (ordered list of timers) and return the list of expired timers */</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="keyword">static</span> <a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html">VTIMER_HandleType</a> *_check_callbacks(<a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html">VTIMER_HandleType</a> *rootNode,<a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html">VTIMER_HandleType</a> **expiredList)</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;{</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html">VTIMER_HandleType</a> *curr = rootNode;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html">VTIMER_HandleType</a> *prev = NULL;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html">VTIMER_HandleType</a> *returnValue = rootNode;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  *expiredList = rootNode;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  int32_t delay;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  uint32_t expiredCount = 0;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="keywordflow">while</span> (curr != NULL) {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordflow">if</span> (curr-&gt;<a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html#a29166f80ce4b5c58d419312f78bacb96">active</a>) {</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      delay = curr-&gt;<a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html#a9528c6497645126b8293fffd4b16fc8c">expiryTime</a>-TIMER_GetCurrentSysTime();</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      <span class="keywordflow">if</span> (delay &gt; 0) {</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <span class="comment">/* End of expired timers list*/</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      }</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    } </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    prev = curr;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    curr=curr-&gt;<a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html#a51953ab27ed5da5fc0242722b4537bd6">next</a>;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    expiredCount++;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  }</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="keywordflow">if</span> (expiredCount) {</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="comment">/* Some timers expired */</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    prev-&gt;<a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html#a51953ab27ed5da5fc0242722b4537bd6">next</a>=NULL;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    returnValue = curr;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  }</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="comment">/* No timer expired */</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    *expiredList = NULL;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  }</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="keywordflow">return</span> returnValue;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;}</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> _start_timer(<a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html">VTIMER_HandleType</a> *timerHandle, uint64_t time)</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;{</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  uint8_t expired = 0;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="comment">/* The timer is already started*/</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="keywordflow">if</span>(timerHandle-&gt;<a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html#a29166f80ce4b5c58d419312f78bacb96">active</a>)</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  {</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  }</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  timerHandle-&gt;<a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html#a9528c6497645126b8293fffd4b16fc8c">expiryTime</a> = time;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  timerHandle-&gt;<a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html#a29166f80ce4b5c58d419312f78bacb96">active</a> = <a class="code" href="hal__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <span class="keywordflow">if</span> (_insert_timer_in_queue(HAL_VTIMER_Context.<a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a9564011d603c99c5b66d132e2b1454f4">rootNode</a>, timerHandle) == timerHandle) {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    HAL_VTIMER_Context.<a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a9564011d603c99c5b66d132e2b1454f4">rootNode</a> = _update_user_timeout(timerHandle, &amp;expired);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordflow">if</span> (expired) {</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      <span class="comment">/* A new root timer is already expired, mimic timer expire that is normally signaled</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">      through the interrupt handler that increase the number of expired timers*/</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      <a class="code" href="group___v_t_i_m_e_r___private___types_definitions.html#ga45249c919484c94cb2de5e232a8a2857">INCREMENT_EXPIRE_COUNT</a>;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    }</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <span class="keywordflow">return</span> expired;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;}</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">/*Check if it is time to program the pending radio timer (large timeouts).</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">1) The radio event is before the next calibration. Then the timer must be programmed.</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">2) The calibration timer expired but the calibration didn&#39;t start and the values not updated as expected.</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">   Then the last calibration time is misleading. The radio timer must be programmed.</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">3) The radio event is after the next calibration event. Then the timer will be programmed with the latest values.</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">The check on the last calibration time is made even though the calibration is not needed in order to avoid counter wrapping</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">with timeouts far in the future.</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00279"></a><span class="lineno"><a class="line" href="group___v_t_i_m_e_r___private___function.html#gacb2416abb83897827ea8430d14e152c9">  279</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="group___v_t_i_m_e_r___private___function.html#gacb2416abb83897827ea8430d14e152c9">_check_radio_activity</a>(<a class="code" href="struct_v_t_i_m_e_r___radio_handle_type_s.html">VTIMER_RadioHandleType</a> * timerHandle, uint8_t *expired)</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;{</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  uint32_t sys_delay;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  uint64_t nextCalibrationEvent,currentTime; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                                 </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  *expired = 0;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <span class="keywordflow">if</span> (timerHandle-&gt;<a class="code" href="struct_v_t_i_m_e_r___radio_handle_type_s.html#a22b9bda680e9f825fe56a0dd54ab3ef3">pending</a>){</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    nextCalibrationEvent = calibrationData.last_calibration_time + \</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                           HAL_VTIMER_Context.PeriodicCalibrationInterval;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <a class="code" href="group___v_t_i_m_e_r___private___types_definitions.html#ga125af6df2956a88705c7efdba86cabe5">ATOMIC_SECTION_BEGIN</a>();</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    currentTime = TIMER_GetCurrentSysTime();</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordflow">if</span>((timerHandle-&gt;<a class="code" href="struct_v_t_i_m_e_r___radio_handle_type_s.html#a8be9e072b9f40552147d419f182a0397">expiryTime</a> &lt; (nextCalibrationEvent + <a class="code" href="group___radio___exported___constants.html#ga4ffa715be4a5d326a660e34698b38828">RADIO_ACTIVITY_MARGIN</a>)) \</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                                    || \</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      (currentTime &gt; (nextCalibrationEvent + <a class="code" href="group___radio___exported___constants.html#ga474dc04f10ddbbb1d5cde5feb9cb0558">CALIB_SAFE_THR</a>)))</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;     {</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      sys_delay = TIMER_GetActivitySysDelay(timerHandle-&gt;<a class="code" href="struct_v_t_i_m_e_r___radio_handle_type_s.html#a3c962931bc008b457e00a49273bd8ecb">event_type</a>,timerHandle-&gt;<a class="code" href="struct_v_t_i_m_e_r___radio_handle_type_s.html#a0072edb361743a559932f59cf591fe26">cal_req</a>);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      <span class="keywordflow">if</span> (timerHandle-&gt;<a class="code" href="struct_v_t_i_m_e_r___radio_handle_type_s.html#a8be9e072b9f40552147d419f182a0397">expiryTime</a> &gt; currentTime + sys_delay + <a class="code" href="group___v_t_i_m_e_r___private___types_definitions.html#gadbf84f8389ca366e49c25ae74c8b4c16">TIMER1_MARGIN</a>){</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        *expired = TIMER_SetRadioTimerValue(timerHandle-&gt;<a class="code" href="struct_v_t_i_m_e_r___radio_handle_type_s.html#a8be9e072b9f40552147d419f182a0397">expiryTime</a>, timerHandle-&gt;<a class="code" href="struct_v_t_i_m_e_r___radio_handle_type_s.html#a3c962931bc008b457e00a49273bd8ecb">event_type</a>,timerHandle-&gt;<a class="code" href="struct_v_t_i_m_e_r___radio_handle_type_s.html#a0072edb361743a559932f59cf591fe26">cal_req</a>);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <a class="code" href="group___v_t_i_m_e_r___private___types_definitions.html#gacfff8120ca5315b54cc5ff907c83902d">ATOMIC_SECTION_END</a>();</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        timerHandle-&gt;<a class="code" href="struct_v_t_i_m_e_r___radio_handle_type_s.html#a22b9bda680e9f825fe56a0dd54ab3ef3">pending</a> = <a class="code" href="hal__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>; <span class="comment">/*timer has been served. No more pending*/</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        timerHandle-&gt;<a class="code" href="struct_v_t_i_m_e_r___radio_handle_type_s.html#ae78ee1e29e270240b0cdce74b83e9a75">active</a> = <a class="code" href="hal__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>; <span class="comment">/*timer has been programmed and it becomes ACTIVE*/</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      }</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <a class="code" href="group___v_t_i_m_e_r___private___types_definitions.html#gacfff8120ca5315b54cc5ff907c83902d">ATOMIC_SECTION_END</a>();</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        *expired = 1;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      }</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    }</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      <a class="code" href="group___v_t_i_m_e_r___private___types_definitions.html#gacfff8120ca5315b54cc5ff907c83902d">ATOMIC_SECTION_END</a>();</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      TIMER_SetTimeoutReg(1&lt;&lt;28);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  }</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;}</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> _virtualTimeBaseEnable(<a class="code" href="hal__types_8h.html#ac9a7e9a35d2513ec15c3b537aaa4fba1">FunctionalState</a> state)</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;{</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="keywordflow">if</span>(state != <a class="code" href="hal__types_8h.html#ac9a7e9a35d2513ec15c3b537aaa4fba1ad3a9df141be0ccf10389b640f492b26d">DISABLE</a>)</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  {</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="keywordflow">if</span> (HAL_VTIMER_Context.<a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#ad191a5b8142d56344dd526de70c33eea">enableTimeBase</a> == <a class="code" href="hal__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>)</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    {</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      calibration_callback(&amp;calibrationTimer);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      HAL_VTIMER_Context.<a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#ad191a5b8142d56344dd526de70c33eea">enableTimeBase</a> = <a class="code" href="hal__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    }</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  }</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  {</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <a class="code" href="group___v_t_i_m_e_r___public___function.html#ga587f3c1112d65c7fea9f0d94af5735ad">HAL_VTimer_Stop</a>(&amp;calibrationTimer);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    HAL_VTIMER_Context.<a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#ad191a5b8142d56344dd526de70c33eea">enableTimeBase</a> = <a class="code" href="hal__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  }</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;}</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div>
<div class="line"><a name="l00350"></a><span class="lineno"><a class="line" href="group___v_t_i_m_e_r___public___function.html#gaf1d8b105f2bfda39e1ef1b2804ba9882">  350</a></span>&#160;<a class="code" href="group___v_t_i_m_e_r___exported___types.html#ga0217df3674519b78410e66545b09d6ee">RadioStatus</a> <a class="code" href="group___v_t_i_m_e_r___public___function.html#gaf1d8b105f2bfda39e1ef1b2804ba9882">HAL_VTimer_GetRadioTimerValue</a>(uint32_t *time)</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;{</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  *time = radioTimer.<a class="code" href="struct_v_t_i_m_e_r___radio_handle_type_s.html#a8be9e072b9f40552147d419f182a0397">expiryTime</a>;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <span class="keywordflow">if</span> (radioTimer.<a class="code" href="struct_v_t_i_m_e_r___radio_handle_type_s.html#a22b9bda680e9f825fe56a0dd54ab3ef3">pending</a> || radioTimer.<a class="code" href="struct_v_t_i_m_e_r___radio_handle_type_s.html#ae78ee1e29e270240b0cdce74b83e9a75">active</a>)</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group___v_t_i_m_e_r___exported___types.html#gga0217df3674519b78410e66545b09d6eea4d845c6aaa87e5237d2fa85b2ad1317e">RADIO_TIMER_PENDING</a>;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group___v_t_i_m_e_r___exported___types.html#gga0217df3674519b78410e66545b09d6eeafbaf726116172c486424f1a03eca59cc">RADIO_TIMER_OFF</a>;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;}</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div>
<div class="line"><a name="l00366"></a><span class="lineno"><a class="line" href="group___v_t_i_m_e_r___public___function.html#ga294de6476d1b923b32c6281640609826">  366</a></span>&#160;uint8_t <a class="code" href="group___v_t_i_m_e_r___public___function.html#ga294de6476d1b923b32c6281640609826">HAL_VTimer_ClearRadioTimerValue</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;{</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  int64_t time_diff;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  uint8_t retVal;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  TIMER_ClearRadioTimerValue();</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  radioTimer.<a class="code" href="struct_v_t_i_m_e_r___radio_handle_type_s.html#ae78ee1e29e270240b0cdce74b83e9a75">active</a> = <a class="code" href="hal__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  radioTimer.<a class="code" href="struct_v_t_i_m_e_r___radio_handle_type_s.html#a22b9bda680e9f825fe56a0dd54ab3ef3">pending</a> = <a class="code" href="hal__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <a class="code" href="group___v_t_i_m_e_r___private___types_definitions.html#ga125af6df2956a88705c7efdba86cabe5">ATOMIC_SECTION_BEGIN</a>();</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  time_diff = radioTimer.<a class="code" href="struct_v_t_i_m_e_r___radio_handle_type_s.html#a8be9e072b9f40552147d419f182a0397">expiryTime</a> \</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;              - TIMER_GetCurrentSysTime() \</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;              - TIMER_GetActivitySysDelay(radioTimer.<a class="code" href="struct_v_t_i_m_e_r___radio_handle_type_s.html#a3c962931bc008b457e00a49273bd8ecb">event_type</a>,radioTimer.<a class="code" href="struct_v_t_i_m_e_r___radio_handle_type_s.html#a0072edb361743a559932f59cf591fe26">cal_req</a>) \</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;              - HAL_VTIMER_Context.<a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a409e439f10c0b0a2d62eed495a10e62b">hs_startup_time</a>;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <a class="code" href="group___v_t_i_m_e_r___private___types_definitions.html#gacfff8120ca5315b54cc5ff907c83902d">ATOMIC_SECTION_END</a>();</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160; <span class="comment">/*</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">  if(time_diff &lt;= 0)</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">    retVal = HAL_VTIMER_LATE;</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <span class="keywordflow">if</span> (time_diff &lt; <a class="code" href="group___radio___exported___constants.html#gaff3836771fb9f269c772188087ed438c">CLEAR_TIME_MIN</a>)</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    retVal = <a class="code" href="group___radio___exported___constants.html#ga877c6848189c959fbe6a8719213024ff">HAL_VTIMER_CRITICAL</a>;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    retVal = <a class="code" href="group___radio___exported___constants.html#ga773b8ff1a71b3f0c1f292a6b8e1384c5">HAL_VTIMER_SUCCESS</a>;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  }</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <span class="keywordflow">return</span> retVal;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;}</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div>
<div class="line"><a name="l00397"></a><span class="lineno"><a class="line" href="group___v_t_i_m_e_r___public___function.html#ga2266d78ab1fdc199cc33271cf57a7328">  397</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="group___v_t_i_m_e_r___public___function.html#ga2266d78ab1fdc199cc33271cf57a7328">HAL_VTimer_StopRadioTimer2</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;{</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  TIMER_ClearRadioTimerValue();</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;}</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div>
<div class="line"><a name="l00408"></a><span class="lineno"><a class="line" href="group___v_t_i_m_e_r___public___function.html#ga340e1a2a0814d3cd0e4c424128a77b73">  408</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="group___v_t_i_m_e_r___public___function.html#ga340e1a2a0814d3cd0e4c424128a77b73">HAL_VTIMER_TimeoutCallback</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;{</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  <span class="comment">/* Disable host timer and enable the sleep*/</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  TIMER_SetHostTimeoutReg(1&lt;&lt;28);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  <a class="code" href="group___v_t_i_m_e_r___private___types_definitions.html#gab3d21259aba8fbe7b2a996018f353d77">INCREMENT_EXPIRE_COUNT_ISR</a>;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;}</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div>
<div class="line"><a name="l00419"></a><span class="lineno"><a class="line" href="group___v_t_i_m_e_r___public___function.html#ga57a0ed22841524238fa069e90858a3d5">  419</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="group___v_t_i_m_e_r___public___function.html#ga57a0ed22841524238fa069e90858a3d5">HAL_VTIMER_RadioTimerIsr</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;{</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  radioTimer.<a class="code" href="struct_v_t_i_m_e_r___radio_handle_type_s.html#ae78ee1e29e270240b0cdce74b83e9a75">active</a> = <a class="code" href="hal__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;}</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div>
<div class="line"><a name="l00432"></a><span class="lineno"><a class="line" href="group___v_t_i_m_e_r___public___function.html#ga6d553aaf09e4c134b63d6218b26ff832">  432</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="group___v_t_i_m_e_r___public___function.html#ga6d553aaf09e4c134b63d6218b26ff832">HAL_VTimerStart_sysT32</a>(<a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html">VTIMER_HandleType</a> *timerHandle, uint64_t time)</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;{</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  uint8_t retVal;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  retVal = _start_timer(timerHandle, time);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  _virtualTimeBaseEnable(<a class="code" href="hal__types_8h.html#ac9a7e9a35d2513ec15c3b537aaa4fba1a7d46875fa3ebd2c34d2756950eda83bf">ENABLE</a>);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  <span class="keywordflow">return</span> retVal;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;}</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;</div>
<div class="line"><a name="l00447"></a><span class="lineno"><a class="line" href="group___v_t_i_m_e_r___public___function.html#ga94ae05e6e7406c14a693c319169a86e2">  447</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="group___v_t_i_m_e_r___public___function.html#ga94ae05e6e7406c14a693c319169a86e2">HAL_VTimerStart_ms</a>(<a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html">VTIMER_HandleType</a> *timerHandle, uint32_t msRelTimeout)</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;{</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  uint64_t temp = msRelTimeout;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  uint8_t retVal;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  retVal = _start_timer(timerHandle, TIMER_GetCurrentSysTime() + (temp*TIMER_SYSTICK_PER_10MS)/10);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  _virtualTimeBaseEnable(<a class="code" href="hal__types_8h.html#ac9a7e9a35d2513ec15c3b537aaa4fba1a7d46875fa3ebd2c34d2756950eda83bf">ENABLE</a>);</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  <span class="keywordflow">return</span> retVal; </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;}</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div>
<div class="line"><a name="l00466"></a><span class="lineno"><a class="line" href="group___v_t_i_m_e_r___public___function.html#gadb09adc35bd80510ff420b0cdcc16aea">  466</a></span>&#160;uint8_t <a class="code" href="group___v_t_i_m_e_r___public___function.html#gadb09adc35bd80510ff420b0cdcc16aea">HAL_VTimer_SetRadioTimerValue</a>(uint32_t time, uint8_t event_type, uint8_t cal_req)</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;{</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  uint8_t retVal = 0;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  </div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  radioTimer.<a class="code" href="struct_v_t_i_m_e_r___radio_handle_type_s.html#a3c962931bc008b457e00a49273bd8ecb">event_type</a> = event_type;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  radioTimer.<a class="code" href="struct_v_t_i_m_e_r___radio_handle_type_s.html#a0072edb361743a559932f59cf591fe26">cal_req</a> = cal_req;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  radioTimer.<a class="code" href="struct_v_t_i_m_e_r___radio_handle_type_s.html#a8be9e072b9f40552147d419f182a0397">expiryTime</a> = calibrationData.last_calibration_time + (uint32_t)(time - (uint32_t)calibrationData.last_calibration_time);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  radioTimer.<a class="code" href="struct_v_t_i_m_e_r___radio_handle_type_s.html#ae78ee1e29e270240b0cdce74b83e9a75">active</a> = <a class="code" href="hal__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  radioTimer.<a class="code" href="struct_v_t_i_m_e_r___radio_handle_type_s.html#a22b9bda680e9f825fe56a0dd54ab3ef3">pending</a> = <a class="code" href="hal__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  <a class="code" href="group___v_t_i_m_e_r___private___function.html#gacb2416abb83897827ea8430d14e152c9">_check_radio_activity</a>(&amp;radioTimer, &amp;retVal);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  <span class="keywordflow">if</span> (retVal){</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    radioTimer.<a class="code" href="struct_v_t_i_m_e_r___radio_handle_type_s.html#a22b9bda680e9f825fe56a0dd54ab3ef3">pending</a> = <a class="code" href="hal__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  }</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  _virtualTimeBaseEnable(<a class="code" href="hal__types_8h.html#ac9a7e9a35d2513ec15c3b537aaa4fba1a7d46875fa3ebd2c34d2756950eda83bf">ENABLE</a>);</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  <span class="keywordflow">return</span> retVal; </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;}</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div>
<div class="line"><a name="l00490"></a><span class="lineno"><a class="line" href="group___v_t_i_m_e_r___public___function.html#ga587f3c1112d65c7fea9f0d94af5735ad">  490</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="group___v_t_i_m_e_r___public___function.html#ga587f3c1112d65c7fea9f0d94af5735ad">HAL_VTimer_Stop</a>(<a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html">VTIMER_HandleType</a> *timerHandle)</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;{</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  <a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html">VTIMER_HandleType</a> *rootNode = _remove_timer_in_queue(HAL_VTIMER_Context.<a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a9564011d603c99c5b66d132e2b1454f4">rootNode</a>, timerHandle);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  uint8_t expired = 0;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  timerHandle-&gt;<a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html#a29166f80ce4b5c58d419312f78bacb96">active</a>=<a class="code" href="hal__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="keywordflow">if</span> (HAL_VTIMER_Context.<a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a9564011d603c99c5b66d132e2b1454f4">rootNode</a> != rootNode &amp;&amp; rootNode != NULL) {</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    HAL_VTIMER_Context.<a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a9564011d603c99c5b66d132e2b1454f4">rootNode</a> = _update_user_timeout(rootNode, &amp;expired);</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="keywordflow">if</span> (expired) {</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      <span class="comment">/* A new root timer is already expired, mimic timer expire */</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;      <a class="code" href="group___v_t_i_m_e_r___private___types_definitions.html#ga45249c919484c94cb2de5e232a8a2857">INCREMENT_EXPIRE_COUNT</a>;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    }</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  }</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;     HAL_VTIMER_Context.<a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a9564011d603c99c5b66d132e2b1454f4">rootNode</a> = rootNode;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;}       </div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;</div>
<div class="line"><a name="l00512"></a><span class="lineno"><a class="line" href="group___v_t_i_m_e_r___public___function.html#gad6bc6fc6411987df78053675f51f4a14">  512</a></span>&#160;uint32_t <a class="code" href="group___v_t_i_m_e_r___public___function.html#gad6bc6fc6411987df78053675f51f4a14">HAL_VTimerGetCurrentTime_sysT32</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;{</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  <span class="keywordflow">return</span> ((uint32_t ) TIMER_GetCurrentSysTime());</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;}</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;</div>
<div class="line"><a name="l00521"></a><span class="lineno"><a class="line" href="group___v_t_i_m_e_r___public___function.html#gad8a3825461350990147c342fb0eab229">  521</a></span>&#160;uint64_t <a class="code" href="group___v_t_i_m_e_r___public___function.html#gad8a3825461350990147c342fb0eab229">HAL_VTIMER_GetAnchorPoint</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;{</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  <span class="keywordflow">return</span> TIMER_GetAnchorPoint();</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;}</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;</div>
<div class="line"><a name="l00533"></a><span class="lineno"><a class="line" href="group___v_t_i_m_e_r___public___function.html#gaf9f41587a748ade10ee700ac65996701">  533</a></span>&#160;uint64_t <a class="code" href="group___v_t_i_m_e_r___public___function.html#gaf9f41587a748ade10ee700ac65996701">HAL_VTimerAcc_sysT32_ms</a>(uint64_t sysTime, int32_t msTime)</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;{</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  int32_t sysTick = (msTime * TIMER_SYSTICK_PER_10MS)/10;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  <span class="keywordflow">return</span> (sysTime+sysTick);</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;}</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div>
<div class="line"><a name="l00546"></a><span class="lineno"><a class="line" href="group___v_t_i_m_e_r___public___function.html#gafd324aaa270ffdfc73718161a97d7bb2">  546</a></span>&#160;int64_t <a class="code" href="group___v_t_i_m_e_r___public___function.html#gafd324aaa270ffdfc73718161a97d7bb2">HAL_VTimerDiff_ms_sysT32</a>(uint64_t sysTime1, uint64_t sysTime2)</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;{</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="keywordflow">return</span> ((sysTime1-sysTime2)*10)/TIMER_SYSTICK_PER_10MS;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;}</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;</div>
<div class="line"><a name="l00556"></a><span class="lineno"><a class="line" href="group___v_t_i_m_e_r___public___function.html#gae717b1000872fd901c77e60a74e72e0a">  556</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="group___v_t_i_m_e_r___public___function.html#gae717b1000872fd901c77e60a74e72e0a">HAL_VTimerExpiry_sysT32</a>(<a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html">VTIMER_HandleType</a> *timerHandle, uint64_t *sysTime)</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;{</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  *sysTime = timerHandle-&gt;<a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html#a9528c6497645126b8293fffd4b16fc8c">expiryTime</a>;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;}</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;</div>
<div class="line"><a name="l00566"></a><span class="lineno"><a class="line" href="group___v_t_i_m_e_r___public___function.html#ga9cad075d6ec15937f981dc558823047e">  566</a></span>&#160;uint32_t <a class="code" href="group___v_t_i_m_e_r___public___function.html#ga9cad075d6ec15937f981dc558823047e">HAL_VTIMER_GetPendingTimers</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;{</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  <a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html">VTIMER_HandleType</a> *curr = HAL_VTIMER_Context.<a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a9564011d603c99c5b66d132e2b1454f4">rootNode</a>;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  uint32_t counter = 0;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <span class="keywordflow">while</span> (curr != NULL) {</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    counter++;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    curr = curr-&gt;<a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html#a51953ab27ed5da5fc0242722b4537bd6">next</a>;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  }</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  <span class="keywordflow">return</span> counter;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;}</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;</div>
<div class="line"><a name="l00582"></a><span class="lineno"><a class="line" href="group___v_t_i_m_e_r___public___function.html#gaed9b6ad8c982914c2b804700241b7e0b">  582</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="group___v_t_i_m_e_r___public___function.html#gaed9b6ad8c982914c2b804700241b7e0b">HAL_VTIMER_Init</a>(<a class="code" href="struct_h_a_l___v_t_i_m_e_r___init_s.html">HAL_VTIMER_InitType</a> *HAL_TIMER_InitStruct)</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;{</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  TIMER_InitType TIMER_InitStruct;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  TIMER_EnableBlueIRQ();</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  TIMER_InitStruct.TIMER_InitialCalibration = HAL_TIMER_InitStruct-&gt;<a class="code" href="struct_h_a_l___v_t_i_m_e_r___init_s.html#a5f7ad1f8f2182e44e8fac388a616f85d">EnableInitialCalibration</a>;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  TIMER_InitStruct.TIMER_PeriodicCalibration = HAL_TIMER_InitStruct-&gt;<a class="code" href="struct_h_a_l___v_t_i_m_e_r___init_s.html#ab43e330faccd3e4e74bc5c32de5a4cb7">PeriodicCalibrationInterval</a>;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  TIMER_InitStruct.XTAL_StartupTime = HAL_TIMER_InitStruct-&gt;<a class="code" href="struct_h_a_l___v_t_i_m_e_r___init_s.html#a4a32333ed2c9c4a516b2fb3f13440cbe">XTAL_StartupTime</a>;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  TIMER_Init(&amp;TIMER_InitStruct);</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  TIMER_GetCurrentCalibrationData(&amp;calibrationData);</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  HAL_VTIMER_Context.<a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a9564011d603c99c5b66d132e2b1454f4">rootNode</a> = NULL;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  HAL_VTIMER_Context.<a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#ad191a5b8142d56344dd526de70c33eea">enableTimeBase</a> = <a class="code" href="hal__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>; <span class="comment">/*TBR*/</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  radioTimer.<a class="code" href="struct_v_t_i_m_e_r___radio_handle_type_s.html#ae78ee1e29e270240b0cdce74b83e9a75">active</a> = <a class="code" href="hal__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  radioTimer.<a class="code" href="struct_v_t_i_m_e_r___radio_handle_type_s.html#a22b9bda680e9f825fe56a0dd54ab3ef3">pending</a> = <a class="code" href="hal__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  HAL_VTIMER_Context.<a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a409e439f10c0b0a2d62eed495a10e62b">hs_startup_time</a> = HAL_TIMER_InitStruct-&gt;<a class="code" href="struct_h_a_l___v_t_i_m_e_r___init_s.html#a4a32333ed2c9c4a516b2fb3f13440cbe">XTAL_StartupTime</a>; <span class="comment">/*TBR*/</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  HAL_VTIMER_Context.<a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a469e12352153c7f79bb360af025be558">expired_count</a>=0;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  HAL_VTIMER_Context.<a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a6a6415f8e6d477e1f1a29b0157b91224">served_count</a>=0;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  HAL_VTIMER_Context.<a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a56a5ec998fc953d22310ffc8ed5455ee">PeriodicCalibrationInterval</a> = (TIMER_SYSTICK_PER_10MS * HAL_TIMER_InitStruct-&gt;<a class="code" href="struct_h_a_l___v_t_i_m_e_r___init_s.html#ab43e330faccd3e4e74bc5c32de5a4cb7">PeriodicCalibrationInterval</a>)/10;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  HAL_VTIMER_Context.<a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a8be087d5097e059cf2c64172d741c76e">calibration_in_progress</a> = <a class="code" href="hal__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  </div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  <span class="keywordflow">if</span> (HAL_VTIMER_Context.<a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a56a5ec998fc953d22310ffc8ed5455ee">PeriodicCalibrationInterval</a> == 0)</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    HAL_VTIMER_Context.<a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a56a5ec998fc953d22310ffc8ed5455ee">PeriodicCalibrationInterval</a> = TIMER_MachineTimeToSysTime(TIMER_MAX_VALUE-TIMER_WRAPPING_MARGIN);</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    HAL_VTIMER_Context.<a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a56a5ec998fc953d22310ffc8ed5455ee">PeriodicCalibrationInterval</a> = <a class="code" href="group___v_t_i_m_e_r___private___types_definitions.html#ga3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(HAL_VTIMER_Context.<a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a56a5ec998fc953d22310ffc8ed5455ee">PeriodicCalibrationInterval</a>,</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                                                       TIMER_MachineTimeToSysTime(TIMER_MAX_VALUE-TIMER_WRAPPING_MARGIN));</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  calibrationTimer.<a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html#a6b592b6a432c4e22fafc886492dcb215">callback</a> = calibration_callback;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  calibrationTimer.<a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html#a20c14eaf8526f4114cc71a5e29d338cd">userData</a> = NULL;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  _start_timer(&amp;calibrationTimer, TIMER_GetCurrentSysTime() + HAL_VTIMER_Context.<a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a56a5ec998fc953d22310ffc8ed5455ee">PeriodicCalibrationInterval</a>);</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;}</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;</div>
<div class="line"><a name="l00617"></a><span class="lineno"><a class="line" href="group___v_t_i_m_e_r___public___function.html#ga3e0fa8ea7b066acf8f2299d2cb73ae19">  617</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="group___v_t_i_m_e_r___public___function.html#ga3e0fa8ea7b066acf8f2299d2cb73ae19">HAL_VTIMER_Tick</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;{</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  uint8_t expired = 0;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  <span class="keywordflow">if</span>(radioTimer.<a class="code" href="struct_v_t_i_m_e_r___radio_handle_type_s.html#ae78ee1e29e270240b0cdce74b83e9a75">active</a>){</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="keywordflow">if</span>(radioTimer.<a class="code" href="struct_v_t_i_m_e_r___radio_handle_type_s.html#a8be9e072b9f40552147d419f182a0397">expiryTime</a> &lt; TIMER_GetCurrentSysTime()){</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;      radioTimer.<a class="code" href="struct_v_t_i_m_e_r___radio_handle_type_s.html#ae78ee1e29e270240b0cdce74b83e9a75">active</a> = <a class="code" href="hal__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    }</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  }</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  </div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  <span class="comment">/* Check for expired timers */</span>  </div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  <span class="keywordflow">while</span> (<a class="code" href="group___v_t_i_m_e_r___private___types_definitions.html#ga08cdb6ca93f14983cc2ddf0db4464700">DIFF8</a>(HAL_VTIMER_Context.<a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a469e12352153c7f79bb360af025be558">expired_count</a>,HAL_VTIMER_Context.<a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a6a6415f8e6d477e1f1a29b0157b91224">served_count</a>)) {</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html">VTIMER_HandleType</a> *expiredList, *curr;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    uint8_t to_be_served = <a class="code" href="group___v_t_i_m_e_r___private___types_definitions.html#ga08cdb6ca93f14983cc2ddf0db4464700">DIFF8</a>(HAL_VTIMER_Context.<a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a469e12352153c7f79bb360af025be558">expired_count</a>,HAL_VTIMER_Context.<a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a6a6415f8e6d477e1f1a29b0157b91224">served_count</a>);</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    </div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    HAL_VTIMER_Context.<a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a9564011d603c99c5b66d132e2b1454f4">rootNode</a> = _check_callbacks(HAL_VTIMER_Context.<a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a9564011d603c99c5b66d132e2b1454f4">rootNode</a>, &amp;expiredList);</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <span class="comment">/* Call all the user callbacks */</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    curr=expiredList;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <span class="keywordflow">while</span> (curr != NULL) {</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;      <span class="comment">/* Save next pointer, in case callback start the timer again */</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;      <a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html">VTIMER_HandleType</a> *next = curr-&gt;<a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html#a51953ab27ed5da5fc0242722b4537bd6">next</a>;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;      curr-&gt;<a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html#a29166f80ce4b5c58d419312f78bacb96">active</a> = <a class="code" href="hal__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;      <span class="keywordflow">if</span> (curr-&gt;<a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html#a6b592b6a432c4e22fafc886492dcb215">callback</a>)</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        curr-&gt;<a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html#a6b592b6a432c4e22fafc886492dcb215">callback</a>(curr); </div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;      curr = next;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    }</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    HAL_VTIMER_Context.<a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a9564011d603c99c5b66d132e2b1454f4">rootNode</a> = _update_user_timeout(HAL_VTIMER_Context.<a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a9564011d603c99c5b66d132e2b1454f4">rootNode</a>, &amp;expired);</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <span class="keywordflow">if</span> (expired == 1) {</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;      <span class="comment">/* A new root timer is already expired, mimic timer expire */</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;      <a class="code" href="group___v_t_i_m_e_r___private___types_definitions.html#ga45249c919484c94cb2de5e232a8a2857">INCREMENT_EXPIRE_COUNT</a>;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    }</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    HAL_VTIMER_Context.<a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a6a6415f8e6d477e1f1a29b0157b91224">served_count</a> += to_be_served;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  }</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <span class="comment">/* Check for periodic calibration */</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  <span class="keywordflow">if</span> (HAL_VTIMER_Context.<a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a8be087d5097e059cf2c64172d741c76e">calibration_in_progress</a>) {</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <span class="keywordflow">if</span> (TIMER_IsCalibrationRunning() == <a class="code" href="hal__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>) {</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;      <span class="comment">/* Calibration is completed */</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;      HAL_VTIMER_Context.<a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a8be087d5097e059cf2c64172d741c76e">calibration_in_progress</a> = <a class="code" href="hal__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;      <span class="comment">/* Collect calibration data */</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;      TIMER_UpdateCalibrationData();</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;      TIMER_GetCurrentCalibrationData(&amp;calibrationData);</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;      <a class="code" href="group___v_t_i_m_e_r___private___function.html#gacb2416abb83897827ea8430d14e152c9">_check_radio_activity</a>(&amp;radioTimer,&amp;expired);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;      <span class="comment">/* Schedule next calibration event */</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;      _start_timer(&amp;calibrationTimer, TIMER_GetCurrentSysTime() + HAL_VTIMER_Context.<a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a56a5ec998fc953d22310ffc8ed5455ee">PeriodicCalibrationInterval</a>);</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    }           </div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  }</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  <span class="comment">/* if there is a periodic calibration, start it in advance during the active phase */</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <span class="keywordflow">if</span>(calibrationData.periodic_calibration){</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;      <span class="keywordflow">if</span>( TIMER_GetCurrentSysTime() &gt; calibrationData.last_calibration_time + TIMER_SYSTICK_PER_SECOND)</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;      {</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        <a class="code" href="group___v_t_i_m_e_r___public___function.html#ga587f3c1112d65c7fea9f0d94af5735ad">HAL_VTimer_Stop</a>(&amp;calibrationTimer);</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        calibration_callback(&amp;calibrationTimer);</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;      }</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    }</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  }</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;}</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;</div>
<div class="line"><a name="l00680"></a><span class="lineno"><a class="line" href="group___v_t_i_m_e_r___public___function.html#gae1e1a3648d2f813f4dfcfa082e046bd6">  680</a></span>&#160;<a class="code" href="sleep_8h.html#ace58749df14c14b64252eb55f40d2c32">SleepModes</a> <a class="code" href="group___v_t_i_m_e_r___public___function.html#gae1e1a3648d2f813f4dfcfa082e046bd6">HAL_VTIMER_TimerSleepCheck</a>(<a class="code" href="sleep_8h.html#ace58749df14c14b64252eb55f40d2c32">SleepModes</a> sleepMode)</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;{</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  uint32_t nextRadioActivity, nextHostActivity;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  uint8_t timerState;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  </div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="group___v_t_i_m_e_r___public___function.html#ga236b610f92796d381fa23b6f21d08913">HAL_VTIMER_SleepCheck</a>() == <a class="code" href="hal__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>)</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;  {</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="sleep_8h.html#ace58749df14c14b64252eb55f40d2c32a4b1e70cf7dd0396d75a5ef3bc357694a">SLEEPMODE_RUNNING</a>;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  }</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  TIMER_GetNextTimerActivity(&amp;nextRadioActivity,&amp;nextHostActivity);</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  timerState = TIMER_GetRadioTimerValue(&amp;nextRadioActivity);</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  </div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  <span class="keywordflow">if</span>((__blue_RAM.BlueGlobVar.Config &amp; 8U) != 0U)</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;  {</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="keywordflow">if</span>((radioTimer.<a class="code" href="struct_v_t_i_m_e_r___radio_handle_type_s.html#ae78ee1e29e270240b0cdce74b83e9a75">active</a> || radioTimer.<a class="code" href="struct_v_t_i_m_e_r___radio_handle_type_s.html#a22b9bda680e9f825fe56a0dd54ab3ef3">pending</a>)  &amp;&amp; !(timerState == TIMER1_BUSY))</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    {</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;      <span class="comment">/*No Radio SPI transactions must occur within a certain margin*/</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;      <span class="keywordflow">if</span>(radioTimer.<a class="code" href="struct_v_t_i_m_e_r___radio_handle_type_s.html#a8be9e072b9f40552147d419f182a0397">expiryTime</a> &lt; (TIMER_GetCurrentSysTime() + \</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                              TIMER_GetActivitySysDelay(radioTimer.<a class="code" href="struct_v_t_i_m_e_r___radio_handle_type_s.html#a3c962931bc008b457e00a49273bd8ecb">event_type</a>,radioTimer.<a class="code" href="struct_v_t_i_m_e_r___radio_handle_type_s.html#a0072edb361743a559932f59cf591fe26">cal_req</a>) + \</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                              HAL_VTIMER_Context.<a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a409e439f10c0b0a2d62eed495a10e62b">hs_startup_time</a>) + \</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                              SLEEP_TIME_MIN)</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;      {</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        <span class="keywordflow">return</span>(<a class="code" href="sleep_8h.html#ace58749df14c14b64252eb55f40d2c32a98dd44e8e4c7b7af9e3d00c983aa1b36">SLEEPMODE_CPU_HALT</a>);</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;      }</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;      </div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;      TIMER_SetTimeoutReg(nextRadioActivity);</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    }</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    {</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;      <span class="comment">/*A radio timer has been programmed through the TxRxPack*/</span> </div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;      <span class="comment">/*Timer1 and wakeup timer are programmed only through </span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="comment">      the timer module*/</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;      <span class="keywordflow">if</span> ((timerState == TIMER2_BUSY) || (timerState == TIMER1_BUSY))</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;      {</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="sleep_8h.html#ace58749df14c14b64252eb55f40d2c32a98dd44e8e4c7b7af9e3d00c983aa1b36">SLEEPMODE_CPU_HALT</a>;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;      }</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    }</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    sleepMode = <a class="code" href="sleep_8h.html#ace58749df14c14b64252eb55f40d2c32a93af1c45a33be62df00d0ab82ef04128">SLEEPMODE_WAKETIMER</a>;</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  }</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;  <span class="keywordflow">if</span>(HAL_VTIMER_Context.<a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a9564011d603c99c5b66d132e2b1454f4">rootNode</a>-&gt;<a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html#a29166f80ce4b5c58d419312f78bacb96">active</a> &amp;&amp; HAL_VTIMER_Context.<a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a9564011d603c99c5b66d132e2b1454f4">rootNode</a> != NULL)</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;  {</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    <span class="keywordflow">if</span>((HAL_VTIMER_Context.<a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a9564011d603c99c5b66d132e2b1454f4">rootNode</a>-&gt;<a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html#a51953ab27ed5da5fc0242722b4537bd6">next</a> == NULL) &amp;&amp; (HAL_VTIMER_Context.<a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a9564011d603c99c5b66d132e2b1454f4">rootNode</a> == &amp;calibrationTimer))</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    {</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;      <span class="keywordflow">if</span>(sleepMode == <a class="code" href="sleep_8h.html#ace58749df14c14b64252eb55f40d2c32a559adb5abaebc7504743f8684ab16f28">SLEEPMODE_NOTIMER</a>)</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;      {</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        _virtualTimeBaseEnable(<a class="code" href="hal__types_8h.html#ac9a7e9a35d2513ec15c3b537aaa4fba1ad3a9df141be0ccf10389b640f492b26d">DISABLE</a>);</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;        TIMER_SetHostTimeoutReg(<a class="code" href="group___radio___exported___constants.html#gad3a2344fcb503af2ef601fb6dad1ef50">BLUE_SLEEP_ENABLE</a>);</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="sleep_8h.html#ace58749df14c14b64252eb55f40d2c32a559adb5abaebc7504743f8684ab16f28">SLEEPMODE_NOTIMER</a>;</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;      }</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    }</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <span class="keywordflow">if</span>(HAL_VTIMER_Context.<a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a9564011d603c99c5b66d132e2b1454f4">rootNode</a>-&gt;<a class="code" href="struct_v_t_i_m_e_r___handle_type_s.html#a9528c6497645126b8293fffd4b16fc8c">expiryTime</a> &lt; (TIMER_GetCurrentSysTime() + SLEEP_TIME_MIN))</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    {</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="sleep_8h.html#ace58749df14c14b64252eb55f40d2c32a98dd44e8e4c7b7af9e3d00c983aa1b36">SLEEPMODE_CPU_HALT</a>; </div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    }</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    TIMER_SetHostTimeoutReg(nextHostActivity | <a class="code" href="group___radio___exported___constants.html#gad3a2344fcb503af2ef601fb6dad1ef50">BLUE_SLEEP_ENABLE</a>);</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    sleepMode = <a class="code" href="sleep_8h.html#ace58749df14c14b64252eb55f40d2c32a93af1c45a33be62df00d0ab82ef04128">SLEEPMODE_WAKETIMER</a>;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  }</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  <span class="keywordflow">return</span> sleepMode;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;}</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;</div>
<div class="line"><a name="l00747"></a><span class="lineno"><a class="line" href="group___v_t_i_m_e_r___public___function.html#ga236b610f92796d381fa23b6f21d08913">  747</a></span>&#160;uint8_t <a class="code" href="group___v_t_i_m_e_r___public___function.html#ga236b610f92796d381fa23b6f21d08913">HAL_VTIMER_SleepCheck</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;{</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;  <span class="keywordflow">return</span> ((HAL_VTIMER_Context.<a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a469e12352153c7f79bb360af025be558">expired_count</a> == HAL_VTIMER_Context.<a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a6a6415f8e6d477e1f1a29b0157b91224">served_count</a>) &amp;&amp; (HAL_VTIMER_Context.<a class="code" href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a8be087d5097e059cf2c64172d741c76e">calibration_in_progress</a> == <a class="code" href="hal__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>));</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;}</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  <span class="comment">/******************* (C) COPYRIGHT 2020 STMicroelectronics *****END OF FILE****/</span></div>
<div class="ttc" id="struct_h_a_l___v_t_i_m_e_r___context_s_html"><div class="ttname"><a href="struct_h_a_l___v_t_i_m_e_r___context_s.html">HAL_VTIMER_ContextS</a></div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8c_source.html#l00084">vtimer.c:84</a></div></div>
<div class="ttc" id="struct_v_t_i_m_e_r___handle_type_s_html_a29166f80ce4b5c58d419312f78bacb96"><div class="ttname"><a href="struct_v_t_i_m_e_r___handle_type_s.html#a29166f80ce4b5c58d419312f78bacb96">VTIMER_HandleTypeS::active</a></div><div class="ttdeci">BOOL active</div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8h_source.html#l00048">vtimer.h:48</a></div></div>
<div class="ttc" id="struct_h_a_l___v_t_i_m_e_r___init_s_html"><div class="ttname"><a href="struct_h_a_l___v_t_i_m_e_r___init_s.html">HAL_VTIMER_InitS</a></div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8h_source.html#l00062">vtimer.h:62</a></div></div>
<div class="ttc" id="group___radio___exported___constants_html_gaff3836771fb9f269c772188087ed438c"><div class="ttname"><a href="group___radio___exported___constants.html#gaff3836771fb9f269c772188087ed438c">CLEAR_TIME_MIN</a></div><div class="ttdeci">#define CLEAR_TIME_MIN</div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8h_source.html#l00093">vtimer.h:93</a></div></div>
<div class="ttc" id="struct_v_t_i_m_e_r___radio_handle_type_s_html_a3c962931bc008b457e00a49273bd8ecb"><div class="ttname"><a href="struct_v_t_i_m_e_r___radio_handle_type_s.html#a3c962931bc008b457e00a49273bd8ecb">VTIMER_RadioHandleTypeS::event_type</a></div><div class="ttdeci">BOOL event_type</div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8h_source.html#l00059">vtimer.h:59</a></div></div>
<div class="ttc" id="group___v_t_i_m_e_r___private___function_html_gacb2416abb83897827ea8430d14e152c9"><div class="ttname"><a href="group___v_t_i_m_e_r___private___function.html#gacb2416abb83897827ea8430d14e152c9">_check_radio_activity</a></div><div class="ttdeci">void _check_radio_activity(VTIMER_RadioHandleType *timerHandle, uint8_t *expired)</div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8c_source.html#l00279">vtimer.c:279</a></div></div>
<div class="ttc" id="group___v_t_i_m_e_r___public___function_html_gae717b1000872fd901c77e60a74e72e0a"><div class="ttname"><a href="group___v_t_i_m_e_r___public___function.html#gae717b1000872fd901c77e60a74e72e0a">HAL_VTimerExpiry_sysT32</a></div><div class="ttdeci">int HAL_VTimerExpiry_sysT32(VTIMER_HandleType *timerHandle, uint64_t *sysTime)</div><div class="ttdoc">Returns the absolute expiry time of a running timer expressed in internal time units. </div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8c_source.html#l00556">vtimer.c:556</a></div></div>
<div class="ttc" id="group___v_t_i_m_e_r___public___function_html_ga57a0ed22841524238fa069e90858a3d5"><div class="ttname"><a href="group___v_t_i_m_e_r___public___function.html#ga57a0ed22841524238fa069e90858a3d5">HAL_VTIMER_RadioTimerIsr</a></div><div class="ttdeci">void HAL_VTIMER_RadioTimerIsr(void)</div><div class="ttdoc">Radio activity finished. Not used yet. </div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8c_source.html#l00419">vtimer.c:419</a></div></div>
<div class="ttc" id="group___v_t_i_m_e_r___private___types_definitions_html_gadbf84f8389ca366e49c25ae74c8b4c16"><div class="ttname"><a href="group___v_t_i_m_e_r___private___types_definitions.html#gadbf84f8389ca366e49c25ae74c8b4c16">TIMER1_MARGIN</a></div><div class="ttdeci">#define TIMER1_MARGIN</div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8c_source.html#l00079">vtimer.c:79</a></div></div>
<div class="ttc" id="struct_v_t_i_m_e_r___radio_handle_type_s_html"><div class="ttname"><a href="struct_v_t_i_m_e_r___radio_handle_type_s.html">VTIMER_RadioHandleTypeS</a></div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8h_source.html#l00054">vtimer.h:54</a></div></div>
<div class="ttc" id="sleep_8h_html_ace58749df14c14b64252eb55f40d2c32a4b1e70cf7dd0396d75a5ef3bc357694a"><div class="ttname"><a href="sleep_8h.html#ace58749df14c14b64252eb55f40d2c32a4b1e70cf7dd0396d75a5ef3bc357694a">SLEEPMODE_RUNNING</a></div><div class="ttdef"><b>Definition:</b> <a href="sleep_8h_source.html#l00150">sleep.h:150</a></div></div>
<div class="ttc" id="group___radio___exported___constants_html_ga474dc04f10ddbbb1d5cde5feb9cb0558"><div class="ttname"><a href="group___radio___exported___constants.html#ga474dc04f10ddbbb1d5cde5feb9cb0558">CALIB_SAFE_THR</a></div><div class="ttdeci">#define CALIB_SAFE_THR</div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8h_source.html#l00086">vtimer.h:86</a></div></div>
<div class="ttc" id="group___v_t_i_m_e_r___private___types_definitions_html_gacfff8120ca5315b54cc5ff907c83902d"><div class="ttname"><a href="group___v_t_i_m_e_r___private___types_definitions.html#gacfff8120ca5315b54cc5ff907c83902d">ATOMIC_SECTION_END</a></div><div class="ttdeci">#define ATOMIC_SECTION_END()</div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8c_source.html#l00070">vtimer.c:70</a></div></div>
<div class="ttc" id="group___v_t_i_m_e_r___private___types_definitions_html_ga3acffbd305ee72dcd4593c0d8af64a4f"><div class="ttname"><a href="group___v_t_i_m_e_r___private___types_definitions.html#ga3acffbd305ee72dcd4593c0d8af64a4f">MIN</a></div><div class="ttdeci">#define MIN(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8c_source.html#l00072">vtimer.c:72</a></div></div>
<div class="ttc" id="group___v_t_i_m_e_r___exported___types_html_ga0217df3674519b78410e66545b09d6ee"><div class="ttname"><a href="group___v_t_i_m_e_r___exported___types.html#ga0217df3674519b78410e66545b09d6ee">RadioStatus</a></div><div class="ttdeci">RadioStatus</div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8h_source.html#l00039">vtimer.h:39</a></div></div>
<div class="ttc" id="struct_v_t_i_m_e_r___handle_type_s_html"><div class="ttname"><a href="struct_v_t_i_m_e_r___handle_type_s.html">VTIMER_HandleTypeS</a></div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8h_source.html#l00045">vtimer.h:45</a></div></div>
<div class="ttc" id="struct_v_t_i_m_e_r___handle_type_s_html_a6b592b6a432c4e22fafc886492dcb215"><div class="ttname"><a href="struct_v_t_i_m_e_r___handle_type_s.html#a6b592b6a432c4e22fafc886492dcb215">VTIMER_HandleTypeS::callback</a></div><div class="ttdeci">VTIMER_CallbackType callback</div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8h_source.html#l00047">vtimer.h:47</a></div></div>
<div class="ttc" id="hal__types_8h_html_ac9a7e9a35d2513ec15c3b537aaa4fba1a7d46875fa3ebd2c34d2756950eda83bf"><div class="ttname"><a href="hal__types_8h.html#ac9a7e9a35d2513ec15c3b537aaa4fba1a7d46875fa3ebd2c34d2756950eda83bf">ENABLE</a></div><div class="ttdef"><b>Definition:</b> <a href="hal__types_8h_source.html#l00033">hal_types.h:33</a></div></div>
<div class="ttc" id="group___v_t_i_m_e_r___public___function_html_gaed9b6ad8c982914c2b804700241b7e0b"><div class="ttname"><a href="group___v_t_i_m_e_r___public___function.html#gaed9b6ad8c982914c2b804700241b7e0b">HAL_VTIMER_Init</a></div><div class="ttdeci">void HAL_VTIMER_Init(HAL_VTIMER_InitType *HAL_TIMER_InitStruct)</div><div class="ttdoc">Initialize the timer module. It must be placed in the initialization section of the application...</div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8c_source.html#l00582">vtimer.c:582</a></div></div>
<div class="ttc" id="group___v_t_i_m_e_r___public___function_html_ga9cad075d6ec15937f981dc558823047e"><div class="ttname"><a href="group___v_t_i_m_e_r___public___function.html#ga9cad075d6ec15937f981dc558823047e">HAL_VTIMER_GetPendingTimers</a></div><div class="ttdeci">uint32_t HAL_VTIMER_GetPendingTimers(void)</div><div class="ttdoc">Returns the number of timers in the queue. </div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8c_source.html#l00566">vtimer.c:566</a></div></div>
<div class="ttc" id="group___v_t_i_m_e_r___public___function_html_gafd324aaa270ffdfc73718161a97d7bb2"><div class="ttname"><a href="group___v_t_i_m_e_r___public___function.html#gafd324aaa270ffdfc73718161a97d7bb2">HAL_VTimerDiff_ms_sysT32</a></div><div class="ttdeci">int64_t HAL_VTimerDiff_ms_sysT32(uint64_t sysTime1, uint64_t sysTime2)</div><div class="ttdoc">Returns the difference between two absolute times: sysTime1-sysTime2. The resulting value is expresse...</div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8c_source.html#l00546">vtimer.c:546</a></div></div>
<div class="ttc" id="struct_v_t_i_m_e_r___radio_handle_type_s_html_ae78ee1e29e270240b0cdce74b83e9a75"><div class="ttname"><a href="struct_v_t_i_m_e_r___radio_handle_type_s.html#ae78ee1e29e270240b0cdce74b83e9a75">VTIMER_RadioHandleTypeS::active</a></div><div class="ttdeci">BOOL active</div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8h_source.html#l00057">vtimer.h:57</a></div></div>
<div class="ttc" id="struct_v_t_i_m_e_r___radio_handle_type_s_html_a8be9e072b9f40552147d419f182a0397"><div class="ttname"><a href="struct_v_t_i_m_e_r___radio_handle_type_s.html#a8be9e072b9f40552147d419f182a0397">VTIMER_RadioHandleTypeS::expiryTime</a></div><div class="ttdeci">uint64_t expiryTime</div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8h_source.html#l00055">vtimer.h:55</a></div></div>
<div class="ttc" id="group___v_t_i_m_e_r___public___function_html_ga236b610f92796d381fa23b6f21d08913"><div class="ttname"><a href="group___v_t_i_m_e_r___public___function.html#ga236b610f92796d381fa23b6f21d08913">HAL_VTIMER_SleepCheck</a></div><div class="ttdeci">uint8_t HAL_VTIMER_SleepCheck(void)</div><div class="ttdoc">Return the consensus of the Virtual timer management to go in sleep. </div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8c_source.html#l00747">vtimer.c:747</a></div></div>
<div class="ttc" id="struct_h_a_l___v_t_i_m_e_r___context_s_html_ad191a5b8142d56344dd526de70c33eea"><div class="ttname"><a href="struct_h_a_l___v_t_i_m_e_r___context_s.html#ad191a5b8142d56344dd526de70c33eea">HAL_VTIMER_ContextS::enableTimeBase</a></div><div class="ttdeci">BOOL enableTimeBase</div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8c_source.html#l00087">vtimer.c:87</a></div></div>
<div class="ttc" id="group___v_t_i_m_e_r___public___function_html_gad8a3825461350990147c342fb0eab229"><div class="ttname"><a href="group___v_t_i_m_e_r___public___function.html#gad8a3825461350990147c342fb0eab229">HAL_VTIMER_GetAnchorPoint</a></div><div class="ttdeci">uint64_t HAL_VTIMER_GetAnchorPoint(void)</div><div class="ttdoc">Get the last anchorPoint in system time unit. </div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8c_source.html#l00521">vtimer.c:521</a></div></div>
<div class="ttc" id="struct_h_a_l___v_t_i_m_e_r___context_s_html_a6a6415f8e6d477e1f1a29b0157b91224"><div class="ttname"><a href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a6a6415f8e6d477e1f1a29b0157b91224">HAL_VTIMER_ContextS::served_count</a></div><div class="ttdeci">uint8_t served_count</div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8c_source.html#l00091">vtimer.c:91</a></div></div>
<div class="ttc" id="hal__types_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="hal__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdoc">TRUE, FALSE definition. </div><div class="ttdef"><b>Definition:</b> <a href="hal__types_8h_source.html#l00070">hal_types.h:70</a></div></div>
<div class="ttc" id="group___v_t_i_m_e_r___private___types_definitions_html_gab3d21259aba8fbe7b2a996018f353d77"><div class="ttname"><a href="group___v_t_i_m_e_r___private___types_definitions.html#gab3d21259aba8fbe7b2a996018f353d77">INCREMENT_EXPIRE_COUNT_ISR</a></div><div class="ttdeci">#define INCREMENT_EXPIRE_COUNT_ISR</div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8c_source.html#l00074">vtimer.c:74</a></div></div>
<div class="ttc" id="struct_v_t_i_m_e_r___handle_type_s_html_a51953ab27ed5da5fc0242722b4537bd6"><div class="ttname"><a href="struct_v_t_i_m_e_r___handle_type_s.html#a51953ab27ed5da5fc0242722b4537bd6">VTIMER_HandleTypeS::next</a></div><div class="ttdeci">struct VTIMER_HandleTypeS * next</div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8h_source.html#l00049">vtimer.h:49</a></div></div>
<div class="ttc" id="group___v_t_i_m_e_r___public___function_html_ga2266d78ab1fdc199cc33271cf57a7328"><div class="ttname"><a href="group___v_t_i_m_e_r___public___function.html#ga2266d78ab1fdc199cc33271cf57a7328">HAL_VTimer_StopRadioTimer2</a></div><div class="ttdeci">void HAL_VTimer_StopRadioTimer2(void)</div><div class="ttdoc">Disable Timer2. </div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8c_source.html#l00397">vtimer.c:397</a></div></div>
<div class="ttc" id="group___v_t_i_m_e_r___public___function_html_ga294de6476d1b923b32c6281640609826"><div class="ttname"><a href="group___v_t_i_m_e_r___public___function.html#ga294de6476d1b923b32c6281640609826">HAL_VTimer_ClearRadioTimerValue</a></div><div class="ttdeci">uint8_t HAL_VTimer_ClearRadioTimerValue(void)</div><div class="ttdoc">Clear the last radio activity scheduled disabling the radio timer too. Furthermore, it returns if the timeout is too close with respect the current time and the radio activity might not be cleared in time. </div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8c_source.html#l00366">vtimer.c:366</a></div></div>
<div class="ttc" id="struct_h_a_l___v_t_i_m_e_r___context_s_html_a9564011d603c99c5b66d132e2b1454f4"><div class="ttname"><a href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a9564011d603c99c5b66d132e2b1454f4">HAL_VTIMER_ContextS::rootNode</a></div><div class="ttdeci">VTIMER_HandleType * rootNode</div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8c_source.html#l00089">vtimer.c:89</a></div></div>
<div class="ttc" id="struct_v_t_i_m_e_r___radio_handle_type_s_html_a22b9bda680e9f825fe56a0dd54ab3ef3"><div class="ttname"><a href="struct_v_t_i_m_e_r___radio_handle_type_s.html#a22b9bda680e9f825fe56a0dd54ab3ef3">VTIMER_RadioHandleTypeS::pending</a></div><div class="ttdeci">BOOL pending</div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8h_source.html#l00058">vtimer.h:58</a></div></div>
<div class="ttc" id="struct_h_a_l___v_t_i_m_e_r___init_s_html_a4a32333ed2c9c4a516b2fb3f13440cbe"><div class="ttname"><a href="struct_h_a_l___v_t_i_m_e_r___init_s.html#a4a32333ed2c9c4a516b2fb3f13440cbe">HAL_VTIMER_InitS::XTAL_StartupTime</a></div><div class="ttdeci">uint16_t XTAL_StartupTime</div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8h_source.html#l00063">vtimer.h:63</a></div></div>
<div class="ttc" id="struct_h_a_l___v_t_i_m_e_r___init_s_html_a5f7ad1f8f2182e44e8fac388a616f85d"><div class="ttname"><a href="struct_h_a_l___v_t_i_m_e_r___init_s.html#a5f7ad1f8f2182e44e8fac388a616f85d">HAL_VTIMER_InitS::EnableInitialCalibration</a></div><div class="ttdeci">BOOL EnableInitialCalibration</div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8h_source.html#l00068">vtimer.h:68</a></div></div>
<div class="ttc" id="vtimer_8h_html"><div class="ttname"><a href="vtimer_8h.html">vtimer.h</a></div><div class="ttdoc">vtimer and Radio timer high level APIs header file </div></div>
<div class="ttc" id="sleep_8h_html_ace58749df14c14b64252eb55f40d2c32a559adb5abaebc7504743f8684ab16f28"><div class="ttname"><a href="sleep_8h.html#ace58749df14c14b64252eb55f40d2c32a559adb5abaebc7504743f8684ab16f28">SLEEPMODE_NOTIMER</a></div><div class="ttdef"><b>Definition:</b> <a href="sleep_8h_source.html#l00153">sleep.h:153</a></div></div>
<div class="ttc" id="group___v_t_i_m_e_r___public___function_html_ga587f3c1112d65c7fea9f0d94af5735ad"><div class="ttname"><a href="group___v_t_i_m_e_r___public___function.html#ga587f3c1112d65c7fea9f0d94af5735ad">HAL_VTimer_Stop</a></div><div class="ttdeci">void HAL_VTimer_Stop(VTIMER_HandleType *timerHandle)</div><div class="ttdoc">Stops the one-shot virtual timer specified if found. </div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8c_source.html#l00490">vtimer.c:490</a></div></div>
<div class="ttc" id="struct_h_a_l___v_t_i_m_e_r___init_s_html_ab43e330faccd3e4e74bc5c32de5a4cb7"><div class="ttname"><a href="struct_h_a_l___v_t_i_m_e_r___init_s.html#ab43e330faccd3e4e74bc5c32de5a4cb7">HAL_VTIMER_InitS::PeriodicCalibrationInterval</a></div><div class="ttdeci">uint16_t PeriodicCalibrationInterval</div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8h_source.html#l00069">vtimer.h:69</a></div></div>
<div class="ttc" id="group___radio___exported___constants_html_ga877c6848189c959fbe6a8719213024ff"><div class="ttname"><a href="group___radio___exported___constants.html#ga877c6848189c959fbe6a8719213024ff">HAL_VTIMER_CRITICAL</a></div><div class="ttdeci">#define HAL_VTIMER_CRITICAL</div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8h_source.html#l00081">vtimer.h:81</a></div></div>
<div class="ttc" id="group___v_t_i_m_e_r___public___function_html_gaf1d8b105f2bfda39e1ef1b2804ba9882"><div class="ttname"><a href="group___v_t_i_m_e_r___public___function.html#gaf1d8b105f2bfda39e1ef1b2804ba9882">HAL_VTimer_GetRadioTimerValue</a></div><div class="ttdeci">RadioStatus HAL_VTimer_GetRadioTimerValue(uint32_t *time)</div><div class="ttdoc">Return the status of the radio timer. The timeout of the last radio timer activity taken into account...</div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8c_source.html#l00350">vtimer.c:350</a></div></div>
<div class="ttc" id="struct_h_a_l___v_t_i_m_e_r___context_s_html_a409e439f10c0b0a2d62eed495a10e62b"><div class="ttname"><a href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a409e439f10c0b0a2d62eed495a10e62b">HAL_VTIMER_ContextS::hs_startup_time</a></div><div class="ttdeci">uint32_t hs_startup_time</div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8c_source.html#l00088">vtimer.c:88</a></div></div>
<div class="ttc" id="hal__types_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="hal__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="hal__types_8h_source.html#l00071">hal_types.h:71</a></div></div>
<div class="ttc" id="group___v_t_i_m_e_r___private___types_definitions_html_ga8fe244106cd42470148924a013d3de99"><div class="ttname"><a href="group___v_t_i_m_e_r___private___types_definitions.html#ga8fe244106cd42470148924a013d3de99">HAL_VTIMER_ContextType</a></div><div class="ttdeci">struct HAL_VTIMER_ContextS HAL_VTIMER_ContextType</div></div>
<div class="ttc" id="group___v_t_i_m_e_r___public___function_html_gae1e1a3648d2f813f4dfcfa082e046bd6"><div class="ttname"><a href="group___v_t_i_m_e_r___public___function.html#gae1e1a3648d2f813f4dfcfa082e046bd6">HAL_VTIMER_TimerSleepCheck</a></div><div class="ttdeci">SleepModes HAL_VTIMER_TimerSleepCheck(SleepModes sleepMode)</div><div class="ttdoc">Returns the admitted sleep mode according to the next timer activity. </div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8c_source.html#l00680">vtimer.c:680</a></div></div>
<div class="ttc" id="group___v_t_i_m_e_r___public___function_html_gaf9f41587a748ade10ee700ac65996701"><div class="ttname"><a href="group___v_t_i_m_e_r___public___function.html#gaf9f41587a748ade10ee700ac65996701">HAL_VTimerAcc_sysT32_ms</a></div><div class="ttdeci">uint64_t HAL_VTimerAcc_sysT32_ms(uint64_t sysTime, int32_t msTime)</div><div class="ttdoc">This function returns the sum of an absolute time and a signed relative time. </div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8c_source.html#l00533">vtimer.c:533</a></div></div>
<div class="ttc" id="group___v_t_i_m_e_r___exported___types_html_gga0217df3674519b78410e66545b09d6eea4d845c6aaa87e5237d2fa85b2ad1317e"><div class="ttname"><a href="group___v_t_i_m_e_r___exported___types.html#gga0217df3674519b78410e66545b09d6eea4d845c6aaa87e5237d2fa85b2ad1317e">RADIO_TIMER_PENDING</a></div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8h_source.html#l00041">vtimer.h:41</a></div></div>
<div class="ttc" id="struct_v_t_i_m_e_r___handle_type_s_html_a9528c6497645126b8293fffd4b16fc8c"><div class="ttname"><a href="struct_v_t_i_m_e_r___handle_type_s.html#a9528c6497645126b8293fffd4b16fc8c">VTIMER_HandleTypeS::expiryTime</a></div><div class="ttdeci">uint64_t expiryTime</div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8h_source.html#l00046">vtimer.h:46</a></div></div>
<div class="ttc" id="group___v_t_i_m_e_r___exported___types_html_gga0217df3674519b78410e66545b09d6eeafbaf726116172c486424f1a03eca59cc"><div class="ttname"><a href="group___v_t_i_m_e_r___exported___types.html#gga0217df3674519b78410e66545b09d6eeafbaf726116172c486424f1a03eca59cc">RADIO_TIMER_OFF</a></div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8h_source.html#l00040">vtimer.h:40</a></div></div>
<div class="ttc" id="hal__types_8h_html_ac9a7e9a35d2513ec15c3b537aaa4fba1"><div class="ttname"><a href="hal__types_8h.html#ac9a7e9a35d2513ec15c3b537aaa4fba1">FunctionalState</a></div><div class="ttdeci">FunctionalState</div><div class="ttdoc">DISABLE, ENABLE definition. </div><div class="ttdef"><b>Definition:</b> <a href="hal__types_8h_source.html#l00033">hal_types.h:33</a></div></div>
<div class="ttc" id="group___v_t_i_m_e_r___public___function_html_ga340e1a2a0814d3cd0e4c424128a77b73"><div class="ttname"><a href="group___v_t_i_m_e_r___public___function.html#ga340e1a2a0814d3cd0e4c424128a77b73">HAL_VTIMER_TimeoutCallback</a></div><div class="ttdeci">void HAL_VTIMER_TimeoutCallback(void)</div><div class="ttdoc">Virtual timer Timeout Callback. It must be called in the Blue handler if the host wake up timer bit i...</div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8c_source.html#l00408">vtimer.c:408</a></div></div>
<div class="ttc" id="group___v_t_i_m_e_r___private___types_definitions_html_ga125af6df2956a88705c7efdba86cabe5"><div class="ttname"><a href="group___v_t_i_m_e_r___private___types_definitions.html#ga125af6df2956a88705c7efdba86cabe5">ATOMIC_SECTION_BEGIN</a></div><div class="ttdeci">#define ATOMIC_SECTION_BEGIN()</div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8c_source.html#l00067">vtimer.c:67</a></div></div>
<div class="ttc" id="hal__types_8h_html_ad2f8ed01c1733d4eab0932d970abaa4c"><div class="ttname"><a href="hal__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a></div><div class="ttdeci">uint8_t BOOL</div><div class="ttdoc">Booelan definition. </div><div class="ttdef"><b>Definition:</b> <a href="hal__types_8h_source.html#l00067">hal_types.h:67</a></div></div>
<div class="ttc" id="sleep_8h_html_ace58749df14c14b64252eb55f40d2c32a93af1c45a33be62df00d0ab82ef04128"><div class="ttname"><a href="sleep_8h.html#ace58749df14c14b64252eb55f40d2c32a93af1c45a33be62df00d0ab82ef04128">SLEEPMODE_WAKETIMER</a></div><div class="ttdef"><b>Definition:</b> <a href="sleep_8h_source.html#l00152">sleep.h:152</a></div></div>
<div class="ttc" id="struct_v_t_i_m_e_r___handle_type_s_html_a20c14eaf8526f4114cc71a5e29d338cd"><div class="ttname"><a href="struct_v_t_i_m_e_r___handle_type_s.html#a20c14eaf8526f4114cc71a5e29d338cd">VTIMER_HandleTypeS::userData</a></div><div class="ttdeci">void * userData</div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8h_source.html#l00050">vtimer.h:50</a></div></div>
<div class="ttc" id="sleep_8h_html_ace58749df14c14b64252eb55f40d2c32"><div class="ttname"><a href="sleep_8h.html#ace58749df14c14b64252eb55f40d2c32">SleepModes</a></div><div class="ttdeci">SleepModes</div><div class="ttdoc">Enumerations for the possible microcontroller sleep modes. </div><div class="ttdef"><b>Definition:</b> <a href="sleep_8h_source.html#l00149">sleep.h:149</a></div></div>
<div class="ttc" id="group___v_t_i_m_e_r___public___function_html_gadb09adc35bd80510ff420b0cdcc16aea"><div class="ttname"><a href="group___v_t_i_m_e_r___public___function.html#gadb09adc35bd80510ff420b0cdcc16aea">HAL_VTimer_SetRadioTimerValue</a></div><div class="ttdeci">uint8_t HAL_VTimer_SetRadioTimerValue(uint32_t time, uint8_t event_type, uint8_t cal_req)</div><div class="ttdoc">Schedules a radio activity for the given absolute timeout value expressed in STU If the calibration o...</div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8c_source.html#l00466">vtimer.c:466</a></div></div>
<div class="ttc" id="group___radio___exported___constants_html_ga4ffa715be4a5d326a660e34698b38828"><div class="ttname"><a href="group___radio___exported___constants.html#ga4ffa715be4a5d326a660e34698b38828">RADIO_ACTIVITY_MARGIN</a></div><div class="ttdeci">#define RADIO_ACTIVITY_MARGIN</div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8h_source.html#l00083">vtimer.h:83</a></div></div>
<div class="ttc" id="group___radio___exported___constants_html_gad3a2344fcb503af2ef601fb6dad1ef50"><div class="ttname"><a href="group___radio___exported___constants.html#gad3a2344fcb503af2ef601fb6dad1ef50">BLUE_SLEEP_ENABLE</a></div><div class="ttdeci">#define BLUE_SLEEP_ENABLE</div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8h_source.html#l00095">vtimer.h:95</a></div></div>
<div class="ttc" id="group___v_t_i_m_e_r___public___function_html_ga3e0fa8ea7b066acf8f2299d2cb73ae19"><div class="ttname"><a href="group___v_t_i_m_e_r___public___function.html#ga3e0fa8ea7b066acf8f2299d2cb73ae19">HAL_VTIMER_Tick</a></div><div class="ttdeci">void HAL_VTIMER_Tick(void)</div><div class="ttdoc">Timer module state machine. Check and schedule the calibration. Check expired timers and execute user...</div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8c_source.html#l00617">vtimer.c:617</a></div></div>
<div class="ttc" id="group___v_t_i_m_e_r___private___types_definitions_html_ga08cdb6ca93f14983cc2ddf0db4464700"><div class="ttname"><a href="group___v_t_i_m_e_r___private___types_definitions.html#ga08cdb6ca93f14983cc2ddf0db4464700">DIFF8</a></div><div class="ttdeci">#define DIFF8(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8c_source.html#l00073">vtimer.c:73</a></div></div>
<div class="ttc" id="struct_h_a_l___v_t_i_m_e_r___context_s_html_a469e12352153c7f79bb360af025be558"><div class="ttname"><a href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a469e12352153c7f79bb360af025be558">HAL_VTIMER_ContextS::expired_count</a></div><div class="ttdeci">uint8_t expired_count</div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8c_source.html#l00090">vtimer.c:90</a></div></div>
<div class="ttc" id="group___radio___exported___constants_html_ga773b8ff1a71b3f0c1f292a6b8e1384c5"><div class="ttname"><a href="group___radio___exported___constants.html#ga773b8ff1a71b3f0c1f292a6b8e1384c5">HAL_VTIMER_SUCCESS</a></div><div class="ttdeci">#define HAL_VTIMER_SUCCESS</div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8h_source.html#l00079">vtimer.h:79</a></div></div>
<div class="ttc" id="group___v_t_i_m_e_r___private___types_definitions_html_ga45249c919484c94cb2de5e232a8a2857"><div class="ttname"><a href="group___v_t_i_m_e_r___private___types_definitions.html#ga45249c919484c94cb2de5e232a8a2857">INCREMENT_EXPIRE_COUNT</a></div><div class="ttdeci">#define INCREMENT_EXPIRE_COUNT</div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8c_source.html#l00075">vtimer.c:75</a></div></div>
<div class="ttc" id="struct_v_t_i_m_e_r___radio_handle_type_s_html_a0072edb361743a559932f59cf591fe26"><div class="ttname"><a href="struct_v_t_i_m_e_r___radio_handle_type_s.html#a0072edb361743a559932f59cf591fe26">VTIMER_RadioHandleTypeS::cal_req</a></div><div class="ttdeci">BOOL cal_req</div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8h_source.html#l00056">vtimer.h:56</a></div></div>
<div class="ttc" id="sleep_8h_html_ace58749df14c14b64252eb55f40d2c32a98dd44e8e4c7b7af9e3d00c983aa1b36"><div class="ttname"><a href="sleep_8h.html#ace58749df14c14b64252eb55f40d2c32a98dd44e8e4c7b7af9e3d00c983aa1b36">SLEEPMODE_CPU_HALT</a></div><div class="ttdef"><b>Definition:</b> <a href="sleep_8h_source.html#l00151">sleep.h:151</a></div></div>
<div class="ttc" id="group___v_t_i_m_e_r___public___function_html_ga6d553aaf09e4c134b63d6218b26ff832"><div class="ttname"><a href="group___v_t_i_m_e_r___public___function.html#ga6d553aaf09e4c134b63d6218b26ff832">HAL_VTimerStart_sysT32</a></div><div class="ttdeci">int HAL_VTimerStart_sysT32(VTIMER_HandleType *timerHandle, uint64_t time)</div><div class="ttdoc">Starts a one-shot virtual timer for the given absolute timeout value expressed in internal time units...</div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8c_source.html#l00432">vtimer.c:432</a></div></div>
<div class="ttc" id="hal__types_8h_html_ac9a7e9a35d2513ec15c3b537aaa4fba1ad3a9df141be0ccf10389b640f492b26d"><div class="ttname"><a href="hal__types_8h.html#ac9a7e9a35d2513ec15c3b537aaa4fba1ad3a9df141be0ccf10389b640f492b26d">DISABLE</a></div><div class="ttdef"><b>Definition:</b> <a href="hal__types_8h_source.html#l00033">hal_types.h:33</a></div></div>
<div class="ttc" id="group___v_t_i_m_e_r___public___function_html_ga94ae05e6e7406c14a693c319169a86e2"><div class="ttname"><a href="group___v_t_i_m_e_r___public___function.html#ga94ae05e6e7406c14a693c319169a86e2">HAL_VTimerStart_ms</a></div><div class="ttdeci">int HAL_VTimerStart_ms(VTIMER_HandleType *timerHandle, uint32_t msRelTimeout)</div><div class="ttdoc">Starts a one-shot virtual timer for the given relative timeout value expressed in ms...</div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8c_source.html#l00447">vtimer.c:447</a></div></div>
<div class="ttc" id="group___v_t_i_m_e_r___public___function_html_gad6bc6fc6411987df78053675f51f4a14"><div class="ttname"><a href="group___v_t_i_m_e_r___public___function.html#gad6bc6fc6411987df78053675f51f4a14">HAL_VTimerGetCurrentTime_sysT32</a></div><div class="ttdeci">uint32_t HAL_VTimerGetCurrentTime_sysT32(void)</div><div class="ttdoc">This function return the current reference time expressed in system time units. The returned value ca...</div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8c_source.html#l00512">vtimer.c:512</a></div></div>
<div class="ttc" id="struct_h_a_l___v_t_i_m_e_r___context_s_html_a8be087d5097e059cf2c64172d741c76e"><div class="ttname"><a href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a8be087d5097e059cf2c64172d741c76e">HAL_VTIMER_ContextS::calibration_in_progress</a></div><div class="ttdeci">BOOL calibration_in_progress</div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8c_source.html#l00086">vtimer.c:86</a></div></div>
<div class="ttc" id="struct_h_a_l___v_t_i_m_e_r___context_s_html_a56a5ec998fc953d22310ffc8ed5455ee"><div class="ttname"><a href="struct_h_a_l___v_t_i_m_e_r___context_s.html#a56a5ec998fc953d22310ffc8ed5455ee">HAL_VTIMER_ContextS::PeriodicCalibrationInterval</a></div><div class="ttdeci">uint32_t PeriodicCalibrationInterval</div><div class="ttdef"><b>Definition:</b> <a href="vtimer_8c_source.html#l00085">vtimer.c:85</a></div></div>
<div class="ttc" id="sleep_8h_html"><div class="ttname"><a href="sleep_8h.html">sleep.h</a></div><div class="ttdoc">Header file for BlueNRG-1,2 Sleep management. </div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.10-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Copyright &copy; 2020 by STMicrolectronics. All rights reserved.<br>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
