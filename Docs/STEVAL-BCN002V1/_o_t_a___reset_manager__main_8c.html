<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>STEVAL-BCN002V1 DK: C:/Users/michael galizzi1/Desktop/Customers/Nike/STEVAL-BCN002V1 DK 1.1.0/Project/BLE_Examples/BLE_OTA_ResetManager/src/OTA_ResetManager_main.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ST-logo-small.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">STEVAL-BCN002V1 DK
   &#160;<span id="projectnumber">1.1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_o_t_a___reset_manager__main_8c.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">OTA_ResetManager_main.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This application implements the OTA Reset Manager which, at reset, <br />
 passes control to the latest valid BLE application updated through the BLE Over-The-Air (OTA) Service.  
<a href="#details">More...</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This application implements the OTA Reset Manager which, at reset, <br />
 passes control to the latest valid BLE application updated through the BLE Over-The-Air (OTA) Service. </p>
<h1><a class="anchor" id="ATOLLIC_project"></a>
ATOLLIC project</h1>
<p>To use the project with ATOLLIC TrueSTUDIO for ARM, please follow the instructions below:</p><ol type="1">
<li>Open the ATOLLIC TrueSTUDIO for ARM and select File-&gt;Import... Project menu.</li>
<li>Select Existing Projects into Workspace.</li>
<li>Select the ATOLLIC project</li>
<li>Select desired configuration to build from Project-&gt;Manage Configurations</li>
<li>Select Project-&gt;Rebuild Project. This will recompile and link the entire application</li>
</ol>
<h1><a class="anchor" id="KEIL_project"></a>
KEIL project</h1>
<p>To use the project with KEIL uVision 5 for ARM, please follow the instructions below:</p><ol type="1">
<li>Open the KEIL uVision 5 for ARM and select Project-&gt;Open Project menu.</li>
<li>Open the KEIL project <code> ...\Project\BLE_Examples\BLE_OTA_ResetManager\MDK-ARM\BlueNRG-2\BLE_OTA_ResetManager.uvprojx </code></li>
<li>Select desired configuration to build</li>
<li>Select Project-&gt;Rebuild all target files. This will recompile and link the entire application</li>
<li>To download the binary image, please connect STLink to JTAG connector in your board (if available).</li>
<li>Select Project-&gt;Download to download the related binary image.</li>
<li>Alternatively, open the BlueNRG1 Flasher utility and download the built binary image.</li>
</ol>
<h1><a class="anchor" id="IAR_project"></a>
IAR project</h1>
<p>To use the project with IAR Embedded Workbench for ARM, please follow the instructions below:</p><ol type="1">
<li>Open the Embedded Workbench for ARM and select File-&gt;Open-&gt;Workspace menu.</li>
<li>Open the IAR project <code> ...\Project\BLE_Examples\BLE_OTA_ResetManager\EWARM\BlueNRG-2\BLE_OTA_ResetManager.eww </code></li>
<li>Select desired configuration to build</li>
<li>Select Project-&gt;Rebuild All. This will recompile and link the entire application</li>
<li>To download the binary image, please connect STLink to JTAG connector in your board (if available).</li>
<li>Select Project-&gt;Download and Debug to download the related binary image.</li>
<li>Alternatively, open the BlueNRG1 Flasher utility and download the built binary image.</li>
</ol>
<h2><a class="anchor" id="Project_configurations"></a>
Project configurations</h2>
<ul>
<li><code>Release</code> - Release configuration</li>
</ul>
<h1><a class="anchor" id="Board_supported"></a>
Boards supported</h1>
<ul>
<li><code>STEVAL-IDB007V1</code> </li>
<li><code>STEVAL-IDB007V2</code> </li>
<li><code>STEVAL-IDB008V1</code> </li>
<li><code>STEVAL-IDB008V2</code> </li>
<li><code>STEVAL-IDB009V1</code> </li>
</ul>
<h1><a class="anchor" id="Power_settings"></a>
Power configuration settings</h1>
<hr/>
 <h2>| STEVAL-IDB00XV1 | </h2>
<p>| Jumper name | | Description | </p><h2>| JP1 | JP2 | | </h2>
<p>| ON 1-2 | ON 2-3 | USB supply power | | ON 2-3 | ON 1-2 | The supply voltage must be provided through battery pins. | | ON 1-2 | | USB supply power to STM32L1, JP2 pin 2 external power to BlueNRG1 |</p>
<h1><a class="anchor" id="Jumper_settings"></a>
Jumper settings</h1>
<hr/>
 <h2>| STEVAL-IDB00XV1 | </h2>
<h2>| Jumper name | Description | </h2>
<p>| JP1 | 1-2: to provide power from USB (JP2:2-3). 2-3: to provide power from battery holder (JP2:1-2) | <br />
| JP2 | 1-2: to provide power from battery holder (JP1:2-3). 2-3: to provide power from USB (JP1:1-2). Pin2 to VDD to provide external power supply to BlueNRG-1 (JP1: 1-2) | | JP3 | pin 1 and 2 UART RX and TX of MCU. pin 3 GND. | <br />
| JP4 | Fitted: to provide VBLUE to BlueNRG1. It can be used also for current measurement. | | JP5 | Fitted : TEST pin to VBLUE. Not fitted: TEST pin to GND |</p>
<h1><a class="anchor" id="Pin_settings"></a>
Pin settings</h1>
<h2>| PIN name | STEVAL-IDB007V1 | STEVAL-IDB007V2 | STEVAL-IDB008V1 | STEVAL-IDB008V2 | STEVAL-IDB009V1 | </h2>
<p>| ADC1 | Not Used | Not Used | Not Used | Not Used | Not Used | | ADC2 | Not Used | Not Used | Not Used | Not Used | Not Used | | IO0 | Not Used | Not Used | Not Used | Not Used | Not Used | | IO1 | Not Used | Not Used | Not Used | Not Used | Not Used | | IO11 | Not Used | Not Used | Not Used | Not Used | Not Used | | IO12 | Not Used | Not Used | Not Used | Not Used | Not Used | | IO13 | Not Used | Not Used | Not Used | Not Used | Not Used | | IO14 | Not Used | Not Used | Not Used | Not Used | Not Used | | IO15 | N.A. | N.A. | N.A. | N.A. | Not Used | | IO16 | N.A. | N.A. | N.A. | N.A. | Not Used | | IO17 | N.A. | N.A. | N.A. | N.A. | Not Used | | IO18 | N.A. | N.A. | N.A. | N.A. | Not Used | | IO19 | N.A. | N.A. | N.A. | N.A. | Not Used | | IO2 | Not Used | Not Used | Not Used | Not Used | Not Used | | IO20 | N.A. | N.A. | N.A. | N.A. | Not Used | | IO21 | N.A. | N.A. | N.A. | N.A. | Not Used | | IO22 | N.A. | N.A. | N.A. | N.A. | Not Used | | IO23 | N.A. | N.A. | N.A. | N.A. | Not Used | | IO24 | N.A. | N.A. | N.A. | N.A. | Not Used | | IO25 | N.A. | N.A. | N.A. | N.A. | Not Used | | IO3 | Not Used | Not Used | Not Used | Not Used | Not Used | | IO4 | Not Used | Not Used | Not Used | Not Used | Not Used | | IO5 | Not Used | Not Used | Not Used | Not Used | Not Used | | IO6 | Not Used | Not Used | Not Used | Not Used | Not Used | | IO7 | Not Used | Not Used | Not Used | Not Used | Not Used | | IO8 | Not Used | Not Used | Not Used | Not Used | Not Used | | TEST1 | Not Used | Not Used | Not Used | Not Used | Not Used |</p>
<h1><a class="anchor" id="Serial_IO"></a>
Serial I/O</h1>
<h2>| Parameter name | Value | Unit | </h2>
<p>| Baudrate | 115200 [default] | bit/sec | | Data bits | 8 | bit | | Parity | None | bit | | Stop bits | 1 | bit | </p>
<h1><a class="anchor" id="LEDs_description"></a>
LEDs description</h1>
<h2>| LED name | STEVAL-IDB007V1 | STEVAL-IDB007V2 | STEVAL-IDB008V1 | STEVAL-IDB008V2 | STEVAL-IDB009V1 | </h2>
<p>| DL1 | Not Used | Not Used | Not Used | Not Used | Not Used | | DL2 | Not Used | Not Used | Not Used | Not Used | Not Used | | DL3 | Not Used | Not Used | Not Used | Not Used | Not Used | | DL4 | Not Used | Not Used | Not Used | Not Used | Not Used |</p>
<h1><a class="anchor" id="Buttons_description"></a>
Buttons description</h1>
<h2>| BUTTON name | STEVAL-IDB007V1 | STEVAL-IDB007V2 | STEVAL-IDB008V1 | STEVAL-IDB008V2 | STEVAL-IDB009V1 | </h2>
<p>| PUSH1 | Not Used | Not Used | Not Used | Not Used | Not Used | | PUSH2 | Not Used | Not Used | Not Used | Not Used | Not Used | | RESET | Reset BlueNRG1 | Reset BlueNRG1 | Reset BlueNRG2 | Reset BlueNRG2 | Reset BlueNRG2 |</p>
<h1><a class="anchor" id="Usage"></a>
Usage</h1>
<ul>
<li>The OTA Reset Manager is a basic application which is is stored at BlueNRG-1,2 FLASH base address (0x10040000) and it allows to transfer of control towards the new upgraded application every time we reset.</li>
<li>The new application has to add the OTA service and related characteristics defined on files OTA_btl.c.</li>
<li>At device reset, the reset manager will take care of jumping to the location of the last image that was successfully loaded by the OTA bootloader.</li>
</ul>
<p>NOTEs</p><ul>
<li>Before downloading the OTA Reset Manager performs a device Mass Erase of the selected BlueNRG-1,2 device (use IAR, Project, Download, Erase Memory). Then, open the IAR project related to a Lower Application with OTA Service and download it on the selected device. At this stage, the BlueNRG-1,2 device is ready for performing OTA upgrades.</li>
<li>Refer to BLE_Chat and SensorDemo workspaces IAR projects for related OTA examples (Lower and Higher Applications with OTA service workspaces).</li>
<li>On BlueNRG-2, BLE stack v2.1 or later, OTA FW upgrade also supports the data length extended capability. User is requested to add the OTA_EXTENDED_PACKET_LEN=1 option and to use a BLE stack configuration ioption supporting this capability (BLE_STACK_CONFIGURATION=BLE_OTA_BASIC_CONFIGURATION or BLE_STACK_CONFIGURATION=BLE_STACK_FULL_CONFIGURATION). </li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_ef400272f54c760ae5fdb1f952859f6f.html">STEVAL-BCN002V1 DK 1.1.0</a></li><li class="navelem"><a class="el" href="dir_69e0761ab2017eddef87489741c355bd.html">Project</a></li><li class="navelem"><a class="el" href="dir_ab105a37112905d2d2d4989fd5261ee6.html">BLE_Examples</a></li><li class="navelem"><a class="el" href="dir_c570d84655715df130093372874bdebf.html">BLE_OTA_ResetManager</a></li><li class="navelem"><a class="el" href="dir_caf1f324fa15bc83bc0c66ed45363e28.html">src</a></li><li class="navelem"><a class="el" href="_o_t_a___reset_manager__main_8c.html">OTA_ResetManager_main.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
